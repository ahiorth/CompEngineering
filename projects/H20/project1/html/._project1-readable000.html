<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="The tip of the iceberg">

<title>The tip of the iceberg</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:64px;      /* fixed header height for style bootswatch_readable */
  margin:-64px 0 0; /* negative fixed header height */
}
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Exercise 1', 1, 'ex:round_err', 'ex:round_err'),
              ('Exercise 2',
               1,
               'exer:numpy_and_pandas',
               'exer:numpy_and_pandas'),
              ('Exercise 3', 1, 'exer:free_fall', 'exer:free_fall'),
              ('Exercise 4', 1, 'exer:isostasy', 'exer:isostasy'),
              ('Guidelines for project submission', 1, None, '___sec4'),
              ('Bibliography', 1, None, '___sec5')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\no}{\nonumber}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="project1-readable.html">The tip of the iceberg</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="#ex:round_err" style="font-size: 80%;">Exercise 1</a></li>
     <!-- navigation toc: --> <li><a href="#exer:numpy_and_pandas" style="font-size: 80%;">Exercise 2</a></li>
     <!-- navigation toc: --> <li><a href="#exer:free_fall" style="font-size: 80%;">Exercise 3</a></li>
     <!-- navigation toc: --> <li><a href="#exer:isostasy" style="font-size: 80%;">Exercise 4</a></li>
     <!-- navigation toc: --> <li><a href="#___sec4" style="font-size: 80%;">Guidelines for project submission</a></li>
     <!-- navigation toc: --> <li><a href="#___sec5" style="font-size: 80%;">Bibliography</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0000"></a>
<!-- ------------------- main content ---------------------- -->



<div class="jumbotron">
<center><h1>The tip of the iceberg</h1></center>  <!-- document title -->

<p>
<!-- author(s): MOD510: Mandatory project \#1, and Deadline: 13 September 2020 (23:59) -->

<center>
<b>MOD510: Mandatory project \#1</b> 
</center>

<center>
<b>Deadline: 13 September 2020 (23:59)</b> 
</center>

<p>
<!-- institution(s) -->

<br>
<p>
<center><h4>Aug 31, 2020</h4></center> <!-- date -->
<br>
<p>
<!-- USEFUL LINKS: -->

<p>
<!-- <a href="http://www.antarcticglaciers.org/glaciers-and-climate/estimating-glacier-contribution-to-sea-level-rise/" target="_self"><tt>http://www.antarcticglaciers.org/glaciers-and-climate/estimating-glacier-contribution-to-sea-level-rise/</tt></a> -->

<p>
<b>Learning objectives.</b>
By completing this project, the student will:

<ul>
<li> Get experience with structuring and writing a report.</li>
<li> Be introduced to useful Python libraries for scientific computing.</li>
<li> Explore numerical round-off and truncation errors.
<!-- * Learn how to import modules and/or data into a Python program. --></li>
<li> Understand basic concepts of <a href="https://en.wikipedia.org/wiki/Isostasy" target="_self"><tt>isostasy</tt></a>, and apply an existing Python package to study ice melting in the Antarctic.</li>
</ul>
<b>Abstract.</b> Numerical errors cannot be avoided, and we must have some knowledge of how
they impact our results. In the first part of the project we are going to
investigate round-off errors and truncation errors.
In the second part we are going to demonstrate the strength of some of the
libraries available in Python to visualize and manipulate large data
sets (sea level rise due to ice melting).

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Important!</b>
You are expected to hand in a project report in the form of a Jupyter
notebook.
The report should have logical structure starting with an abstract and
an introduction followed by your answers to the individual
exercises (code and discussion).
At the end of the report you should include some personal reflections and
a conclusion. In particular, comment on how possible numerical errors in the
Antarctica data set might impact your analysis.
</div>

Import the following stuff in your Jupyter notebook:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span> <span style="color: #408080; font-style: italic"># Import from standard library:</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pathlib</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">random</span>

 <span style="color: #408080; font-style: italic"># Import other stuff:</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>

 <span style="color: #408080; font-style: italic"># Packages needed for the last part? (uncomment to use):</span>
 <span style="color: #408080; font-style: italic">#import cmocean</span>
 <span style="color: #408080; font-style: italic">#import rockhound as rh</span>
 <span style="color: #408080; font-style: italic">#import xarray as xr</span>
</pre></div>
<p>
</div> <!-- end jumbotron -->

<h1 id="ex:round_err" class="anchor">Exercise 1</h1>

<p>
<b>Part 1.</b>
Run the following piece of code:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span>
sys<span style="color: #666666">.</span>float_info
</pre></div>
<p>
Explain in your own words the meaning of the numbers you see printed out.
Show how you can derive the following numbers
yourself: <code>max</code>, <code>min</code>, <code>epsilon</code>.

<p>
<b>Part 2.</b>
Consider the following code snippets:
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>a <span style="color: #666666">=</span> <span style="color: #666666">1</span>
b <span style="color: #666666">=</span> a<span style="color: #666666">/30</span>
b <span style="color: #666666">*=</span> <span style="color: #666666">30</span>

<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Is a=</span><span style="color: #BB6688; font-weight: bold">{}</span><span style="color: #BA2121"> equal to b=</span><span style="color: #BB6688; font-weight: bold">{}</span><span style="color: #BA2121">?: </span><span style="color: #BB6688; font-weight: bold">{}</span><span style="color: #BA2121">.&#39;</span><span style="color: #666666">.</span>format(a, b, a<span style="color: #666666">==</span>b))
</pre></div>
<p>
Explain the output.

<p>
<b>Part 3.</b>
Explain why 0.1+0.2 is not equal to 0.3:
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>a <span style="color: #666666">=</span> <span style="color: #666666">0.3</span>
b <span style="color: #666666">=</span> <span style="color: #666666">0.1+0.2</span>
<span style="color: #008000">print</span>(a<span style="color: #666666">==</span>b)
</pre></div>
<p>
Suggest a better way of testing whether two floating point numbers are equal.

<h1 id="exer:numpy_and_pandas" class="anchor">Exercise 2</h1>

<p>
In this exercise you will get some practice with two extremely useful Python libraries:
<a href="https://numpy.org/" target="_self">NumPy</a> and <a href="https://pandas.pydata.org/" target="_self">pandas</a>).

<p>
We will spend most time with NumPy, learning about various useful operations
you can apply to NumPy arrays (objects of the type <code>ndarray</code>). For scientific
applications it is almost always better to use NumPy arrays than native Python lists.

<p>
<b>Part 1.</b>

<p>
Run the code below for different values of \( N \):

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">draw_random_values_using_for_loop</span>(list_of_values, N):
    drawn <span style="color: #666666">=</span> []
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N):
        drawn<span style="color: #666666">.</span>append(random<span style="color: #666666">.</span>choice(list_of_values))
    <span style="color: #008000; font-weight: bold">return</span> drawn

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">draw_random_values_using_list_comprehension</span>(list_of_values, N):
    <span style="color: #008000; font-weight: bold">return</span> [random<span style="color: #666666">.</span>choice(list_of_values) <span style="color: #008000; font-weight: bold">for</span> _ <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N)]

N <span style="color: #666666">=</span> <span style="color: #666666">10</span>
M <span style="color: #666666">=</span> <span style="color: #666666">3</span>
list_of_numbers <span style="color: #666666">=</span> [i<span style="color: #666666">+1</span> <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(M)]

<span style="color: #666666">%</span>timeit draw_random_values_using_for_loop(list_of_numbers, N)
<span style="color: #666666">%</span>timeit draw_random_values_using_list_comprehension(list_of_numbers, N)
<span style="color: #666666">%</span>timeit random<span style="color: #666666">.</span>choices(list_of_numbers, k<span style="color: #666666">=</span>N)
<span style="color: #666666">%</span>timeit np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>choice(list_of_numbers, size<span style="color: #666666">=</span>N)
</pre></div>
<ul>
<li> What does the code do?</li>
<li> What can you say about the efficiency of the three functions? Experiment with different values of \( N \) and \( M \).</li>
</ul>

<b>Part 2.</b>

<p>
Below are some frequently useful NumPy commands:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>index <span style="color: #666666">=</span> np<span style="color: #666666">.</span>arange(<span style="color: #666666">1000</span>)
array_of_zeros <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(<span style="color: #666666">20</span>)
array_of_ones <span style="color: #666666">=</span> np<span style="color: #666666">.</span>ones(<span style="color: #666666">20</span>)
evenly_spaced_numbers <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">10</span>, <span style="color: #666666">11</span>)
evenly_spaced_numbers2  <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">10</span>, <span style="color: #666666">11</span>, endpoint<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>)
</pre></div>
<ul>
<li> Explain each of the above commands.</li>
<li> How would you go about doing the same things with native Python lists?</li>
</ul>

<b>Part 3.</b>

<p>
Lists are easily converted into Numpy arrays, e.g.:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>example_array <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">1</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>, <span style="color: #666666">5</span>, <span style="color: #666666">8</span>, <span style="color: #666666">13</span>, <span style="color: #666666">21</span>, <span style="color: #666666">34</span>])
</pre></div>
<p>
Some other useful commands are exemplified below:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>idx_of_ones <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(example_array <span style="color: #666666">==</span> <span style="color: #666666">1</span>)
<span style="color: #008000">print</span>(example_array[idx_of_ones])
is_equal_to_eight <span style="color: #666666">=</span> (example_array <span style="color: #666666">==</span> <span style="color: #666666">8</span>)
<span style="color: #008000">print</span>(example_array[is_equal_to_eight])
new_example_array <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(example_array <span style="color: #666666">==</span> <span style="color: #666666">1</span>, example_array, <span style="color: #666666">0</span>)
random_mdim <span style="color: #666666">=</span> np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>randint(<span style="color: #666666">100</span>, size<span style="color: #666666">=</span>(<span style="color: #666666">5</span>,<span style="color: #666666">5</span>))
nnz <span style="color: #666666">=</span> np<span style="color: #666666">.</span>count_nonzero(random_mdim)
</pre></div>
<ul>
<li> Explain what each line of code does.</li>
</ul>

<b>Part 4.</b>

<ul>
<li> How can we explain what happens in the code below?</li>
</ul>

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>vector <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>, <span style="color: #666666">4</span>, <span style="color: #666666">5</span>])
result <span style="color: #666666">=</span> <span style="color: #666666">2*</span>vector
<span style="color: #008000">print</span>(result)
</pre></div>
<p>
(This "trick" is extremely useful when doing numerical calculations!)

<p>
<b>Part 5.</b>
The text file <code>riccioli.dat</code> contains data <a href="#graney2012giovanni">[1]</a> for
experiments in which a clay ball was dropped from a high tower, and
subsequently experienced free fall.
For each recorded time, the estimated distance traveled has been reported
in units of <em>Roman feet</em> \footnote{These are very old measurements....}.

<ul>
<li> Read the data into a Pandas data frame object (tip: use the function <code>pd.read_csv</code>).</li>
<li> Make a scatter plot in which you distinguish between the different experiments with different markers and/or colors.</li>
</ul>

When you are done, your figure could look something like
figure (<a href="#fig:riccioli">1</a>).

<p>
<center> <!-- figure label: --> <div id="fig:riccioli"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 1:  Giovanni Riccioli's data on free fall.  <!-- caption label: fig:riccioli --> </p></center>
<p><img src="fig-project1/riccioli.png" align="bottom" width=400></p>
</center>

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Remember to label your figures!</b>
You should always label axes and provide informative legends in the
figures you make.
It can also be useful to include a title, and sometimes you may wish to
display axis grid lines to allow for an easier interpretation of your plots.
</div>


<h1 id="exer:free_fall" class="anchor">Exercise 3</h1>

<p>
In this exercise we are going to model a very simple physical system, and
use it to study numerical errors when solving the system in an approximate way.

<p>
Consider a heavy object moving either up or down in a constant gravitational
field. Since there is no horizontal displacement, Newton's law of motion
yields \( F=ma=-mg \), so that
$$
\begin{equation}
\frac{d^2x(t)}{dt^2}=-g\,,
\tag{1}
\end{equation}
$$

where \( x=x(t)\geq{0} \) is the height of the object above the ground at time \( t \).
The exact solution to this equation is
$$
\begin{equation}
x(t)=x_0-v_0 t-\frac{1}{2}gt^2\,,
\tag{2}
\end{equation}
$$

where \( v_{0} \) is the downwards velocity of the object at \( t=0 \). With this
sign convention, a negative \( v_0 \) would mean that the initial velocity
is upwards.

<p>
<b>Part 1.</b>
Write a Python function that returns the analytical solution,
equation <a href="#mjx-eqn-2">(2)</a>, for any values of \( t \), \( x_0 \), \( v_0 \), and \( g \).

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>READ THIS FIRST.</b>
For full marks on this exercise, \( t \) should be the first (positional) input
parameter, and the function should work both in the case when \( t \) is a
single number, and when it is a NumPy array.

<p>
The remaining three input arguments are optional, and they should be given
the following default values: \( x_0=10.0 \), \( v_0=0.0 \), and \( g=9.81 \).

<p>
You should also get into the habit of providing Python
<a href="https://realpython.com/documenting-python-code/" target="_self">Docstrings</a>
for your functions, classes, etc.
</div>


<p>
The code below exemplifies how you may start defining your function
(including writing a Docstring):
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">height_above_ground</span>(t, x0<span style="color: #666666">=10.0</span>, v0<span style="color: #666666">=0.0</span>, g<span style="color: #666666">=9.81</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Calculates the height above ground of an object experiencing</span>
<span style="color: #BA2121; font-style: italic">    vertical motion in a constant gravitational field.</span>

<span style="color: #BA2121; font-style: italic">    :param t: Time in seconds. Can be a single number, or an array.</span>
<span style="color: #BA2121; font-style: italic">    :param x0: Initial height of the object (default: 10.0 m).</span>
<span style="color: #BA2121; font-style: italic">    :param v0: Velocity at time zero (&gt;0 for downward direction)</span>
<span style="color: #BA2121; font-style: italic">               (default: 0 m/s).</span>
<span style="color: #BA2121; font-style: italic">    :param g: Gravitational constant (default: 9.81 m/s^2).</span>
<span style="color: #BA2121; font-style: italic">    :return: The height above ground at time(s) t (m).</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">return</span>  <span style="color: #408080; font-style: italic"># insert the actual code here</span>
</pre></div>
<p>
When using default input parameters, the function can be called by simply
typing <code>height_above_ground(t)</code>. On the other hand, if you want to use a
non-zero initial velocity you can write, e.g., <code>height_above_ground(t, v0=1.0)</code>.

<p>
<b>Part 2.</b>

<p>
Next, we are going to solve equation <a href="#mjx-eqn-1">(1)</a> using a simple numerical
scheme. From Taylor's polynomial formula it is possible to derive:
$$
\begin{equation}
\frac{d^2x(t)}{dt^2}=\frac{x(t+h)+x(t-h)-2\cdot x(t)}{h^2}
+\frac{h^2}{12} x^{(4)}(\eta)\,,
\tag{3}
\end{equation}
$$

where \( \eta \) is some number in the interval from \( t-h \) to \( t+h \).
Inserting this equation into <a href="#mjx-eqn-1">(1)</a> yields:
$$
\begin{align}
x(t+h) = 2\cdot x(t) - x(t-h) -g h^2 - \frac{h^4}{12} x^{(4)}(\eta)\,.
\tag{4}
\end{align}
$$

<!-- \mathcal{O}(h^4) -->
By neglecting the last term, and introducing the short-hand notation
\( x_n \) for the numerical approximation at time \( t_n\equiv n\cdot h \),
we might therefore suggest the following numerical scheme:
$$
\begin{align}
x_{n+1} =2x_n - x_{n-1} - g h^2\,.
\tag{5}
\end{align}
$$

<p>
A challenge with using formula <a href="#mjx-eqn-5">(5)</a> to compute the height of the
object at a given time step is that we need to know where the object was
at <em>the two previous time steps</em>. However, we are only given the height at
time zero!
The solution to this problem is to recognize that we have really specified
two initial conditions, one for position and one for velocity.
Since we know the initial velocity \( v_0 \), we can use it to estimate the
height at the end of the first time step. For now, we will assume:
$$
\begin{align}
x_{1} = x(t=h) \approx x_0 - v_{0}h \,.
\tag{6}
\end{align}
$$

<p>
Subsequent points \( x_2, x_3, \ldots \) can now be found by repeatedly
applying equation <a href="#mjx-eqn-5">(5)</a>.

<ul>
<li> Write a Python function that implements the above algorithm. Use a constant step size \( h \), and terminate the algorithm once a pre-specified time \( t_f \) has been reached (or would be surpassed if taking one more time step).</li>
<li> The function should return a tuple of arrays, \( (t, x(t)) \), see the code snippet below.</li>
</ul>

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">height_above_ground_numerical</span>(t_f, h, x0<span style="color: #666666">=10.0</span>, v0<span style="color: #666666">=0.0</span>, g<span style="color: #666666">=9.81</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    INSERT SOME MORE CODE DOCUMENTATION HERE....</span>

<span style="color: #BA2121; font-style: italic">    :param t_f: Maximum simulation time (seconds).</span>
<span style="color: #BA2121; font-style: italic">    :param h: Constant time step (seconds).</span>
<span style="color: #BA2121; font-style: italic">    :param x0: Initial height of the object (default: 10.0 m).</span>
<span style="color: #BA2121; font-style: italic">    :param v0: Velocity at time zero (&gt;0 for downward direction)</span>
<span style="color: #BA2121; font-style: italic">               (default: 0 m/s).</span>
<span style="color: #BA2121; font-style: italic">    :param g: Gravitational constant (default: 9.81 m/s^2).</span>
<span style="color: #BA2121; font-style: italic">    :return: A tuple of arrays (t, x(t)) containing the numerical</span>
<span style="color: #BA2121; font-style: italic">             solution at times 0, h, 2*h, 3*h, ..., N*h &lt;= t_f.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #408080; font-style: italic"># Create local variables and do calculations here...</span>
    <span style="color: #008000; font-weight: bold">return</span> t_array, x_array
</pre></div>
<p>
You may use this code as a starting point for your own implementation.

<p>
<b>Part 3.</b>

<p>
Let \( x_0=10.0 \), \( v_0=0.0 \), and \( g=9.81 \).

<ol>
<li> Apply your previous function to the case \( t_f=1.4 \).</li>
<li> For each of the constant step-sizes \( h=0.1, 0.01, 0.001 \), do the following: Compare your numerical solution (scatter plot) to the analytical solution (a solid line). Comment on the results.</li>
</ol>

<b>Part 4.</b>

<p>
<center> <!-- figure label: --> <div id="fig:global_error"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 2:  Illustration of the difference between global and local numerical error.  <!-- caption label: fig:global_error --> </p></center>
<p><img src="fig-project1/global_error.png" align="bottom" width=400></p>
</center>

<p>
We now want to study the <em>global</em> numerical error at the end of the last time
step, \( t=t_N \leq t_f \) (the exact time will be the integer part of \( t_f/h \)).
To save computational time, we now choose \( t_f=0.1 \) seconds.

<ol>
<li> Write a Python function takes as input an array of step sizes, and returns an array containing global errors at the specific time \( t=t_N \). The function should be able to return both <em>absolute</em> and <em>relative</em> errors, depending on user input.</li>
<li> Compare the error for \( h=5\cdot10^{-7}, 10^{-6}, 5\cdot10^{-6}, 10^{-5}, 10^{-4}, 10^{-3}, 10^{-2} \). Plot both the absolute and relative error versus \( h \). Discuss the difference between the two curves.</li>
<li> Explain the shape of the relative numerical error curve. Pay special attention to the slopes. Are they what you expect?</li>
</ol>

<b>Part 5.</b>

<p>
The global error in Part 4 is of much lower order than
\( \mathcal{O}(h^3) \), which one might naively
expect\footnote{Frequently, if the local truncation error is
\( \mathcal{O}(h^{p+1}) \), the global error is \( \mathcal{O}(h^p) \)}
should be the case from equation <a href="#mjx-eqn-4">(4)</a>.
How can this be?
To understand this we need to go back to our approximation of the
velocity term, equation <a href="#mjx-eqn-6">(6)</a>.
From the requirement that
$$
\begin{equation}
\left.\frac{dx}{dt}\right|_{x=0} = -v_0\,,
\tag{7}
\end{equation}
$$

we have implicitly used Taylor's formula to replace the derivative at
\( t=0 \) with
$$
\begin{align}
\left.\frac{dx}{dt}\right|_{x=0} &=
\frac{x_1-x_0}{h} - \frac{h}{2} x^{\prime\prime}(\xi) = -v_0 \,, \nonumber \\ 
&\Longrightarrow x_1 = x_0 - h\cdot v_0 + \frac{h^2}{2}x^{\prime\prime}(\xi) \,,
\tag{8}
\end{align}
$$

for some \( \xi \) in \( [0, h] \).
We now see that our implementation introduces a local truncation error of
order \( \mathcal{O}(h^2) \).

<p>
Can we do better? Again, let us naively go ahead and apply the centered
difference formula
$$
\begin{align}
\left.\frac{dx}{dt}\right|_{x=0} &=
\frac{x_1 - x_{-1}}{2h} - \frac{h^2}{6}x^{(3)}(\xi) = -v_0 \,, \no 
\tag{9}\\ 
&\Longrightarrow x_{-1} = x_1 + 2hv_0 - \frac{h^3}{3}x^{(3)}(\xi) \,.
\tag{10}
\end{align}
$$

The point \( x_{-1} \) has not been defined, but equation <a href="#mjx-eqn-5">(5)</a> with
\( n=0 \) leads to the requirement \( x_{-1} = 2\cdot x_0-x_1-gh^2 \), so that we
can eliminate \( x_{-1} \) from equation <a href="#mjx-eqn-10">(10)</a> to find
$$
\begin{align}
x_{1} &= x_0 - h\cdot v_0 - \frac{1}{2}gh^2 - \frac{h^3}{6} x^{(3)}(\xi)
\nonumber \\ 
&= x_0 - h\cdot v_0 - \frac{1}{2}gh^2 + \mathcal{O}(h^3)\,.
\tag{11}
\end{align}
$$


<ul>
<li> Repeat the simulations you did in Part 4, except that now you use \( x_1 \) from equation <a href="#mjx-eqn-11">(11)</a> to initialize the model (ignore the last term).</li>
<li> Again, plot the curve showing the global relative error at the final simulation time as a function of \( h \).</li>
<li> What do you see this time? Are the results consistent with what you expect from equation <a href="#mjx-eqn-11">(11)</a>? Why / why not?</li>
</ul>

A hint for the last question: Carefully study the analytical solution...

<p>
<b>Part 6 (OPTIONAL).</b>
Consider again the data you read from the text file <code>riccioli.dat</code>.

<ol>
<li> First, assume that the measurements were extremely accurate. Under this interpretation, approximately how many Roman feet is in a meter? (Hint: Adapt and then fit your analytical model to the data, either manually or with an automatic curve-fitting routine, e.g. <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html" target="_self"><tt>curve_fit</tt></a>)</li>
<li> The last of the three experiments was conducted by dropping balls from the Asinelli Tower. According to the experimenter Giovanni Riccioli (1598-1671), the height of the tower back then was 312 Roman feet. Modern measurements say it is 98.37 m high. Assuming both of these values to be correct, what you say about the accuracy of Riccioli's measurements?</li>
<li> Can you think of ways to improve the current model?</li>
</ol>

<h1 id="exer:isostasy" class="anchor">Exercise 4</h1>

<p>
Most of the ice on Earth is located in the Antarctic. In recent years there
has been a great deal of activity to map the ice and the bedrock of Antarctica.
Most of these data are freely available, and we can use them to investigate
different scenarios. For instance, one natural question to ask is the following:
if all the ice melts, how much does the sea level increase (SLR)?

<p>
To calculate the sea level rise, we need to know not only how thick the ice is,
but also the elevation above the bedrock. In this exercise you will see how we
can use Python together with available data and libraries made by others
to do quite advanced calculations.

<p>
Let us start by deriving a result that you may have seen before.
We shall consider an iceberg that is floating and which is not impacted by
any other forces than gravity (figure <a href="#fig:iceberg">3</a>).
The Archimedean principle tells us that buoyancy is proportional
to <em>the mass of displaced water</em>, hence Newton's 2nd law yields

$$
\begin{equation}
\tag{12}
m_\text{ice}\,g-\rho_{seawater}V_{\text{H$_2$O}}^\text{disp}\,g=0,
\end{equation}
$$

<p>
where \( \rho \) is the density (mass divided by volume), and \( g \) the
gravitational constant.

<p>
<center> <!-- figure label: --> <div id="fig:iceberg"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 3:  A schematic illustration of an iceberg. \( V_{\mathrm{H_{2}O}}^{\mathrm{disp}} \) is the volume of water displaced by the iceberg.  <!-- caption label: fig:iceberg --> </p></center>
<p><img src="fig-project1/iceberg.png" align="bottom" width=400></p>
</center>

<p>
As the ice melts it must end up as an equal mass of water:

$$
\rho_\text{ice}V_\text{ice}=m_\text{ice}
=m_\text{ice water}=\rho_\text{ice water}V_\text{ice water}\,.
$$

<p>
By inserting the right-most expression for the mass of ice into
equation <a href="#mjx-eqn-12">(12)</a>, and dividing by \( g \), we get:

$$
\begin{equation}
\tag{13}
V_{\text{H$_2$O}}^\text{disp}=\frac{\rho_\text{ice water}}{\rho_{seawater}}V_\text{ice water}.
\end{equation}
$$

<p>
Therefore, the net contribution to sea level rise can be captured by
$$
\begin{equation}
\Delta{V}\equiv V_\text{ice water}-V_{\text{H$_2$O}}^\text{disp}=
\left(1-\frac{\rho_\text{ice water}}{\rho_{seawater}}\right)V_\text{ice water}.
\tag{14}
\end{equation}
$$

<p>
It follows that if we assume the iceberg has the same density as seawater,
then <em>there is no contribution from a floating iceberg to sea level rise</em>.
On the other hand, if the density of ice is lower than that of seawater,
there is a contribution.

<p>
<b>Part 1 (OPTIONAL).</b>
The North Pole consists of ice floating in the sea. A rough estimate is that
it contains 15$\cdot 10^3$ km$^3$ of ice. Calculate the net volume of water
these icebergs would contribute to the oceans if we can assume that seawater
has an average density of 1030 \( \mathrm{kg/m^3} \), ice has a density of
917 \( \mathrm{kg/m^3} \), and that melted ice (ice water) has a density of
1000 \( \mathrm{kg/m^3} \).

<p>
<b>Part 2 (OPTIONAL).</b>
The earth radius is about 6371 km, and we will assume that it is a sphere
and therefore has a surface area of \( R=4\pi R^2 \).
About 71$\%$ of the earth is covered by water. If the volume of melted water
is distributed evenly across the earth surface, how much sea level rise
would the melted North Pole ice contribute with?

<p>
<b>Part 3.</b>
Next, we will work with the <em>bedmap2</em> dataset <a href="#fretwell2013bedmap2">[2]</a> for
Antarctica (the South Pole).
We shall use the <a href="https://www.fatiando.org/rockhound/latest/" target="_self">rockhound</a>
library to load in and visualize the data. As an aid to the plotting, we
will also employ color maps from the
<a href="https://pypi.org/project/cmocean/" target="_self">cmocean</a> library <a href="#thyng2016true">[3]</a>.
Therefore, you should start by making sure that you have both
cmocean and rockhound installed to the Python kernel that you
use in your Jupyter notebook.
Once both packages are installed, do the following:

<ul>
<li> Run the following code (from the rockhound <a href="https://www.fatiando.org/rockhound/latest/api/generated/rockhound.fetch_bedmap2.html" target="_self">library documentation</a>), and reproduce figure <a href="#fig:bedmap2_ice_thickness">4</a>.</li>
</ul>

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>bedmap <span style="color: #666666">=</span> rh<span style="color: #666666">.</span>fetch_bedmap2(datasets<span style="color: #666666">=</span>[<span style="color: #BA2121">&quot;thickness&quot;</span>,<span style="color: #BA2121">&quot;surface&quot;</span>,<span style="color: #BA2121">&quot;bed&quot;</span>])
plt<span style="color: #666666">.</span>figure(figsize<span style="color: #666666">=</span>(<span style="color: #666666">8</span>, <span style="color: #666666">7</span>))
ax <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>subplot(<span style="color: #666666">111</span>)
bedmap<span style="color: #666666">.</span>surface<span style="color: #666666">.</span>plot<span style="color: #666666">.</span>pcolormesh(ax<span style="color: #666666">=</span>ax,cmap<span style="color: #666666">=</span>cmocean<span style="color: #666666">.</span>cm<span style="color: #666666">.</span>ice,
                       cbar_kwargs<span style="color: #666666">=</span><span style="color: #008000">dict</span>(pad<span style="color: #666666">=0.01</span>, aspect<span style="color: #666666">=30</span>))
plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">&quot;Bedmap2 Antarctica&quot;</span>)
plt<span style="color: #666666">.</span>tight_layout()
plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
<center> <!-- figure label: --> <div id="fig:bedmap2_ice_thickness"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 4:  Visualization of the ice thickness in Antarctica.  <!-- caption label: fig:bedmap2_ice_thickness --> </p></center>
<p><img src="fig-project1/bedmap2_plot.png" align="bottom" width=400></p>
</center>

<p>
This may take quite some time, so it is recommended to not run the cell
generating the plot more often than you have to.

<p>
<b>Part 4.</b>

<p>
As in the North Pole example, much of the ice above the sea level cannot
contribute to sea level rise. The height above the seawater at which an
iceberg floats is called the <em>freeboard</em>.
Ignoring salinity effects, the volume of ice needed to replace an equivalent
volume of seawater is

$$
\begin{equation}
\tag{15}
V_\text{ice}=V_w\frac{\rho_w}{\rho_\text{ice}}\,.
\end{equation}
$$

<p>
All the blocks in the data set are of equal size, we can convert the volume
to an ice thickness:

$$
\begin{equation}
\tag{16}
h_\text{ice}=h_w\frac{\rho_w}{\rho_\text{ice}}\,.
\end{equation}
$$

<p>
The Thwaites glacier, named after Fredrik T. Thwaites, is of particular
interest. Also referred to as the Doomsday glacier, it is a fast moving
glacier (up to 4 km/year) at the coast of Antarctica, roughly 120 km wide.
It is called the Doomsday glacier because it is believed that it may trigger
a <a href="https://interactive.pri.org/2019/05/antarctica/doomed-glacier-race.html" target="_self">collapse of west Antarctica</a>.
For now we can use the bedmap2 dataset to view a cross section of the glacier,
\( y=-0.5\cdot10^{6} \) and \( x\in[-1.6\cdot10^6,-1.35\cdot 10^6] \):
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Extract cross section using the original coordinates</span>
bed1d<span style="color: #666666">=</span>bedmap<span style="color: #666666">.</span>sel(y<span style="color: #666666">=-0.5e6</span>, x<span style="color: #666666">=</span><span style="color: #008000">slice</span>(<span style="color: #666666">-1.6e6</span>,<span style="color: #666666">-1.35e6</span>))

<span style="color: #408080; font-style: italic"># Add a second x-coordinate to make prettier plots</span>
<span style="color: #408080; font-style: italic"># (shift x-axis to start at zero, and convert from m to km)</span>
bed1d<span style="color: #666666">=</span>bed1d<span style="color: #666666">.</span>assign_coords({<span style="color: #BA2121">&quot;x2&quot;</span>:((bed1d<span style="color: #666666">.</span>x<span style="color: #666666">+1.6e6</span>)<span style="color: #666666">/1e3</span>)})
</pre></div>
<p>
It is now possible to plot the values in the <code>bed1d</code> data array by simply
typing
<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>bed1d<span style="color: #666666">.</span>surface<span style="color: #666666">.</span>plot(x<span style="color: #666666">=</span><span style="color: #BA2121">&#39;x2&#39;</span>)
</pre></div>
<p>
When making customized plots it is often best to use the <code>matplotlib.pyplot</code>
module manually \footnote{In the above code, matplotlib is used under the hood.}.
Then we probably need to extract the underlying NumPy arrays containing the
data we are interested in. For example, the command
<code>surface=bed1d['surface'].values</code> can be used to extract an array containing
the surface elevation values.

<ul>
<li> Use the equation to the left in figure <a href="#fig:cross">5</a> to calculate the freeboard level.</li>
<li> Make a cross section plot of the ice thickness, bed rock, and freeboard level, similar to (the right) figure (<a href="#fig:cross">5</a>)</li>
<li> Explain what you see. Is the shape of the bedrock important for sea level rise?</li>
</ul>

<center> <!-- figure label: --> <div id="fig:cross"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 5:  (left) How to calculate the freeboard level. (right) Cross section plot of Thwaites glacier.  <!-- caption label: fig:cross --> </p></center>
<p><img src="fig-project1/free_cross.png" align="bottom" width=400></p>
</center>

<p>
<b>Part 5.</b>
Finally, we are going to use the whole bedmap data set to calculate the sea
level rise (SLR) if all the ice of Antarctica melted.

<ol>
<li> Estimate the height of ice that can contribute to SLR for all the cells in the data set. Multiply the height with the area of each cell (\( 1000\times1000 \) meters) in order to estimate the volume of ice.</li>
<li> Assume that this volume is distributed evenly over the earth surface. What is then height of the SLR?</li>
</ol>

<b>Part 6.</b>
Include in the final discussion: How can we use the bedmap data to improve decision making? What are the limitations in your calculation of sea level rise, are there any numerical errors, what kind of other data would you like to have to improve your model (e.g. ice velocity, temperature, ...) and why?

<h1 id="___sec4" class="anchor">Guidelines for project submission </h1>
The project has to be handed in as a notebook, though you can submit an additional PDF if you want. 
You should bear the following points in mind when working on the project:

<ul>
<li> Start your notebook by providing a short introduction in which you outline the nature of the problem(s) to be investigated.</li>
<li> End your notebook with a brief summary of what you feel you learned from the project (if anything). Also, if you have any general comments or suggestions for what could be improved in future assignments, this is the place to do it.</li>
<li> All code that you make use of should be present in the notebook, and it should ideally execute without any errors (especially run-time errors). If you are not able to fix everything before the deadline, you should give your best understanding of what is not working, and how you might go about fixing it.</li>
<li> Functions that you code <em>should be reusable, never copy and paste code</em>. Copy and paste is a strong indication that you instead should define function.</li>
<li> If you use an algorithm that is not fully described in the assignment text, you should try to explain it in your own words. This also applies if the method is described elsewhere in the course material.</li>
<li> In some cases it may suffice to explain your work via comments in the code itself, but other times you might want to include a more elaborate explanation in terms of, e.g., mathematics and/or pseudocode.</li>
<li> In general, it is a good habit to comment your code (though it can be overdone).</li>
<li> When working with approximate solutions to equations, it is always useful to check your results against known exact (analytical) solutions, should they be available.</li>
<li> It is also a good test of a model implementation to study what happens at known 'edge cases'.</li>
<li> Any figures you include should be easily understandable. You should label axes appropriately, and depending on the problem, include other legends etc. Also, you should discuss your figures in the main text.</li>
<li> It is always good if you can reflect a little bit around <em>why</em> you see what you see.</li>
</ul>

<h1 id="___sec5" class="anchor">Bibliography </h1>

<p>
<!-- begin bibliography -->

<ol>
 <li> <div id="graney2012giovanni"></div> <b>C. M. Graney</b>. 
    Anatomy of a Fall: Giovanni Battista Riccioli and the Story of G,
    <em>Phys. Today</em>,
    65(9),
    pp. 36,
    2012.</li>
 <li> <div id="fretwell2013bedmap2"></div> <b>P. Fretwell, H. D. Pritchard, D. G. Vaughan, J. L. Bamber, N. E. Barrand, R. Bell, C. Bianchi, R. Bingham, D. D. Blankenship and G. Casassa</b>. 
    Bedmap2: Improved Ice Bed, Surface and Thickness Datasets for Antarctica,
    <em>The Cryosphere</em>,
    7(1),
    pp. 375-393,
    2013.</li>
 <li> <div id="thyng2016true"></div> <b>K. M. Thyng, C. A. Greene, R. D. Hetland, H. M. Zimmerle and S. F. DiMarco</b>. 
    True Colors of Oceanography: Guidelines for Effective and Accurate Colormap Selection,
    <em>Oceanography</em>,
    29(3),
    pp. 9-13,
    2016.</li>
</ol>

<!-- end bibliography -->

<p>

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

