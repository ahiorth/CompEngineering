<!--
File automatically generated using DocOnce (https://github.com/doconce/doconce/):
doconce format html book.do.txt CHAPTER=chapter BOOK=book APPENDIX=appendix --exercise_numbering=chapter --html_style=bootswatch_journal --html_code_style=inherit --html_output=book
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Modeling and Computational Engineering">
<meta name="keywords" content="types,basic types,lists,list comprehension,numerical error,Taylor polynomial,truncation error,Taylor polynomial, error term,Maclaurin series,forward difference,backward difference,central difference,central difference,roundoff erros,machine precision,IEEE 754-1985 standard,roundoff errors,continuity equation,finite volume,Gauss-Jordan elimination,pivoting,LU decomposition,Jacobi method,Gauss-Seidel method,linear regression,sparse matrix,Thomas algorithm,fixed-point iteration,rate of convergence,bisection method,rate of convergence,Newtons method,Newtons method, rate of convergence,secant method,secant method, rate of convergence,Newton Rapson method,gradient descent,midpoint method,trapezoidal method,numerical integrals, error,Richardson extrapolation,Romberg integration,Gaussian quadrature,Gaussian quadrature, error term,numerical integral, infinite,continuous stirred tank reactor (CSTR),Eulers method,Eulers method, error analysis,Eulers method, adaptive step size,Runge-Kutta,Runge-Kutta, adaptive step size,adaptive step size,stiff equations,implicit method,Monte Carlo integration,random number generators,Mersenne Twister,encryption,Monte Carlo Integration, error,binomial distribution,mean,variance,Monte Carlo integration, mean value,recursive functions,central limit theorem,birthday paradox">
<title>Modeling and Computational Engineering</title>
<!-- Bootstrap style: bootswatch_journal -->
<!-- doconce format html book.do.txt CHAPTER=chapter BOOK=book APPENDIX=appendix --exercise_numbering=chapter --html_style=bootswatch_journal --html_code_style=inherit --html_output=book -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/journal/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:60px;      /* fixed header height for style bootswatch_journal */
  margin:-60px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [('Table of contents',
               0,
               'table_of_contents',
               'table_of_contents'),
              ('Preface', 0, 'ch:preface', 'ch:preface'),
              ('Introduction to Python', 0, 'ch:pyt', 'ch:pyt'),
              ('Personal guidelines', 1, None, 'personal-guidelines'),
              ('Code editor', 2, None, 'code-editor'),
              ('Types in Python', 1, None, 'types-in-python'),
              ('Basic types', 2, None, 'basic-types'),
              ('Lists', 2, None, 'lists'),
              ('List arithmetic', 3, None, 'list-arithmetic'),
              ('List slicing', 3, None, 'list-slicing'),
              ('Numpy arrays', 2, None, 'numpy-arrays'),
              ('Array slicing', 3, None, 'array-slicing'),
              ('Dictionaries', 2, None, 'dictionaries'),
              ('Looping', 1, None, 'looping'),
              ('For-loops', 2, None, 'for-loops'),
              ('While-loops', 2, None, 'while-loops'),
              ('Functions in Python', 2, None, 'functions-in-python'),
              ('Defining a mathematical function',
               2,
               None,
               'defining-a-mathematical-function'),
              ('Scope of variables', 2, None, 'scope-of-variables'),
              ('Passing arrays and lists to functions',
               2,
               None,
               'passing-arrays-and-lists-to-functions'),
              ('Call by value or call by reference',
               2,
               None,
               'call-by-value-or-call-by-reference'),
              ('Floats and integers', 3, None, 'floats-and-integers'),
              ('Lists and arrays', 3, None, 'lists-and-arrays'),
              ('Mutable and immutable objects',
               2,
               None,
               'mutable-and-immutable-objects'),
              ('Introduction to Pandas', 0, 'ch:pan', 'ch:pan'),
              ('What is Pandas?', 1, None, 'what-is-pandas'),
              ('Creating a data frame', 1, None, 'creating-a-data-frame'),
              ('From an empty DataFrame', 2, None, 'from-an-empty-dataframe'),
              ('Create DataFrame from dictionary',
               2,
               None,
               'create-dataframe-from-dictionary'),
              ('From a file', 2, None, 'from-a-file'),
              ('Accessing data in  DataFrames',
               2,
               None,
               'accessing-data-in-dataframes'),
              ('Selecting columns', 3, None, 'selecting-columns'),
              ('Selecting rows', 3, None, 'selecting-rows'),
              ('Challenges when accessing columns or rows',
               3,
               None,
               'challenges-when-accessing-columns-or-rows'),
              ('Time columns not parsed properly',
               3,
               None,
               'time-columns-not-parsed-properly'),
              ('Filtering and visualizing data',
               2,
               None,
               'filtering-and-visualizing-data'),
              ('Boolean masking', 3, None, 'boolean-masking'),
              ('Plotting a DataFrame', 3, None, 'plotting-a-dataframe'),
              ('Performing mathematical operations on DataFrames',
               2,
               None,
               'performing-mathematical-operations-on-dataframes'),
              ('Example: mathematical operations on DataFrames',
               3,
               None,
               'example-mathematical-operations-on-dataframes'),
              ('Solution', 3, None, 'solution'),
              ('Grouping, filtering and aggregating data',
               2,
               None,
               'grouping-filtering-and-aggregating-data'),
              ('Simple statistics in Pandas',
               2,
               None,
               'simple-statistics-in-pandas'),
              ('Joining two DataFrames', 2, None, 'joining-two-dataframes'),
              ('Appending DataFrames', 3, None, 'appending-dataframes'),
              ('Merging DataFrames', 3, None, 'merging-dataframes'),
              ('Working with folders and files',
               2,
               None,
               'working-with-folders-and-files'),
              ('Basic use of Pathlib', 3, None, 'basic-use-of-pathlib'),
              ('Basic use of `os`', 3, None, 'basic-use-of-os'),
              ('Splitting data into different folders and files',
               3,
               None,
               'splitting-data-into-different-folders-and-files'),
              ('Writing more robust code', 2, None, 'writing-more-robust-code'),
              ('Finite differences', 0, 'ch:taylor', 'ch:taylor'),
              ('Why are gradients important?',
               1,
               None,
               'why-are-gradients-important'),
              ('Continuous functions and finite representation: numerical '
               'errors',
               1,
               None,
               'continuous-functions-and-finite-representation-numerical-errors'),
              ('Taylor polynomial approximation',
               1,
               None,
               'taylor-polynomial-approximation'),
              ('Calculating Numerical Derivatives of Functions',
               1,
               None,
               'calculating-numerical-derivatives-of-functions'),
              ('Higher order derivative',
               3,
               'sec:taylor:hhd',
               'sec:taylor:hhd'),
              ('Roundoff Errors', 2, None, 'roundoff-errors'),
              ('Binary numbers', 3, None, 'binary-numbers'),
              ('Floating point numbers and the IEEE 754-1985 standard',
               3,
               None,
               'floating-point-numbers-and-the-ieee-754-1985-standard'),
              ('Roundoff error and truncation error in numerical derivatives',
               3,
               None,
               'roundoff-error-and-truncation-error-in-numerical-derivatives'),
              ('Partial differential equations and linear systems',
               0,
               'ch:lin',
               'ch:lin'),
              ('The continuity equation', 1, None, 'the-continuity-equation'),
              ('Continuity equation as a linear problem',
               1,
               None,
               'continuity-equation-as-a-linear-problem'),
              ('Boundary conditions', 3, None, 'boundary-conditions'),
              ('Solving linear equations', 1, None, 'solving-linear-equations'),
              ('Gauss-Jordan elimination', 2, None, 'gauss-jordan-elimination'),
              ('Pivoting', 2, None, 'pivoting'),
              ('LU decomposition', 2, None, 'lu-decomposition'),
              ('Iterative methods', 1, None, 'iterative-methods'),
              ('Iterative improvement', 2, None, 'iterative-improvement'),
              ('The Jacobi method', 2, None, 'the-jacobi-method'),
              ('The Gauss-Seidel method', 2, None, 'the-gauss-seidel-method'),
              ('Example: Linear regression',
               1,
               None,
               'example-linear-regression'),
              ('Solving least square, using algebraic equations',
               2,
               None,
               'solving-least-square-using-algebraic-equations'),
              ('Least square as a linear algebra problem',
               2,
               None,
               'least-square-as-a-linear-algebra-problem'),
              ('Working with matrices on component form',
               2,
               None,
               'working-with-matrices-on-component-form'),
              ('Sparse matrices and Thomas algorithm',
               1,
               None,
               'sparse-matrices-and-thomas-algorithm'),
              ('Example: Solving the heat equation using linear algebra',
               1,
               None,
               'example-solving-the-heat-equation-using-linear-algebra'),
              ('Exercise 4.1: Conservation Equation or the Continuity Equation',
               2,
               None,
               'exercise-4-1-conservation-equation-or-the-continuity-equation'),
              ('Heat equation for solids', 3, None, 'heat-equation-for-solids'),
              ('Exercise 4.2: Curing of Concrete and Matrix Formulation',
               2,
               None,
               'exercise-4-2-curing-of-concrete-and-matrix-formulation'),
              ('Exercise 4.3: Solve the full heat equation',
               2,
               None,
               'exercise-4-3-solve-the-full-heat-equation'),
              ('Exercise 4.4: Using sparse matrices in python',
               2,
               None,
               'exercise-4-4-using-sparse-matrices-in-python'),
              ('CO$_2$ diffusion into aquifers',
               1,
               None,
               'co-2-diffusion-into-aquifers'),
              ('Optimization and nonlinear systems', 0, 'ch:nlin', 'ch:nlin'),
              ('Nonlinear equations', 1, None, 'nonlinear-equations'),
              ('Example: van der Waals equation of state',
               1,
               None,
               'example-van-der-waals-equation-of-state'),
              ('Exercise 5.1: van der Waal EOS and CO$_2$',
               2,
               None,
               'exercise-5-1-van-der-waal-eos-and-co-2'),
              ('Fixed-point iteration', 1, None, 'fixed-point-iteration'),
              ('Exercise 5.2: Implement the fixed point iteration',
               2,
               None,
               'exercise-5-2-implement-the-fixed-point-iteration'),
              ('Exercise 5.3: Finding the molar volume from the van der Waal '
               'EOS by fixed point iteration',
               2,
               None,
               'exercise-5-3-finding-the-molar-volume-from-the-van-der-waal-eos-by-fixed-point-iteration'),
              ('When does the fixed point method fail?',
               2,
               'sec:nlin:fp',
               'sec:nlin:fp'),
              ('What to do when the fixed point method fails',
               2,
               None,
               'what-to-do-when-the-fixed-point-method-fails'),
              ('Exercise 5.4: Solve $x=e^{1-x^2}$ using fixed point iteration',
               2,
               None,
               'exercise-5-4-solve-x-e-1-x-2-using-fixed-point-iteration'),
              ('Rate of convergence', 1, None, 'rate-of-convergence'),
              ('The bisection method', 1, None, 'the-bisection-method'),
              ('Rate of convergence', 2, None, 'rate-of-convergence'),
              ("Newton's method", 1, None, 'newton-s-method'),
              ('Rate of convergence', 2, None, 'rate-of-convergence'),
              ('Exercise 5.5: Compare Newtons, Bisection and the Fixed Point '
               'method',
               2,
               None,
               'exercise-5-5-compare-newtons-bisection-and-the-fixed-point-method'),
              ('Secant method', 1, None, 'secant-method'),
              ('Rate of convergence', 2, None, 'rate-of-convergence'),
              ('Newton Rapson method', 1, None, 'newton-rapson-method'),
              ('Gradient descent', 1, None, 'gradient-descent'),
              ('Exercise 5.6: Gradient descent solution of linear regression',
               2,
               None,
               'exercise-5-6-gradient-descent-solution-of-linear-regression'),
              ('Other useful methods', 1, None, 'other-useful-methods'),
              ('Numerical integration', 0, 'ch:numint', 'ch:numint'),
              ('Algorithmic thinking', 1, None, 'algorithmic-thinking'),
              ('The midpoint rule', 2, None, 'the-midpoint-rule'),
              ('The trapezoidal rule', 2, None, 'the-trapezoidal-rule'),
              ('Numerical errors on integrals',
               2,
               None,
               'numerical-errors-on-integrals'),
              ('Practical estimation of errors on integrals (Richardson '
               'extrapolation)',
               2,
               None,
               'practical-estimation-of-errors-on-integrals-richardson-extrapolation'),
              ('Romberg integration', 1, None, 'romberg-integration'),
              ('Alternative implementation of adaptive integration',
               2,
               None,
               'alternative-implementation-of-adaptive-integration'),
              ('Gaussian quadrature', 1, None, 'gaussian-quadrature'),
              ('The case N=3', 3, None, 'the-case-n-3'),
              ('Error term on Gaussian integration',
               2,
               None,
               'error-term-on-gaussian-integration'),
              ('Common weight functions for classical Gaussian quadratures',
               2,
               None,
               'common-weight-functions-for-classical-gaussian-quadratures'),
              ('Integrating functions over an infinite range',
               1,
               None,
               'integrating-functions-over-an-infinite-range'),
              ('Exercise 6.1: Numerical Integration',
               2,
               None,
               'exercise-6-1-numerical-integration'),
              ('Ordinary differential equations', 0, 'ch:ode', 'ch:ode'),
              ('0D models', 1, None, '0d-models'),
              ('Ordinary differential equations',
               1,
               None,
               'ordinary-differential-equations'),
              ('A simple model for fluid flow',
               1,
               None,
               'a-simple-model-for-fluid-flow'),
              ("Euler's method", 1, None, 'euler-s-method'),
              ("Error analysis - Euler's method",
               2,
               None,
               'error-analysis-euler-s-method'),
              ("Adaptive step size - Euler's method",
               2,
               None,
               'adaptive-step-size-euler-s-method'),
              ('Runge-Kutta methods', 1, None, 'runge-kutta-methods'),
              ('Adaptive step size - Runge-Kutta method',
               2,
               None,
               'adaptive-step-size-runge-kutta-method'),
              ('Conservation of mass', 2, None, 'conservation-of-mass'),
              ('Solving a set of ODE equations',
               1,
               None,
               'solving-a-set-of-ode-equations'),
              ('Stiff sets of ODE  and implicit methods',
               1,
               None,
               'stiff-sets-of-ode-and-implicit-methods'),
              ("Exercise 7.1: Truncation error in Euler's method",
               2,
               None,
               'exercise-7-1-truncation-error-in-euler-s-method'),
              ('Monte Carlo Methods', 0, 'ch:mc', 'ch:mc'),
              ('Monte Carlo methods', 1, None, 'monte-carlo-methods'),
              ("Monte Carlo integration  ''hit and miss''",
               1,
               None,
               'monte-carlo-integration-hit-and-miss'),
              ('Random number generators', 2, None, 'random-number-generators'),
              ('Encryption', 2, None, 'encryption'),
              ('Errors on Monte Carlo integration and the binomial '
               'distribution',
               2,
               None,
               'errors-on-monte-carlo-integration-and-the-binomial-distribution'),
              ('The mean value method', 2, None, 'the-mean-value-method'),
              ('Basic properties of probability distributions',
               2,
               None,
               'basic-properties-of-probability-distributions'),
              ('Example: Monte Carlo integration of a hyper sphere',
               2,
               None,
               'example-monte-carlo-integration-of-a-hyper-sphere'),
              ('Exercise 8.1: The central limit theorem',
               2,
               'ex:mc:norm',
               'ex:mc:norm'),
              ('Remarks', 3, None, 'remarks'),
              ('Exercise 8.2: Birthday Paradox', 2, 'ex:mc:BP', 'ex:mc:BP'),
              ('References', 1, None, 'references')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\no}{\nonumber}
\newcommand{\co}{CO$_2$}
$$



<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="book.html">Modeling and Computational Engineering</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._book001.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="._book001.html#ch:preface" style="font-size: 80%;"><b>Preface</b></a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#ch:pyt" style="font-size: 80%;"><b>Introduction to Python</b></a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#personal-guidelines" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Personal guidelines</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#code-editor" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Code editor</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#types-in-python" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Types in Python</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#basic-types" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic types</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#lists" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lists</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#list-arithmetic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List arithmetic</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#list-slicing" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List slicing</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#numpy-arrays" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numpy arrays</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#array-slicing" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Array slicing</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#dictionaries" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dictionaries</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#looping" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Looping</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#for-loops" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For-loops</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#while-loops" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;While-loops</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#functions-in-python" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Functions in Python</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#defining-a-mathematical-function" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defining a mathematical function</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#scope-of-variables" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scope of variables</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#passing-arrays-and-lists-to-functions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Passing arrays and lists to functions</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#call-by-value-or-call-by-reference" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call by value or call by reference</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#floats-and-integers" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Floats and integers</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#lists-and-arrays" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lists and arrays</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#mutable-and-immutable-objects" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mutable and immutable objects</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#ch:pan" style="font-size: 80%;"><b>Introduction to Pandas</b></a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#what-is-pandas" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;What is Pandas?</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#creating-a-data-frame" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Creating a data frame</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#from-an-empty-dataframe" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From an empty DataFrame</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#create-dataframe-from-dictionary" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create DataFrame from dictionary</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#from-a-file" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From a file</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#accessing-data-in-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accessing data in  DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#selecting-columns" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Selecting columns</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#selecting-rows" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Selecting rows</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#challenges-when-accessing-columns-or-rows" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Challenges when accessing columns or rows</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#time-columns-not-parsed-properly" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time columns not parsed properly</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#filtering-and-visualizing-data" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filtering and visualizing data</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#boolean-masking" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean masking</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#plotting-a-dataframe" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plotting a DataFrame</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#performing-mathematical-operations-on-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Performing mathematical operations on DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#example-mathematical-operations-on-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: mathematical operations on DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#solution" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#grouping-filtering-and-aggregating-data" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Grouping, filtering and aggregating data</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#simple-statistics-in-pandas" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simple statistics in Pandas</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#joining-two-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Joining two DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#appending-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Appending DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#merging-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Merging DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#working-with-folders-and-files" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Working with folders and files</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#basic-use-of-pathlib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic use of Pathlib</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#basic-use-of-os" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic use of <code>os</code></a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#splitting-data-into-different-folders-and-files" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Splitting data into different folders and files</a></li>
     <!-- navigation toc: --> <li><a href="._book002.html#writing-more-robust-code" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writing more robust code</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#ch:taylor" style="font-size: 80%;"><b>Finite differences</b></a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#why-are-gradients-important" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Why are gradients important?</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#continuous-functions-and-finite-representation-numerical-errors" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Continuous functions and finite representation: numerical errors</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#taylor-polynomial-approximation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Taylor polynomial approximation</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#calculating-numerical-derivatives-of-functions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Calculating Numerical Derivatives of Functions</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#sec:taylor:hhd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Higher order derivative</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#roundoff-errors" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Roundoff Errors</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#binary-numbers" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Binary numbers</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#floating-point-numbers-and-the-ieee-754-1985-standard" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Floating point numbers and the IEEE 754-1985 standard</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#roundoff-error-and-truncation-error-in-numerical-derivatives" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Roundoff error and truncation error in numerical derivatives</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#ch:lin" style="font-size: 80%;"><b>Partial differential equations and linear systems</b></a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#the-continuity-equation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The continuity equation</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#continuity-equation-as-a-linear-problem" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Continuity equation as a linear problem</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#boundary-conditions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#solving-linear-equations" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Solving linear equations</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#gauss-jordan-elimination" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gauss-Jordan elimination</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#pivoting" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pivoting</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#lu-decomposition" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LU decomposition</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#iterative-methods" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Iterative methods</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#iterative-improvement" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iterative improvement</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#the-jacobi-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Jacobi method</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#the-gauss-seidel-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Gauss-Seidel method</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#example-linear-regression" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Example: Linear regression</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#solving-least-square-using-algebraic-equations" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solving least square, using algebraic equations</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#least-square-as-a-linear-algebra-problem" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Least square as a linear algebra problem</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#working-with-matrices-on-component-form" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Working with matrices on component form</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#sparse-matrices-and-thomas-algorithm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Sparse matrices and Thomas algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#example-solving-the-heat-equation-using-linear-algebra" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Example: Solving the heat equation using linear algebra</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#exercise-4-1-conservation-equation-or-the-continuity-equation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.1: Conservation Equation or the Continuity Equation</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#heat-equation-for-solids" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heat equation for solids</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#exercise-4-2-curing-of-concrete-and-matrix-formulation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.2: Curing of Concrete and Matrix Formulation</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#exercise-4-3-solve-the-full-heat-equation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.3: Solve the full heat equation</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#exercise-4-4-using-sparse-matrices-in-python" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.4: Using sparse matrices in python</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#co-2-diffusion-into-aquifers" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;CO$_2$ diffusion into aquifers</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#ch:nlin" style="font-size: 80%;"><b>Optimization and nonlinear systems</b></a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#nonlinear-equations" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Nonlinear equations</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#example-van-der-waals-equation-of-state" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Example: van der Waals equation of state</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-1-van-der-waal-eos-and-co-2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.1: van der Waal EOS and CO$_2$</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#fixed-point-iteration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Fixed-point iteration</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-2-implement-the-fixed-point-iteration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.2: Implement the fixed point iteration</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-3-finding-the-molar-volume-from-the-van-der-waal-eos-by-fixed-point-iteration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.3: Finding the molar volume from the van der Waal EOS by fixed point iteration</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#sec:nlin:fp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When does the fixed point method fail?</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#what-to-do-when-the-fixed-point-method-fails" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;What to do when the fixed point method fails</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-4-solve-x-e-1-x-2-using-fixed-point-iteration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.4: Solve \( x=e^{1-x^2} \) using fixed point iteration</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#rate-of-convergence" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Rate of convergence</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#the-bisection-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The bisection method</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#rate-of-convergence" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rate of convergence</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#newton-s-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#rate-of-convergence" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rate of convergence</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-5-compare-newtons-bisection-and-the-fixed-point-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.5: Compare Newtons, Bisection and the Fixed Point method</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#secant-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Secant method</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#rate-of-convergence" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rate of convergence</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#newton-rapson-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Newton Rapson method</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#gradient-descent" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Gradient descent</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-6-gradient-descent-solution-of-linear-regression" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.6: Gradient descent solution of linear regression</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#other-useful-methods" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Other useful methods</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#ch:numint" style="font-size: 80%;"><b>Numerical integration</b></a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#algorithmic-thinking" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Algorithmic thinking</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#the-midpoint-rule" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The midpoint rule</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#the-trapezoidal-rule" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The trapezoidal rule</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#numerical-errors-on-integrals" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical errors on integrals</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#practical-estimation-of-errors-on-integrals-richardson-extrapolation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Practical estimation of errors on integrals (Richardson extrapolation)</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#romberg-integration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Romberg integration</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#alternative-implementation-of-adaptive-integration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative implementation of adaptive integration</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#gaussian-quadrature" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Gaussian quadrature</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#the-case-n-3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The case N=3</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#error-term-on-gaussian-integration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error term on Gaussian integration</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#common-weight-functions-for-classical-gaussian-quadratures" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Common weight functions for classical Gaussian quadratures</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#integrating-functions-over-an-infinite-range" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Integrating functions over an infinite range</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#exercise-6-1-numerical-integration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 6.1: Numerical Integration</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#ch:ode" style="font-size: 80%;"><b>Ordinary differential equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#0d-models" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;0D models</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#ordinary-differential-equations" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Ordinary differential equations</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#a-simple-model-for-fluid-flow" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A simple model for fluid flow</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#euler-s-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Euler's method</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#error-analysis-euler-s-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error analysis - Euler's method</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#adaptive-step-size-euler-s-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adaptive step size - Euler's method</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#runge-kutta-methods" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Runge-Kutta methods</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#adaptive-step-size-runge-kutta-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adaptive step size - Runge-Kutta method</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#conservation-of-mass" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Conservation of mass</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#solving-a-set-of-ode-equations" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Solving a set of ODE equations</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#stiff-sets-of-ode-and-implicit-methods" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Stiff sets of ODE  and implicit methods</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#exercise-7-1-truncation-error-in-euler-s-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 7.1: Truncation error in Euler's method</a></li>
     <!-- navigation toc: --> <li><a href="#ch:mc" style="font-size: 80%;"><b>Monte Carlo Methods</b></a></li>
     <!-- navigation toc: --> <li><a href="#monte-carlo-methods" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Monte Carlo methods</a></li>
     <!-- navigation toc: --> <li><a href="#monte-carlo-integration-hit-and-miss" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Monte Carlo integration  ''hit and miss''</a></li>
     <!-- navigation toc: --> <li><a href="#random-number-generators" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Random number generators</a></li>
     <!-- navigation toc: --> <li><a href="#encryption" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encryption</a></li>
     <!-- navigation toc: --> <li><a href="#errors-on-monte-carlo-integration-and-the-binomial-distribution" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Errors on Monte Carlo integration and the binomial distribution</a></li>
     <!-- navigation toc: --> <li><a href="#the-mean-value-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The mean value method</a></li>
     <!-- navigation toc: --> <li><a href="#basic-properties-of-probability-distributions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic properties of probability distributions</a></li>
     <!-- navigation toc: --> <li><a href="#example-monte-carlo-integration-of-a-hyper-sphere" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Monte Carlo integration of a hyper sphere</a></li>
     <!-- navigation toc: --> <li><a href="#ex:mc:norm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 8.1: The central limit theorem</a></li>
     <!-- navigation toc: --> <li><a href="#remarks" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#ex:mc:BP" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 8.2: Birthday Paradox</a></li>
     <!-- navigation toc: --> <li><a href="._book009.html#references" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<a name="part0008"></a>
<!-- !split -->
<center>
<h1 id="ch:mc" class="anchor">Monte Carlo Methods</h1>
</center> <!-- chapter heading -->
<h1 id="monte-carlo-methods" class="anchor">Monte Carlo methods </h1>
<p>Monte Carlo methods are named after the Monte Carlo Casino in Monaco,
this is because at its core it uses random numbers to solve problems.
Monte Carlo methods are quite easy to program, and they are
usually much more intuitive than a theoretical approach. 
</p>
<!-- If we would -->
<!-- like to find the probability to get at least 5 on three dices after 5 throws -->
<!-- there are methods from statistics that could tell us the probability. -->
<!-- Using the Monte Carlo method, we would get the computer to pick a -->
<!-- random integer between 1 and 6, three times, to represent one throw of -->
<!-- the dices bla bla. -->
<!-- later in this chapter -->
<!-- Usually  Usually we use differential equations to describe physical systems, the solution to these equations are continuous functions. In order for these solutions -->
<!-- to be useful, they require that the differential equation describes our physical sufficiently. In many practical cases we have no control over many -->

<!-- of the parameters entering the differential equation, or stated differently <em>our system is not deterministic</em>. This means that there could be some random -->
<!-- fluctuations, occurring at different times and points in space, that we have no control over. In a practical situation we might would like to investigate how these fluctuations would -->
<!-- affect the behavior of our system. A -->

<!-- o <a href="https://www.scratchapixel.com/lessons/mathematics-physics-for-computer-graphics/monte-carlo-methods-in-practice/monte-carlo-rendering-practical-example" target="_self">ray  tracing</a> -->
<h1 id="monte-carlo-integration-hit-and-miss" class="anchor">Monte Carlo integration  ''hit and miss'' </h1>
<p>Let us start with a simple illustration of the Monte Carlo Method (MCM), Monte Carlo integration. To the left
in figure <a href="#fig:mc:mci">46</a> there is a shape of a pond. Imagine that we wanted to estimate the area of the pond, how could
we do it? Assume further that you did not have your phone or any other electronic devices to help you. 
</p>

<center> <!-- figure label: --> <div id="fig:mc:mci"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 46: Two ponds to illustrate the MCM.  <!-- caption label: fig:mc:mci --></p>
</center>
<p><img src="fig-mc/mci.png" width="400" align="bottom"></p>
</center>

<p>One possible approach is: First to walk around it, and put up some bands (illustrated by the black dotted line).
Then estimate the area inside the bands (e.g. 4$\times$3 meters). Then
we would know that the area was less than e.g. 12m$^2$. Finally,
and this is the difficult part, throw rocks <em>randomly</em> inside the
bands. The number of rocks hitting the pond divided by the total
number rocks thrown should be equal to the area of the pond divided by
the total area inside the bands, i.e. the area of the pond should be
equal to:
</p>
$$
\begin{equation}
A\simeq\text{Area of rectangle}\times\frac{\text{Number of rocks hitting the pond}}{\text{Number of rocks thrown}}.
\tag{9.1}
\end{equation}
$$

<p>It is important that we throw the rocks randomly, otherwise  equation <a href="#mjx-eqn-9.1">(9.1)</a> is not correct. Now, let us
investigate this in more detail, and use the idea of throwing rocks to estimate \( \pi \). To the right in figure <a href="#fig:mc:mci">46</a>,
there is a well known shape, a circle. The area of the circle is \( \pi d^2/4 \), and the shape is given by \( x^2+y^2=d^2/4 \). Assume that
the circle is inscribed in a square with sides of \( d \). To throw rocks randomly inside the square, is equivalent pick random numbers
with coordinates \( (x,y) \), where \( x\in[0,d] \) and \( y\in[0,d] \). We want all the \( x- \) and $y-$values to be chosen with equal probability,
which is equivalent to pick random numbers from a <em>uniform</em> distribution. Below is a Python implementation:
</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">estimate_pi</span>(N,d):
<span style="color: #3D7B7B; font-style: italic">#   random.seed(2)</span>
    D2<span style="color: #666666">=</span>d<span style="color: #666666">*</span>d<span style="color: #666666">/4</span>; dc<span style="color: #666666">=0.5*</span>d
    A<span style="color: #666666">=0</span>
    <span style="color: #008000; font-weight: bold">for</span> k <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>,N):
        x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(<span style="color: #666666">0</span>,d)
        y<span style="color: #666666">=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(<span style="color: #666666">0</span>,d)
        <span style="color: #008000; font-weight: bold">if</span>((x<span style="color: #666666">-</span>dc)<span style="color: #666666">**2+</span>(y<span style="color: #666666">-</span>dc)<span style="color: #666666">**2</span> <span style="color: #666666">&lt;=</span> D2):
            A<span style="color: #666666">+=1</span>
    <span style="color: #3D7B7B; font-style: italic"># estimate area of circle: d*d*A/N</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">4*</span>A<span style="color: #666666">/</span>N

N<span style="color: #666666">=1000</span>;d<span style="color: #666666">=2</span>
pi_est<span style="color: #666666">=</span>estimate_pi(N,d)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Estimate for pi= &#39;</span>, pi_est,<span style="color: #BA2121">&#39; Error=&#39;</span>, np<span style="color: #666666">.</span>pi<span style="color: #666666">-</span>pi_est)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>In the table below, we have run the code for \( d=1 \) and different values of \( N \). </p>

<div class="row">
  <div class="col-xs-5">
    <table class="dotable table-striped table-hover table-condensed">
<thead>
<tr><td align="center"><b>MC estimate</b></td> <td align="center"><b>   Error   </b></td> <td align="center">\( N \)</td> <td align="center">\( 1/\sqrt{N} \)</td> </tr>
</thead>
<tbody>
<tr><td align="center">   3.04           </td> <td align="center">   -0.10159       </td> <td align="center">   10$^2$     </td> <td align="center">   0.100               </td> </tr>
<tr><td align="center">   3.176          </td> <td align="center">   $\,$0.03441    </td> <td align="center">   10$^3$     </td> <td align="center">   0.032               </td> </tr>
<tr><td align="center">   3.1584         </td> <td align="center">   $\,$0.01681    </td> <td align="center">   10$^4$     </td> <td align="center">   0.010               </td> </tr>
<tr><td align="center">   3.14072        </td> <td align="center">   -0.00087       </td> <td align="center">   10$^5$     </td> <td align="center">   0.003               </td> </tr>
</tbody>
    </table>
  </div> <!-- col-xs-5 -->
</div> <!-- cell row -->

<p>We clearly see that a fair amount of rocks or numbers needs to be used in order to get a good estimate. If you run this code several
times you will see that the results changes from time to time. This
makes sense as the coordinates \( x \) and \( y \) are chosen at random.
</p>

<div class="alert alert-block alert-success alert-text-normal"><b>A note on performance</b>
<p>The code above is not efficient and for MC simulations we usually have to use many random numbers. Instead of</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #ffffff">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">for</span> k <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>,N):
        x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(<span style="color: #666666">0</span>,d)
        y<span style="color: #666666">=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(<span style="color: #666666">0</span>,d)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>one should avoid loops, and take advantage of build in functions in Numpy</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #ffffff">
  <pre style="line-height: 125%;">x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(<span style="color: #666666">0</span>,d,size<span style="color: #666666">=</span>N)
y<span style="color: #666666">=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(<span style="color: #666666">0</span>,d,size<span style="color: #666666">=</span>N)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<h2 id="random-number-generators" class="anchor">Random number generators </h2>
<p>There are much to be said about random number generators. The MCM depends on a good random number generator, otherwise we cannot use the results from
statistics to develop our algorithms. Below, we briefly summarize some important points that you should be aware of:
</p>

<ol>
<li> Random number generators are generally of two types: <em>hardware random number generator</em> (HRNG) or <em>pseudo random number generator</em> (PRNG).</li>
<li> HRNG uses a physical process to generate random numbers, this could atmospheric noise, radioactive decay, microscopic fluctuations, which is translated to an electrical signal. The electrical signal is converted to a digital number (1 or 0), by sampling the random signal random numbers can be generated. The HRNG are often named <em>true random number generators</em>, and their main use are in <em>cryptography</em>.</li>
<li> PRNG uses a mathematical algorithm to generate an (apparent) random sequence. The algorithm uses an initial number, or a <em>seed</em>,  to start the sequence of random number. The sequence is deterministic, and it will generate the same sequence of numbers if the same seed is used. At some point the algorithm will reproduce itself, i.e. it will have certain period. For some seeds the period may be much shorter.</li>
<li> Many of the PRNG are not considered to be cryptographically secure, because if a sufficiently long sequence of random numbers are generated from them, the rest of the sequence can be predicted.</li> 
<li> Python uses the <a href="https://en.wikipedia.org/wiki/Mersenne_Twister" target="_self">Mersenne Twister</a> algorithm to generate random numbers, and has a period of \( 2^{19937}&#8722;1\simeq4.3\cdot10^{6001} \). It is not considered to be cryptographically secure.</li>
</ol>
<p>In Pythons <code>random.uniform</code> function, a random seed is chosen each time the code is run, but
if we set e.g. <code>random.seed(2)</code>, the code will generate the same sequence of numbers each time it is called. 
</p>
<h2 id="encryption" class="anchor">Encryption  </h2>
<p>This section can be skipped as it is not relevant for development of
the numerical algorithms, but it is a good place to explain the basic
idea behind encryption of messages. A very simple, but not a very good
encryption, is to replace all the letters in the alphabet with a
number, e.g. A=1, B=2, C=3, etc. This is what is know as a
<em>substitution cipher</em>, it does not need to be a number it could be a
letter, a sequence of letters, letters and numbers etc. The receiver
can solve the code by doing the reverse operation.
</p>

<p>The
weakness of this approach is that it can fairly easily be cracked, by
the following approach: First we analyze the encrypted message and find the frequency of each of the symbols.
Assume that we know that the message is written in English, then the
frequency of symbols can be compared with the frequency of
letters from a known English text (the most common is <code>E</code> (12$\%$), then <code>T</code>
(9$\%$), etc.). We would then guess that the most occurring symbol
probably is an <code>E</code> or <code>T</code>. When some of the letters are in place, we
can compare with the frequency of words, and so on. By the help of
computers this process can easily be automated.
</p>

<p>A much better algorithm is <em>to not replace a letter with the same
symbol</em>. To make it more clear, consider our simple example where A=1, B=2,
C=3, \( \ldots \). If we know say that A=1 but we add a <em>random number</em>,
then our code would be much harder to crack. Then the letter A
could be several places in the message but represented as a complete different
number. Thus we could not use the frequency of the various symbols to
crack the message.
</p>

<p>How can the receiver decrypt the message? Obviously, it can be done if
both the sender and receiver have the same sequence of random numbers (or the <em>key</em>).
This can be achieved quite simple with random number generators, if we
know the seed  used we can generate the same sequence of
random numbers. If Alice where to send a message to Bob without Eve
knowing what it is, Alice and Bob could agree to send a message that
was scrambled using Pythons Mersenne-Twister algorithm with seed=2.
</p>

<p>The weakness of this approach is of course that Eve could convince
Alice or Bob to give her the seed or the key. Another possibility is
that Eve could write a program that tested
different random number generators and seeds to decipher the message.
How to avoid this?
</p>

<p>Let us assume that Alice and Bob each had their own
hardware random generator. This generator generated random numbers that was truly
random, and the sequence could not be guessed by any outsider. Alice
do not want to share her key (sequence of random numbers) with Bob,
and Bob would not share his key with Alice. How can they send a
message without sharing the key? One possible way of doing it is as
follows: Alice write a message and encrypt it with her key, she send
the message to Bob. Bob then encrypt the message with his key, he
sends it back to Alice. Alice then decrypt the message with her key
and send it back to Bob. Now, Bob can decrypt it with his own key and
read the message. The whole process can be visualized by thinking of
the message as box with the message. Alice but her padlock on the box
(keeps her key for her self), she sends the message to Bob. Bob locks
the box with his padlock, now there are two padlocks on the box. He
sends the box back to Alice, Alice unlocks her padlock with her key,
and sends it back to Bob. The box now only has Bob's key, he can
unlock the box and read the message. The important point is that the
box was never unlocked throughout the transaction, and Alice and Bob
never had to share the key with anyone. 
</p>
<h2 id="errors-on-monte-carlo-integration-and-the-binomial-distribution" class="anchor">Errors on Monte Carlo integration and the binomial distribution  </h2>
<p>How many rocks do we need to throw in order to reach a certain accuracy? To answer this question we need some results from statistics. Our problem of calculating the integral is closely related to the <em>binomial distribution</em>. When we throw a rock one of two things can happen i) the rock falls into the water, or ii) it falls outside the pond. If we denote the probability that the rock falls into the pond as \( p \), then the probability that it falls outside the pond, \( q \), has to be \( q=1-p \).
This is simply because there are no other possibilities and the sum of the two probabilities has to be one: \( p+q=p+(1-p)=1 \). The binomial distribution is given by:
</p>
$$
\begin{equation}
p(k)=\frac{n!}{k!(n-k)!}p^k(1-p)^{n-k}.
\tag{9.2}
\end{equation}
$$

<p>\( p(k) \) is the probability that an event happens \( k \) times after \( n \) trials. The mean, \( \mu \), and the variance, \( \sigma^2 \), of the binomial distribution is:</p>
$$
\begin{align}
\mu&=\sum_{k=0}^{n-1}kp(k)=np, \tag{9.3}\\ 
\sigma^2&=\sum_{k=0}^{n-1}(k-\mu)^2p(k)=np(1-p). \tag{9.4}
\end{align}
$$

<div class="alert alert-block alert-success alert-text-normal"><b>Mean and variance</b>
<p>The mean of a distribution is simply the <em>sum</em> divided by the <em>count</em>,
the symbol \( \mu \) or \( \overline{x} \) is usually used. For \( N \) observations, \( x_i \),
\( \mu=\sum_i x_i/N \). The mean is just an average, it could e.g. be the sum of all the heights of
students in the class divided by the number of students. The mean
would then be the average height of all the students in the class.
</p>

<p>The variance is calculated by taking the difference between each of
the data points and the mean, square it, and sum over all data points.
Usually the symbol \( \sigma^2 \) is used, \( \sigma^2=\sum_i(\mu-x_i)^2/N \).
The variance measures the spread in the data. Furthermore, it squares the
distance between the mean and the individual observations, meaning
that the points lying far a way from \( \mu \) contributes more to the
variance. 
</p>
</div>

<p>Before we proceed, we should take a moment and look a little more into
the meaning of equation <a href="#mjx-eqn-9.2">(9.2)</a> to appreciate its usefulness.  A classical example of the use of the binomial formula is to toss a coin, if the coin is fair it will have an equal probability of giving us a head or tail, hence \( p=1/2 \). Equation <a href="#mjx-eqn-9.2">(9.2)</a>, can answer questions like: ''What is the probability to get only heads after 4 tosses?''. Let us calculate this answer using equation <a href="#mjx-eqn-9.2">(9.2)</a>, the number of tosses is 4, the number of success is 4 (only heads each time)
</p>
$$
\begin{equation}
p(k=4)=\frac{4!}{4!(4-4)!}\frac{1}{2}^4(1-\frac{1}{2})^{4-4}=\frac{1}{2^4}=\frac{1}{16}.
\tag{9.5}
\end{equation}
$$

<p>''What is the probability to get three heads in four tosses?'', using
the same equation, we find:
</p>
$$
\begin{equation}
p(k=3)=\frac{4!}{3!(4-3)!}\frac{1}{2}^3(1-\frac{1}{2})^{4-3}=\frac{4}{2^4}=\frac{1}{4}.
\tag{9.6}
\end{equation}
$$

<p>In figure <a href="#fig:mc:coin">47</a>, all the possibilities are shown. The
number of possibilities are 16, and there are only one possibility
that we get only heads, i.e. the probability is 1/16 as calculated in
equation <a href="#mjx-eqn-9.5">(9.5)</a>. In the figure we also see that there are 4
possible ways we can get three heads, hence the probability is
4/16=1/4 as calculated in equation <a href="#mjx-eqn-9.6">(9.6)</a>.
</p>

<center> <!-- figure label: --> <div id="fig:mc:coin"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 47: The famous Norwegian Moose coin, and possible outcomes of four coin flips in a row.  <!-- caption label: fig:mc:coin --></p>
</center>
<p><img src="fig-mc/coin.png" width="400" align="bottom"></p>
</center>

<p>Now, let us return to our original question, ''What is the error on our
estimate of the integral, when using the MCM?''. Before we continue we
should also clean up our notation, let \( I \) be the value of the true
integral, \( A \) is our <em>estimate</em> of the integral, and \( I_N \) is the area
of the rectangle. First, let us show
that the mean or expectation value of the binomial distribution is
related to our estimate of the area of the pond or the circle, \( A \). In our case we draw \( n=N \)
random numbers, and \( k \) times the coordinate falls inside the circle,
equation <a href="#mjx-eqn-9.3">(9.3)</a> tells us that the mean value is \( np \). \( p \)
is the probability that the coordinate is within the area to be
integrated, hence as before \( p \) is equal to the area to be integrated
divided by the area of the total domain, thus:
</p>
$$
\begin{equation}
\mu=np=N\frac{A}{I_N},
\tag{9.7}
\end{equation}
$$

<p>or</p>
$$
\begin{equation}
A=I_N\frac{\mu}{N}.
\tag{9.8}
\end{equation}
$$

<p>Equation <a href="#mjx-eqn-9.4">(9.4)</a>, gives us an estimate of the variance of
the mean value. Assume for simplicity that we can replace \( 1-p\simeq
p \), this is of course only correct if the area of the rectangle is
twice as big as our pond, but we are only interested in an
estimate of the error, hence \( \sigma^2\simeq np^2 \). We can now use the
standard deviation as an estimate of the error of our integral:
</p>
$$
\begin{align}
I&\simeq I_N\frac{\mu\pm\sigma}{n}=I_N\frac{Np\pm \sqrt{N}p}{N}\nonumber\\ 
&\simeq I_N(p\pm \frac{p}{\sqrt{N}})=A\pm \frac{A}{\sqrt{N}}.
\tag{9.9}
\end{align}
$$

<p>In the last equation we have replaced \( p \) with \( A/I_N \). 
Hence, the error of our integral is inversely proportional to the
square root of the number of points. 
</p>
<h2 id="the-mean-value-method" class="anchor">The mean value method </h2>
<p>How does our previous method compare with some of our standard methods,
like the midpoint rule? The error for the MC method scales as
\( 1/\sqrt{N} \), in our previous error estimates we used the step length,
\( h \), as an indicator of the accuracy, and not \( N \). The s$N$ is
related to the number of points as \( h=(b-a)/n \), where \( b \) and \( a \) are
the integration limit. Thus our MCM scales as \( 1/\sqrt{n}\sim
h^{1/2} \), this is actually worse than the midpoint or trapezoidal
rule, which scaled as \( h \).
</p>

<p>The MCM can be improved. We will first describe the mean value method.
In the last section we calculated the area of
a circle by picking random numbers inside a square and estimated the
fraction of points inside the circle. This is equivalent to calculate
the area of a half circle, and multiply with 2:
</p>
$$
\begin{equation}
I=2\int_{-d/2}^{d/2}\sqrt{(d/2)^2-x^2}dx=\frac{\pi d^2}{4}.
\tag{9.10}
\end{equation}
$$

<p>The half-circle is now centered at the origin. Before we proceed we
write our integral in a general form as:
</p>
$$
\begin{equation}
I=\int_a^bf(x)dx.
\tag{9.11}
\end{equation}
$$

<p>Instead of counting the number of points inside the curve given by
\( f(x) \), we could instead use the mean of
the function, which we will define as \( \overline{f}=\sum_k f(x_k)/N \):
</p>
$$
\begin{equation}
I=\int_a^bf(x)dx\simeq\overline{f}\int_a^bdx=(b-a)\overline{f}
=\frac{(b-a)}{N}\sum_{k=0}^{N-1}f(x_k).
\tag{9.12}
\end{equation}
$$

<p>Note that this formula is similar to the midpoint rule, but now the
function is not evaluated at the midpoint, but at several points and
we use the average value. 
</p>

<center> <!-- figure label: --> <div id="fig:mc:int"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 48: Illustration of MC integration for \( N=4 \).  <!-- caption label: fig:mc:int --></p>
</center>
<p><img src="fig-mc/mcint.png" width="400" align="bottom"></p>
</center>

<p>Below is an implementation:</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x,D2):
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">2*</span>np<span style="color: #666666">.</span>sqrt((D2<span style="color: #666666">-</span>x<span style="color: #666666">*</span>x))

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">mcm_mean</span>(N,d):
    D2<span style="color: #666666">=</span>d<span style="color: #666666">*</span>d<span style="color: #666666">/4</span>
    x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(<span style="color: #666666">-</span>d<span style="color: #666666">/2</span>,d<span style="color: #666666">/2</span>,size<span style="color: #666666">=</span>N)
    A<span style="color: #666666">=</span>np<span style="color: #666666">.</span>sum(f(x,D2))
    <span style="color: #3D7B7B; font-style: italic"># estimate for area: A/N</span>
    <span style="color: #008000; font-weight: bold">return</span> d<span style="color: #666666">*</span>A<span style="color: #666666">/</span>N
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>In the table below we have compared the mean value method with the
''hit and miss'' method. We see
that the mean value method performs somewhat better, but there are
some random fluctuations and in some cases it performs poorer. 
</p>

<div class="row">
  <div class="col-xs-3">
    <table class="dotable table-striped table-hover table-condensed">
<thead>
<tr><td align="center"><b>MC-mean</b></td> <td align="center"><b> Error </b></td> <td align="center"><b>  MC  </b></td> <td align="center"><b>Error </b></td> <td align="center">\( N \)</td> </tr>
</thead>
<tbody>
<tr><td align="center">   3.1706     </td> <td align="center">   0.0290     </td> <td align="center">   3.1600    </td> <td align="center">   0.0184    </td> <td align="center">   10$^2$     </td> </tr>
<tr><td align="center">   3.1375     </td> <td align="center">   -0.0041    </td> <td align="center">   3.1580    </td> <td align="center">   0.0164    </td> <td align="center">   10$^3$     </td> </tr>
<tr><td align="center">   3.1499     </td> <td align="center">   0.0083     </td> <td align="center">   3.1422    </td> <td align="center">   0.0006    </td> <td align="center">   10$^4$     </td> </tr>
<tr><td align="center">   3.1424     </td> <td align="center">   0.0008     </td> <td align="center">   3.1457    </td> <td align="center">   0.0041    </td> <td align="center">   10$^5$     </td> </tr>
<tr><td align="center">   3.1414     </td> <td align="center">   -0.0002    </td> <td align="center">   3.1422    </td> <td align="center">   0.0006    </td> <td align="center">   10$^6$     </td> </tr>
</tbody>
    </table>
  </div> <!-- col-xs-3 -->
</div> <!-- cell row -->

<p>We also see that in this case the error scales as \( 1/\sqrt{N} \).</p>
<div class="alert alert-block alert-success alert-text-normal"><b>Notice</b>
<p>At first sight it might be a little counter intuitive that if we
multiply the average value of the function with the size of the
integration domain we get an estimate for the integral, as illustrated
in the top figure in figure <a href="#fig:mc:int">48</a>. A different, but
equivalent way, of viewing the mean value method is the lower figure
in figure <a href="#fig:mc:int">48</a>. For each random point we choose, we
multiply with the area \( (b-a)/N \), as \( N \) increases the area decreases
and the mean value method approaches the midpoint algorithm. The
reason the mean value method performs poorer is that we do not sample
the function at regular intervals. The <a href="https://en.wikipedia.org/wiki/Law_of_large_numbers" target="_self">law of large
numbers</a>, ensures
that our estimate approach the true value of the integral.
</p>
</div>

<h2 id="basic-properties-of-probability-distributions" class="anchor">Basic properties of probability distributions </h2>
<p>The MCM is closely tied to statistics, and it is important to have a
basic understanding of probability density functions (PDF). In
the previous section, we used a random number generator to give us
random numbers in an interval. All the numbers are picked with an
equal probability. Another way to state this is to say that: we <em>draw</em>
random numbers from an <em>uniform</em> distribution. Thus all the numbers
are drawn with an equal probability \( p \). What is the value of \( p \)?
That value is given from another property of PDF's, all PDF's must
be <em>normalized</em> to 1. This is equivalent to state that the sum of all
probabilities must be equal to one. Thus for a general PDF, \( p(x) \), we
must have:
</p>
$$
\begin{equation}
\int_{-\infty}^{\infty}p(x)dx=1.
\tag{9.13}
\end{equation}
$$

<p>A uniform distribution, \( p(x)=U(x) \), is given by:</p>
$$
\begin{equation}
U(x)=\begin{cases} \frac{1}{b-a}, \text{ for }x\in[a,b]\\ 
0, \text{ for } x < a \text{ or }x>b,
\end{cases}
\tag{9.14}
\end{equation}
$$

<p>you can easily verify that \( \int_{-\infty}^{\infty}U(x)=1 \). In the MCM
we typically evaluate <em>expectation values</em>. The expectation
value, \( E[f] \), for a function is defined:
</p>
$$
\begin{equation}
E[f]\equiv\int_{-\infty}^{\infty}f(x)p(x)dx\simeq\frac{1}{N}\sum_{k=0}^{N-1}f(x_k),
\tag{9.15}
\end{equation}
$$

<p>specializing to a uniform distribution, \( p(x)=U(x) \), we get:</p>
$$
\begin{equation}
E[f]=\int_{-\infty}^{\infty}f(x)U(x)dx=\frac{1}{b-a}\int_a^bf(x)dx.
\tag{9.16}
\end{equation}
$$

<p>Rearranging this equation, we see that we can write the above equation
as:
</p>
$$
\begin{equation}
\int_a^bf(x)dx=(b-a)E[f]\simeq(b-a)\frac{1}{N}\sum_{k=0}^{N-1}f(x_k).
\tag{9.17}
\end{equation}
$$

<p>This equation is the same as equation <a href="#mjx-eqn-9.12">(9.12)</a>, but in the
previous section we never explained why the expectation value of
\( f(x_k) \) was equal to the integral. The derivation above shows that
\( \int_a^bf(x)dx \) is equal to the expectation value of \( f(x) \) 
only under the condition that <em>we pick numbers from a uniform distribution</em>.
</p>

<p>To make this a bit more clearer, let us specialize to \( f(x)=x \). In
this case the expectation value is equal to the mean:
</p>
$$
\begin{equation}
E[x]=\mu=\int_{-\infty}^\infty xp(x)=\frac{1}{N}\sum_kx_k.
\tag{9.18}
\end{equation}
$$

<p>In this case we also find that the numerical error scales as \( N^{-1/2} \), from the definition of the variance</p>
$$
\begin{equation}
\sigma=\sqrt{\frac{1}{N}\sum_k(f(x_i)-\langle f\rangle)^2}\sim\frac{1}{\sqrt{N}},
\tag{9.19}
\end{equation}
$$

<div class="alert alert-block alert-success alert-text-normal"><b>Why would we or anyone use MC integration?</b>
<p>Monte Carlo integration performs much poorer than any of our previous
methods. So why should we use it, or when should we use it? The
strength of MC integration is only apparent when there is a large
number of dimensions, as we will see in the next section. 
</p>
</div>

<h2 id="example-monte-carlo-integration-of-a-hyper-sphere" class="anchor">Example: Monte Carlo integration of a hyper sphere </h2>
<p>The volume of a hyper sphere is known:</p>
$$
\begin{equation}
V(R)=\frac{\pi^{D/2}}{\Gamma(D/2+1)}R^D,
\tag{9.20}
\end{equation}
$$

<p>where \( D \) is the number of dimensions \( \Gamma(D/2+1) \) is the gamma
function, if \( n \) is an integer then \( \Gamma(n)=(n-1)! \) and
\( \Gamma(n+1/2)=(2n)!/(4^nn!)\sqrt{\pi} \). You can easily verify that
for \( D=2,3 \), \( V(R)=\pi R^2, 4/3\pi R^3 \), respectively.
</p>

<p>In the case of MC integration, we simply place the sphere inside a cube, and then count
the number of points that hits inside the hyper sphere:
</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">mc_nballII</span>(N<span style="color: #666666">=1000</span>,D<span style="color: #666666">=3</span>,R<span style="color: #666666">=1</span>):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Calculates the volume of a hypersphere using accept and reject</span>
<span style="color: #BA2121; font-style: italic">    N: Number of random points</span>
<span style="color: #BA2121; font-style: italic">    D: Number of dimensions</span>
<span style="color: #BA2121; font-style: italic">    R: Radius of hypersphere</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    r<span style="color: #666666">=0</span>
    <span style="color: #008000; font-weight: bold">for</span> d <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(D):
        xi<span style="color: #666666">=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(<span style="color: #666666">-</span>R,R,size<span style="color: #666666">=</span>N)
        r<span style="color: #666666">+=</span>xi<span style="color: #666666">*</span>xi
    r<span style="color: #666666">=</span>np<span style="color: #666666">.</span>sqrt(r)
    vol <span style="color: #666666">=</span> np<span style="color: #666666">.</span>sum(r<span style="color: #666666">&lt;=</span>R)
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Number of points inside n-ball: &quot;</span>, vol)
    <span style="color: #008000; font-weight: bold">return</span> vol<span style="color: #666666">/</span>N<span style="color: #666666">*</span>(<span style="color: #666666">2*</span>R)<span style="color: #666666">**</span>D
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Notice how easy it is to do MC integration in any number of dimensions. If you run the code above for \( D=3,\ldots,9 \) you will see that the error is the same regardless of dimensions i.e. it only scales proportional to \( N^{-1/2} \) and <em>not the number of dimensions</em>.  </p>

<p>How can we extend the traditional methods to more dimensions? One way of doing it is
to call a one dimensional integration routine several times. 
The volume of a hypersphere can be written
</p>
$$
\begin{equation}
V(R)=\int_{-R}^{R}\int_{-\sqrt{R^2-x_0^2}}^{\sqrt{R^2-x_0^2}}
\int_{-\sqrt{R^2-x_0^2-x_1^2}}^{\sqrt{R^2-x_0^2-x_1^2}}\cdots
\int_{-\sqrt{R^2-x_0^2-x_1^2-\cdots -x_{n-2}^2}}^{\sqrt{R^2-x_0^2-x_1^2-\cdots -x_{n-2}^2}}dx_0dx_1dx_2\cdots dx_{n-1}.
\tag{9.21}
\end{equation}
$$

<p>To simplify the notation lets look a little bit closer at \( D=3 \) (\( n=2 \)). We can always do the last integration
regardless of the number of dimensions
</p>
$$
\begin{equation}
V(R)=2\int_{-R}^{R}\int_{-\sqrt{R^2-x_0^2}}^{\sqrt{R^2-x_0^2}}
\sqrt{R^2-x_0^2-x_1^2}dx_0dx_1.
\tag{9.22}
\end{equation}
$$

<p>This equation can be rewritten as</p>
$$
\begin{align}
V(R)&=2\int_{-R}^{R}F(x_0)dx_0,\nonumber\\ 
F(x_0)&\equiv\int_{-\sqrt{R^2-x_0^2}}^{\sqrt{R^2-x_0^2}}\sqrt{R^2-x_0^2-x_1^2}dx_1,
\tag{9.23}
\end{align}
$$

<p>when integrating \( F(x_0) \), we do it by dividing the x-axis from \( -R \)
to \( R \) into \( N \) equal slices as before. We also need to evaluate
\( F(x_0) \) for each value of \( x_0 \), which is slightly more tricky, see
figure <a href="#fig:mc:2Dint">49</a> for an illustration. 
</p>

<center> <!-- figure label: --> <div id="fig:mc:2Dint"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 49: Illustration of a 2D integration to evaluate the volume of a sphere. <!-- caption label: fig:mc:2Dint --></p>
</center>
<p><img src="fig-mc/2Dint.png" width="400" align="bottom"></p>
</center>

<p>The multi dimensional
integral is done by placing a box around the sphere, and divide this
box into \( N\times N \) equal boxes. If start the integration
at \( x=-R \), \( F(-R)=0 \), because the integrand is zero. If we move one
step to the left, we need to integrate from \( y=-R \) to \( y=R \). We see
from the figure to the right in figure <a href="#fig:mc:2Dint">49</a> that the
function is not defined for two first points. Thus we need to make
sure that if we are outside the integration bounds the function is
zero. Below is an implementation that uses recursive function calls
</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">dd_trapez</span>(lower_limit,upper_limit,func,x,i,N,D):
    h <span style="color: #666666">=</span> (upper_limit<span style="color: #666666">-</span>lower_limit)<span style="color: #666666">/</span>N
    <span style="color: #008000; font-weight: bold">if</span>(i <span style="color: #666666">==</span> D<span style="color: #666666">-1</span>):
        funci<span style="color: #666666">=</span>d1_trapez
    <span style="color: #008000; font-weight: bold">else</span>:
        funci<span style="color: #666666">=</span>dd_trapez
    x[i]  <span style="color: #666666">=</span> lower_limit
    area  <span style="color: #666666">=</span> funci(lower_limit, upper_limit,func,x,i<span style="color: #666666">+1</span>,N,D)
    x[i]  <span style="color: #666666">=</span> upper_limit
    area <span style="color: #666666">+=</span> funci(lower_limit, upper_limit,func,x,i<span style="color: #666666">+1</span>,N,D)
    area <span style="color: #666666">*=</span> <span style="color: #666666">0.5</span>
    x[i]  <span style="color: #666666">=</span> lower_limit
    <span style="color: #008000; font-weight: bold">for</span> k <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>,N): <span style="color: #3D7B7B; font-style: italic"># loop over k=1,..,N-1</span>
        x[i] <span style="color: #666666">+=</span> h <span style="color: #3D7B7B; font-style: italic"># midpoint value</span>
        area <span style="color: #666666">+=</span> funci(lower_limit, upper_limit,func,x,i<span style="color: #666666">+1</span>,N,D)
    <span style="color: #008000; font-weight: bold">return</span> area<span style="color: #666666">*</span>h
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<div class="alert alert-block alert-danger alert-text-normal"><b>Recursive functions</b>
<p>Recursive implementation is very elegant, and more transparent, but it comes with a price. The reason is that when a function is called additional memory is allocated to store the local variables. If we where to calculate \( 100! \), 100 copies of the variable \( n \) are created, whereas using a loop only one variable is created. Each time a function is called more memory is allocated, and if the recursive calls are too many it might cause memory overflow. If you try to call <code>fact_rec(1000)</code>, Python will give an error, because the maximum number of recursions are reached, it can be changed by:</p>

<!-- code=text (!bc dat) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #ffffff">
  <pre style="line-height: 125%;">import sys
sys.setrecursionlimit(1500)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
</div>


<div class="alert alert-block alert-success alert-text-normal"><b>Error Analysis in higher dimensions</b>
<p>In the chapter about numerical integration, we did an error analysis
on the trapezoidal rule and found that it scaled as \( h^2 \). As we see
from the example above, a higher order integration is simply to do a
series of 1D integrations in all the dimensions, thus the error term
should be \( h_{x_0}^2+h_{x_1}^2+\cdots+h_{x_{d-1}}^2 \). If we use the
same spatial resolution in all dimensions, then the overall error
scale as \( h^2 \). If we let \( n \) denote the number of points in each
directions, \( h\sim 1/n \), the total number of points used is \( N=n\times
n\cdots n=n^d \). Thus, the error term scales as \( h^2\sim N^{-2/d} \), and
we see that if \( d\geq 4 \), the MC integration is expected to perform
better. 
</p>
</div>


<!-- --- begin exercise --- -->
<h2 id="ex:mc:norm" class="anchor">Exercise 8.1: The central limit theorem</h2>

<p>The central limit theorem is a corner stone in statistics, and it is
the reason for why the normal distribution is so widely used. The
central limit theorem states that if we calculate the average of an
independent random variable, the <em>average will be distributed
according to a normal distribution</em>. Not that the central limit
theorem does not state anything about the distribution of the original
variable. We will not prove the central limit theorem, but illustrate
it with two examples. 
</p>

<!-- !bsol -->
<!-- !esol -->

<!-- --- begin subexercise --- -->

<p>
<b>a)</b>
First we will investigate a random variable that follows a <em>uniform
distribution</em>. Write a Python function that returns the average of
\( N \) uniformly distributed numbers in \( [0,1] \).
</p>

<!-- --- begin solution of exercise --- -->

<p>
<p><a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_1" style="font-size: 80%;"></a>
</p>
<a href="#exer_13_1" data-toggle="collapse">
<p>
<b>Solution.</b>
</p>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_1">


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">average</span>(N):
    x<span style="color: #666666">=</span>[np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform() <span style="color: #008000; font-weight: bold">for</span> _ <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N)]
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>mean(x)

<span style="color: #3D7B7B; font-style: italic"># or alternatively, and equally fast</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">average2</span>(N):
    x<span style="color: #666666">=0</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N):
        x<span style="color: #666666">+=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform()
    <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">/</span>N

<span style="color: #3D7B7B; font-style: italic"># or much faster:</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">average3</span>(N):
    x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(size<span style="color: #666666">=</span>N)
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>mean(x)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

</div></p>
</div>
</p>

<!-- --- end solution of exercise --- -->

<!-- --- end subexercise --- -->

<!-- --- begin subexercise --- -->

<p>
<b>b)</b>
Calculate the average \( M \) times and make a histogram of the values.
</p>

<!-- --- begin solution of exercise --- -->

<p>
<p><a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_2" style="font-size: 80%;"></a>
</p>
<a href="#exer_13_2" data-toggle="collapse">
<p>
<b>Solution.</b>
</p>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_2">


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">hist</span>(M,N<span style="color: #666666">=100</span>):
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

</div></p>
</div>
</p>

<!-- --- end solution of exercise --- -->

<!-- --- end subexercise --- -->

<!-- --- begin subexercise --- -->

<p>
<b>c)</b>
Repeat the above exercise for a Poisson distribution.
</p>

<!-- --- begin solution of exercise --- -->

<p>
<p><a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_3" style="font-size: 80%;"></a>
</p>
<a href="#exer_13_3" data-toggle="collapse">
<p>
<b>Solution.</b>
</p>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_3">


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">average3</span>(N):
    x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(size<span style="color: #666666">=</span>N)
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>mean(x)
    
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">hist</span>(M,N<span style="color: #666666">=100</span>):
    y<span style="color: #666666">=</span>[average3(N) <span style="color: #008000; font-weight: bold">for</span> _ <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(M)]
    plt<span style="color: #666666">.</span>hist(x<span style="color: #666666">=</span>y, bins<span style="color: #666666">=</span><span style="color: #BA2121">&#39;auto&#39;</span>, color<span style="color: #666666">=</span><span style="color: #BA2121">&#39;#0504aa&#39;</span>,alpha<span style="color: #666666">=0.7</span>, rwidth<span style="color: #666666">=0.85</span>)
    plt<span style="color: #666666">.</span>show()

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">average4</span>(N):
    x<span style="color: #666666">=</span>[np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>poisson() <span style="color: #008000; font-weight: bold">for</span> _ <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N)]
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>mean(x)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

</div></p>
</div>
</p>

<!-- --- end solution of exercise --- -->

<!-- --- end subexercise --- -->

<!-- Closing remarks for this Exercise -->
<h3 id="remarks" class="anchor">Remarks </h3>

<p>It is quite remarkable that the distribution of the average values
from both a uniform and Poisson distribution follows a normal
distribution. The general
<a href="https://en.wikipedia.org/wiki/Central_limit_theorem" target="_self">proof</a>
is not that complicated, but the ramifications are large. The central
limit theorem explains why it makes sense to use the standard
deviation as a measure of confidence for the mean value.
</p>

<!-- --- end exercise --- -->

<!-- --- begin exercise --- -->
<h2 id="ex:mc:BP" class="anchor">Exercise 8.2: Birthday Paradox</h2>

<p>The human mind is not good at logical thinking, and if we use our
intuition we often get into trouble. A well known example is the
''Birthday Paradox'', it is simply to answer the following question:
''How many randomly selected people do we need in order that there is
a 50\% chance that two of them have birthday on the same date?'' 
</p>

<!-- !bsol -->
<!-- !esol -->

<!-- --- begin subexercise --- -->

<p>
<b>a)</b>
Write a Python function that pick a random date
</p>
<!-- subexercise... -->

<!-- --- begin solution of exercise --- -->

<p>
<p><a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_14_1" style="font-size: 80%;"></a>
</p>
<a href="#exer_14_1" data-toggle="collapse">
<p>
<b>Solution.</b>
</p>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_14_1">

<p>Below are two examples, the first one picks a date, while the second
one just picks a random day at year.  
</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic">#from datetime import date</span>
<span style="color: #3D7B7B; font-style: italic">#%%</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>

<span style="color: #3D7B7B; font-style: italic">#def get_date():</span>
<span style="color: #3D7B7B; font-style: italic">#    &quot;&quot;&quot; return a random date in the current year &quot;&quot;&quot;</span>
<span style="color: #3D7B7B; font-style: italic">#    start_dt = date.today().replace(day=1, month=1).toordinal()</span>
<span style="color: #3D7B7B; font-style: italic">#    end_dt = date.today().replace(day=31, month=12).toordinal()</span>
<span style="color: #3D7B7B; font-style: italic">#    random_day = date.fromordinal(np.random.randint(start_dt, end_dt))</span>
<span style="color: #3D7B7B; font-style: italic">#    return random_day</span>


<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_day</span>():
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return a random day in a year &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>randint(<span style="color: #666666">1</span>,<span style="color: #666666">365</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

</div></p>
</div>
</p>

<!-- --- end solution of exercise --- -->

<!-- --- end subexercise --- -->

<!-- --- begin subexercise --- -->

<p>
<b>b)</b>
Write a function that takes as argument, number of persons in a group,
and returns 1 if two of them has birthday on the same date and 0
otherwise.
</p>

<!-- --- begin solution of exercise --- -->

<p>
<p><a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_14_2" style="font-size: 80%;"></a>
</p>
<a href="#exer_14_2" data-toggle="collapse">
<p>
<b>Solution.</b>
</p>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_14_2">

<p>. </p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">NoPeople</span>(p):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; pick random dates in a year, return 1 if two</span>
<span style="color: #BA2121; font-style: italic">        is in the same date before p is reached &quot;&quot;&quot;</span>
    dates<span style="color: #666666">=</span>[]
    <span style="color: #008000; font-weight: bold">for</span> n <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(p):
        date<span style="color: #666666">=</span>get_day()
        <span style="color: #008000; font-weight: bold">if</span> date <span style="color: #AA22FF; font-weight: bold">in</span> dates:
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">1</span>
        <span style="color: #008000; font-weight: bold">else</span>:
            dates<span style="color: #666666">.</span>append(date)
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

</div></p>
</div>
</p>

<!-- --- end solution of exercise --- -->

<!-- --- end subexercise --- -->

<!-- --- begin subexercise --- -->

<p>
<b>c)</b>
Write a function that returns the probability that two people in a
group of \( p \) persons have birthday on the same day, and determine how
many people we need to have a probability of 50\%.
</p>

<!-- --- begin solution of exercise --- -->

<p>
<p><a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_14_3" style="font-size: 80%;"></a>
</p>
<a href="#exer_14_3" data-toggle="collapse">
<p>
<b>Solution.</b>
</p>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_14_3">

<p>In order to get some statistics, we need to sample \( N \) groups and
return the fraction of groups that had two persons with the same birthday.
</p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">BP</span>(p, N):
    prob<span style="color: #666666">=0.</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(N):
        prob <span style="color: #666666">+=</span> NoPeople(p)
    <span style="color: #008000; font-weight: bold">return</span> prob<span style="color: #666666">/</span>N
<span style="color: #008000">print</span>(BP(<span style="color: #666666">200</span>,<span style="color: #666666">1000</span>))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>By trial an error, we find that 23 persons is needed in order to have
a probability of
</p>
</div></p>
</div>
</p>

<!-- --- end solution of exercise --- -->

<!-- --- end subexercise --- -->

<!-- --- end exercise --- -->

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._book007.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._book009.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
</body>
</html>

