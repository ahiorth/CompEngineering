<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html book.do.txt CHAPTER=chapter BOOK=book APPENDIX=appendix --exercise_numbering=chapter --html_style=bootswatch_journal --html_code_style=inherit --html_output=book
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Modeling and Computational Engineering">
<meta name="keywords" content="types,basic types,lists,list comprehension,numerical error,Taylor polynomial,truncation error,Taylor polynomial, error term,Maclaurin series,forward difference,backward difference,central difference,central difference,roundoff erros,machine precision,IEEE 754-1985 standard,roundoff errors,continuity equation,finite volume,Gauss-Jordan elimination,pivoting,LU decomposition,Jacobi method,Gauss-Seidel method,linear regression,sparse matrix,Thomas algorithm,fixed-point iteration,rate of convergence,bisection method,rate of convergence,Newtons method,Newtons method, rate of convergence,secant method,secant method, rate of convergence,Newton Rapson method,gradient descent,midpoint method,trapezoidal method,numerical integrals, error,Richardson extrapolation,Romberg integration,Gaussian quadrature,Gaussian quadrature, error term,numerical integral, infinite,continuous stirred tank reactor (CSTR),Eulers method,Eulers method, error analysis,Eulers method, adaptive step size,Runge-Kutta,Runge-Kutta, adaptive step size,adaptive step size,stiff equations,implicit method,Monte Carlo integration,random number generators,Mersenne Twister,encryption,Monte Carlo Integration, error,binomial distribution,mean,variance,Monte Carlo integration, mean value,recursive functions,central limit theorem,birthday paradox">
<title>Modeling and Computational Engineering</title>
<!-- Bootstrap style: bootswatch_journal -->
<!-- doconce format html book.do.txt CHAPTER=chapter BOOK=book APPENDIX=appendix --exercise_numbering=chapter --html_style=bootswatch_journal --html_code_style=inherit --html_output=book -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/journal/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:60px;      /* fixed header height for style bootswatch_journal */
  margin:-60px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [('Table of contents',
               0,
               'table_of_contents',
               'table_of_contents'),
              ('Preface', 0, 'ch:preface', 'ch:preface'),
              ('Introduction to Python', 0, 'ch:pyt', 'ch:pyt'),
              ('Personal guidelines', 1, None, 'personal-guidelines'),
              ('Code editor', 2, None, 'code-editor'),
              ('Types in Python', 1, None, 'types-in-python'),
              ('Basic types', 2, None, 'basic-types'),
              ('Lists', 2, None, 'lists'),
              ('List arithmetic', 3, None, 'list-arithmetic'),
              ('List slicing', 3, None, 'list-slicing'),
              ('Numpy arrays', 2, None, 'numpy-arrays'),
              ('Array slicing', 3, None, 'array-slicing'),
              ('Dictionaries', 2, None, 'dictionaries'),
              ('Looping', 1, None, 'looping'),
              ('For loops', 2, None, 'for-loops'),
              ('While loops', 2, None, 'while-loops'),
              ('Functions in Python', 2, None, 'functions-in-python'),
              ('Defining a mathematical function',
               2,
               None,
               'defining-a-mathematical-function'),
              ('Scope of variables', 2, None, 'scope-of-variables'),
              ('Passing arrays and lists to functions',
               2,
               None,
               'passing-arrays-and-lists-to-functions'),
              ('Call by value or call by reference',
               2,
               None,
               'call-by-value-or-call-by-reference'),
              ('Floats and integers', 3, None, 'floats-and-integers'),
              ('Lists and arrays', 3, None, 'lists-and-arrays'),
              ('Mutable and immutable objects',
               2,
               None,
               'mutable-and-immutable-objects'),
              ('Introduction to Pandas', 0, 'ch:pan', 'ch:pan'),
              ('What is Pandas?', 1, None, 'what-is-pandas'),
              ('Creating a data frame', 1, None, 'creating-a-data-frame'),
              ('From an empty DataFrame', 2, None, 'from-an-empty-dataframe'),
              ('Create DataFrame from dictionary',
               2,
               None,
               'create-dataframe-from-dictionary'),
              ('From a file', 2, None, 'from-a-file'),
              ('Accessing data in  DataFrames',
               2,
               None,
               'accessing-data-in-dataframes'),
              ('Selecting columns', 3, None, 'selecting-columns'),
              ('Selecting rows', 3, None, 'selecting-rows'),
              ('Challenges when accessing columns or rows',
               3,
               None,
               'challenges-when-accessing-columns-or-rows'),
              ('Time columns not parsed properly',
               3,
               None,
               'time-columns-not-parsed-properly'),
              ('Filtering and visualizing data',
               2,
               None,
               'filtering-and-visualizing-data'),
              ('Boolean masking', 3, None, 'boolean-masking'),
              ('Plotting a DataFrame', 3, None, 'plotting-a-dataframe'),
              ('Performing mathematical operations on DataFrames',
               2,
               None,
               'performing-mathematical-operations-on-dataframes'),
              ('Example: mathematical operations on DataFrames',
               3,
               None,
               'example-mathematical-operations-on-dataframes'),
              ('Solution', 3, None, 'solution'),
              ('Grouping, filtering and aggregating data',
               2,
               None,
               'grouping-filtering-and-aggregating-data'),
              ('Simple statistics in Pandas',
               2,
               None,
               'simple-statistics-in-pandas'),
              ('Joining two DataFrames', 2, None, 'joining-two-dataframes'),
              ('Appending DataFrames', 3, None, 'appending-dataframes'),
              ('Merging DataFrames', 3, None, 'merging-dataframes'),
              ('Working with folders and files',
               2,
               None,
               'working-with-folders-and-files'),
              ('Basic use of Pathlib', 3, None, 'basic-use-of-pathlib'),
              ('Basic use of `os`', 3, None, 'basic-use-of-os'),
              ('Splitting data into different folders and files',
               3,
               None,
               'splitting-data-into-different-folders-and-files'),
              ('Writing more robust code', 2, None, 'writing-more-robust-code'),
              ('Finite differences', 0, 'ch:taylor', 'ch:taylor'),
              ('Why are gradients important?',
               1,
               None,
               'why-are-gradients-important'),
              ('Continuous functions and finite representation: numerical '
               'errors',
               1,
               None,
               'continuous-functions-and-finite-representation-numerical-errors'),
              ('Taylor polynomial approximation',
               1,
               None,
               'taylor-polynomial-approximation'),
              ('Calculating Numerical Derivatives of Functions',
               1,
               None,
               'calculating-numerical-derivatives-of-functions'),
              ('Higher order derivative',
               3,
               'sec:taylor:hhd',
               'sec:taylor:hhd'),
              ('Roundoff Errors', 2, None, 'roundoff-errors'),
              ('Binary numbers', 3, None, 'binary-numbers'),
              ('Floating point numbers and the IEEE 754-1985 standard',
               3,
               None,
               'floating-point-numbers-and-the-ieee-754-1985-standard'),
              ('Roundoff error and truncation error in numerical derivatives',
               3,
               None,
               'roundoff-error-and-truncation-error-in-numerical-derivatives'),
              ('Partial differential equations and linear systems',
               0,
               'ch:lin',
               'ch:lin'),
              ('The continuity equation', 1, None, 'the-continuity-equation'),
              ('Continuity equation as a linear problem',
               1,
               None,
               'continuity-equation-as-a-linear-problem'),
              ('Boundary conditions', 3, None, 'boundary-conditions'),
              ('Solving linear equations', 1, None, 'solving-linear-equations'),
              ('Gauss-Jordan elimination', 2, None, 'gauss-jordan-elimination'),
              ('Pivoting', 2, None, 'pivoting'),
              ('LU decomposition', 2, None, 'lu-decomposition'),
              ('Iterative methods', 1, None, 'iterative-methods'),
              ('Iterative improvement', 2, None, 'iterative-improvement'),
              ('The Jacobi method', 2, None, 'the-jacobi-method'),
              ('The Gauss-Seidel method', 2, None, 'the-gauss-seidel-method'),
              ('Example: Linear regression',
               1,
               None,
               'example-linear-regression'),
              ('Solving least square, using algebraic equations',
               2,
               None,
               'solving-least-square-using-algebraic-equations'),
              ('Least square as a linear algebra problem',
               2,
               None,
               'least-square-as-a-linear-algebra-problem'),
              ('Working with matrices on component form',
               2,
               None,
               'working-with-matrices-on-component-form'),
              ('Sparse matrices and Thomas algorithm',
               1,
               None,
               'sparse-matrices-and-thomas-algorithm'),
              ('Example: Solving the heat equation using linear algebra',
               1,
               None,
               'example-solving-the-heat-equation-using-linear-algebra'),
              ('Exercise 4.1: Conservation Equation or the Continuity Equation',
               2,
               None,
               'exercise-4-1-conservation-equation-or-the-continuity-equation'),
              ('Heat equation for solids', 3, None, 'heat-equation-for-solids'),
              ('Exercise 4.2: Curing of Concrete and Matrix Formulation',
               2,
               None,
               'exercise-4-2-curing-of-concrete-and-matrix-formulation'),
              ('Exercise 4.3: Solve the full heat equation',
               2,
               None,
               'exercise-4-3-solve-the-full-heat-equation'),
              ('Exercise 4.4: Using sparse matrices in python',
               2,
               None,
               'exercise-4-4-using-sparse-matrices-in-python'),
              ('CO$_2$ diffusion into aquifers',
               1,
               None,
               'co-_2-diffusion-into-aquifers'),
              ('Optimization and nonlinear systems', 0, 'ch:nlin', 'ch:nlin'),
              ('Nonlinear equations', 1, None, 'nonlinear-equations'),
              ('Example: van der Waals equation of state',
               1,
               None,
               'example-van-der-waals-equation-of-state'),
              ('Exercise 5.1: van der Waal EOS and CO$_2$',
               2,
               None,
               'exercise-5-1-van-der-waal-eos-and-co-_2'),
              ('Fixed-point iteration', 1, None, 'fixed-point-iteration'),
              ('Exercise 5.2: Implement the fixed point iteration',
               2,
               None,
               'exercise-5-2-implement-the-fixed-point-iteration'),
              ('Exercise 5.3: Finding the molar volume from the van der Waal '
               'EOS by fixed point iteration',
               2,
               None,
               'exercise-5-3-finding-the-molar-volume-from-the-van-der-waal-eos-by-fixed-point-iteration'),
              ('When does the fixed point method fail?',
               2,
               'sec:nlin:fp',
               'sec:nlin:fp'),
              ('What to do when the fixed point method fails',
               2,
               None,
               'what-to-do-when-the-fixed-point-method-fails'),
              ('Exercise 5.4: Solve $x=e^{1-x^2}$ using fixed point iteration',
               2,
               None,
               'exercise-5-4-solve-x-e-1-x-2-using-fixed-point-iteration'),
              ('Rate of convergence', 1, None, 'rate-of-convergence'),
              ('The bisection method', 1, None, 'the-bisection-method'),
              ('Rate of convergence', 2, None, 'rate-of-convergence'),
              ("Newton's method", 1, None, 'newton-s-method'),
              ('Rate of convergence', 2, None, 'rate-of-convergence'),
              ('Exercise 5.5: Compare Newtons, Bisection and the Fixed Point '
               'method',
               2,
               None,
               'exercise-5-5-compare-newtons-bisection-and-the-fixed-point-method'),
              ('Secant method', 1, None, 'secant-method'),
              ('Rate of convergence', 2, None, 'rate-of-convergence'),
              ('Newton Rapson method', 1, None, 'newton-rapson-method'),
              ('Gradient descent', 1, None, 'gradient-descent'),
              ('Exercise 5.6: Gradient descent solution of linear regression',
               2,
               None,
               'exercise-5-6-gradient-descent-solution-of-linear-regression'),
              ('Other useful methods', 1, None, 'other-useful-methods'),
              ('Numerical integration', 0, 'ch:numint', 'ch:numint'),
              ('Algorithmic thinking', 1, None, 'algorithmic-thinking'),
              ('The midpoint rule', 2, None, 'the-midpoint-rule'),
              ('The trapezoidal rule', 2, None, 'the-trapezoidal-rule'),
              ('Numerical errors on integrals',
               2,
               None,
               'numerical-errors-on-integrals'),
              ('Practical estimation of errors on integrals (Richardson '
               'extrapolation)',
               2,
               None,
               'practical-estimation-of-errors-on-integrals-richardson-extrapolation'),
              ('Romberg integration', 1, None, 'romberg-integration'),
              ('Alternative implementation of adaptive integration',
               2,
               None,
               'alternative-implementation-of-adaptive-integration'),
              ('Gaussian quadrature', 1, None, 'gaussian-quadrature'),
              ('The case N=3', 3, None, 'the-case-n-3'),
              ('Error term on Gaussian integration',
               2,
               None,
               'error-term-on-gaussian-integration'),
              ('Common weight functions for classical Gaussian quadratures',
               2,
               None,
               'common-weight-functions-for-classical-gaussian-quadratures'),
              ('Integrating functions over an infinite range',
               1,
               None,
               'integrating-functions-over-an-infinite-range'),
              ('Exercise 6.1: Numerical Integration',
               2,
               None,
               'exercise-6-1-numerical-integration'),
              ('Ordinary differential equations', 0, 'ch:ode', 'ch:ode'),
              ('0D models', 1, None, '0d-models'),
              ('Ordinary differential equations',
               1,
               None,
               'ordinary-differential-equations'),
              ('A simple model for fluid flow',
               1,
               None,
               'a-simple-model-for-fluid-flow'),
              ("Euler's method", 1, None, 'euler-s-method'),
              ("Error analysis - Euler's method",
               2,
               None,
               'error-analysis-euler-s-method'),
              ("Adaptive step size - Euler's method",
               2,
               None,
               'adaptive-step-size-euler-s-method'),
              ('Runge-Kutta methods', 1, None, 'runge-kutta-methods'),
              ('Adaptive step size - Runge-Kutta method',
               2,
               None,
               'adaptive-step-size-runge-kutta-method'),
              ('Conservation of mass', 2, None, 'conservation-of-mass'),
              ('Solving a set of ODE equations',
               1,
               None,
               'solving-a-set-of-ode-equations'),
              ('Stiff sets of ODE  and implicit methods',
               1,
               None,
               'stiff-sets-of-ode-and-implicit-methods'),
              ("Exercise 7.1: Truncation error in Euler's method",
               2,
               None,
               'exercise-7-1-truncation-error-in-euler-s-method'),
              ('Monte Carlo Methods', 0, 'ch:mc', 'ch:mc'),
              ('Monte Carlo methods', 1, None, 'monte-carlo-methods'),
              ("Monte Carlo integration  ''hit and miss''",
               1,
               None,
               'monte-carlo-integration-hit-and-miss'),
              ('Random number generators', 2, None, 'random-number-generators'),
              ('Encryption', 2, None, 'encryption'),
              ('Errors on Monte Carlo integration and the binomial '
               'distribution',
               2,
               None,
               'errors-on-monte-carlo-integration-and-the-binomial-distribution'),
              ('The mean value method', 2, None, 'the-mean-value-method'),
              ('Basic properties of probability distributions',
               2,
               None,
               'basic-properties-of-probability-distributions'),
              ('Example: Monte Carlo integration of a hyper sphere',
               2,
               None,
               'example-monte-carlo-integration-of-a-hyper-sphere'),
              ('Exercise 8.1: The central limit theorem',
               2,
               'ex:mc:norm',
               'ex:mc:norm'),
              ('Remarks', 3, None, 'remarks'),
              ('Exercise 8.2: Birthday Paradox', 2, 'ex:mc:BP', 'ex:mc:BP'),
              ('References', 1, None, 'references')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\no}{\nonumber}
\newcommand{\co}{CO$_2$}
$$



<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="book.html">Modeling and Computational Engineering</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._book001.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="._book001.html#ch:preface" style="font-size: 80%;"><b>Preface</b></a></li>
     <!-- navigation toc: --> <li><a href="#ch:pyt" style="font-size: 80%;"><b>Introduction to Python</b></a></li>
     <!-- navigation toc: --> <li><a href="#personal-guidelines" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Personal guidelines</a></li>
     <!-- navigation toc: --> <li><a href="#code-editor" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Code editor</a></li>
     <!-- navigation toc: --> <li><a href="#types-in-python" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Types in Python</a></li>
     <!-- navigation toc: --> <li><a href="#basic-types" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic types</a></li>
     <!-- navigation toc: --> <li><a href="#lists" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lists</a></li>
     <!-- navigation toc: --> <li><a href="#list-arithmetic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List arithmetic</a></li>
     <!-- navigation toc: --> <li><a href="#list-slicing" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List slicing</a></li>
     <!-- navigation toc: --> <li><a href="#numpy-arrays" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numpy arrays</a></li>
     <!-- navigation toc: --> <li><a href="#array-slicing" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Array slicing</a></li>
     <!-- navigation toc: --> <li><a href="#dictionaries" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dictionaries</a></li>
     <!-- navigation toc: --> <li><a href="#looping" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Looping</a></li>
     <!-- navigation toc: --> <li><a href="#for-loops" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For loops</a></li>
     <!-- navigation toc: --> <li><a href="#while-loops" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;While loops</a></li>
     <!-- navigation toc: --> <li><a href="#functions-in-python" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Functions in Python</a></li>
     <!-- navigation toc: --> <li><a href="#defining-a-mathematical-function" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defining a mathematical function</a></li>
     <!-- navigation toc: --> <li><a href="#scope-of-variables" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scope of variables</a></li>
     <!-- navigation toc: --> <li><a href="#passing-arrays-and-lists-to-functions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Passing arrays and lists to functions</a></li>
     <!-- navigation toc: --> <li><a href="#call-by-value-or-call-by-reference" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call by value or call by reference</a></li>
     <!-- navigation toc: --> <li><a href="#floats-and-integers" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Floats and integers</a></li>
     <!-- navigation toc: --> <li><a href="#lists-and-arrays" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lists and arrays</a></li>
     <!-- navigation toc: --> <li><a href="#mutable-and-immutable-objects" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mutable and immutable objects</a></li>
     <!-- navigation toc: --> <li><a href="#ch:pan" style="font-size: 80%;"><b>Introduction to Pandas</b></a></li>
     <!-- navigation toc: --> <li><a href="#what-is-pandas" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;What is Pandas?</a></li>
     <!-- navigation toc: --> <li><a href="#creating-a-data-frame" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Creating a data frame</a></li>
     <!-- navigation toc: --> <li><a href="#from-an-empty-dataframe" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From an empty DataFrame</a></li>
     <!-- navigation toc: --> <li><a href="#create-dataframe-from-dictionary" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create DataFrame from dictionary</a></li>
     <!-- navigation toc: --> <li><a href="#from-a-file" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From a file</a></li>
     <!-- navigation toc: --> <li><a href="#accessing-data-in-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Accessing data in  DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="#selecting-columns" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Selecting columns</a></li>
     <!-- navigation toc: --> <li><a href="#selecting-rows" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Selecting rows</a></li>
     <!-- navigation toc: --> <li><a href="#challenges-when-accessing-columns-or-rows" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Challenges when accessing columns or rows</a></li>
     <!-- navigation toc: --> <li><a href="#time-columns-not-parsed-properly" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time columns not parsed properly</a></li>
     <!-- navigation toc: --> <li><a href="#filtering-and-visualizing-data" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Filtering and visualizing data</a></li>
     <!-- navigation toc: --> <li><a href="#boolean-masking" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boolean masking</a></li>
     <!-- navigation toc: --> <li><a href="#plotting-a-dataframe" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plotting a DataFrame</a></li>
     <!-- navigation toc: --> <li><a href="#performing-mathematical-operations-on-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Performing mathematical operations on DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="#example-mathematical-operations-on-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: mathematical operations on DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="#solution" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution</a></li>
     <!-- navigation toc: --> <li><a href="#grouping-filtering-and-aggregating-data" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Grouping, filtering and aggregating data</a></li>
     <!-- navigation toc: --> <li><a href="#simple-statistics-in-pandas" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simple statistics in Pandas</a></li>
     <!-- navigation toc: --> <li><a href="#joining-two-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Joining two DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="#appending-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Appending DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="#merging-dataframes" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Merging DataFrames</a></li>
     <!-- navigation toc: --> <li><a href="#working-with-folders-and-files" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Working with folders and files</a></li>
     <!-- navigation toc: --> <li><a href="#basic-use-of-pathlib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic use of Pathlib</a></li>
     <!-- navigation toc: --> <li><a href="#basic-use-of-os" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic use of <code>os</code></a></li>
     <!-- navigation toc: --> <li><a href="#splitting-data-into-different-folders-and-files" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Splitting data into different folders and files</a></li>
     <!-- navigation toc: --> <li><a href="#writing-more-robust-code" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Writing more robust code</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#ch:taylor" style="font-size: 80%;"><b>Finite differences</b></a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#why-are-gradients-important" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Why are gradients important?</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#continuous-functions-and-finite-representation-numerical-errors" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Continuous functions and finite representation: numerical errors</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#taylor-polynomial-approximation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Taylor polynomial approximation</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#calculating-numerical-derivatives-of-functions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Calculating Numerical Derivatives of Functions</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#sec:taylor:hhd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Higher order derivative</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#roundoff-errors" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Roundoff Errors</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#binary-numbers" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Binary numbers</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#floating-point-numbers-and-the-ieee-754-1985-standard" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Floating point numbers and the IEEE 754-1985 standard</a></li>
     <!-- navigation toc: --> <li><a href="._book003.html#roundoff-error-and-truncation-error-in-numerical-derivatives" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Roundoff error and truncation error in numerical derivatives</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#ch:lin" style="font-size: 80%;"><b>Partial differential equations and linear systems</b></a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#the-continuity-equation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The continuity equation</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#continuity-equation-as-a-linear-problem" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Continuity equation as a linear problem</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#boundary-conditions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#solving-linear-equations" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Solving linear equations</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#gauss-jordan-elimination" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gauss-Jordan elimination</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#pivoting" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pivoting</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#lu-decomposition" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LU decomposition</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#iterative-methods" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Iterative methods</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#iterative-improvement" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iterative improvement</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#the-jacobi-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Jacobi method</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#the-gauss-seidel-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Gauss-Seidel method</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#example-linear-regression" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Example: Linear regression</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#solving-least-square-using-algebraic-equations" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solving least square, using algebraic equations</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#least-square-as-a-linear-algebra-problem" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Least square as a linear algebra problem</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#working-with-matrices-on-component-form" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Working with matrices on component form</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#sparse-matrices-and-thomas-algorithm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Sparse matrices and Thomas algorithm</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#example-solving-the-heat-equation-using-linear-algebra" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Example: Solving the heat equation using linear algebra</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#exercise-4-1-conservation-equation-or-the-continuity-equation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.1: Conservation Equation or the Continuity Equation</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#heat-equation-for-solids" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heat equation for solids</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#exercise-4-2-curing-of-concrete-and-matrix-formulation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.2: Curing of Concrete and Matrix Formulation</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#exercise-4-3-solve-the-full-heat-equation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.3: Solve the full heat equation</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#exercise-4-4-using-sparse-matrices-in-python" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.4: Using sparse matrices in python</a></li>
     <!-- navigation toc: --> <li><a href="._book004.html#co-_2-diffusion-into-aquifers" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;CO$_2$ diffusion into aquifers</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#ch:nlin" style="font-size: 80%;"><b>Optimization and nonlinear systems</b></a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#nonlinear-equations" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Nonlinear equations</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#example-van-der-waals-equation-of-state" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Example: van der Waals equation of state</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-1-van-der-waal-eos-and-co-_2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.1: van der Waal EOS and CO$_2$</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#fixed-point-iteration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Fixed-point iteration</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-2-implement-the-fixed-point-iteration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.2: Implement the fixed point iteration</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-3-finding-the-molar-volume-from-the-van-der-waal-eos-by-fixed-point-iteration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.3: Finding the molar volume from the van der Waal EOS by fixed point iteration</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#sec:nlin:fp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When does the fixed point method fail?</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#what-to-do-when-the-fixed-point-method-fails" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;What to do when the fixed point method fails</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-4-solve-x-e-1-x-2-using-fixed-point-iteration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.4: Solve \( x=e^{1-x^2} \) using fixed point iteration</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#rate-of-convergence" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Rate of convergence</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#the-bisection-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The bisection method</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#rate-of-convergence" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rate of convergence</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#newton-s-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Newton's method</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#rate-of-convergence" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rate of convergence</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-5-compare-newtons-bisection-and-the-fixed-point-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.5: Compare Newtons, Bisection and the Fixed Point method</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#secant-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Secant method</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#rate-of-convergence" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rate of convergence</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#newton-rapson-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Newton Rapson method</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#gradient-descent" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Gradient descent</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#exercise-5-6-gradient-descent-solution-of-linear-regression" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 5.6: Gradient descent solution of linear regression</a></li>
     <!-- navigation toc: --> <li><a href="._book005.html#other-useful-methods" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Other useful methods</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#ch:numint" style="font-size: 80%;"><b>Numerical integration</b></a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#algorithmic-thinking" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Algorithmic thinking</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#the-midpoint-rule" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The midpoint rule</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#the-trapezoidal-rule" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The trapezoidal rule</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#numerical-errors-on-integrals" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerical errors on integrals</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#practical-estimation-of-errors-on-integrals-richardson-extrapolation" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Practical estimation of errors on integrals (Richardson extrapolation)</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#romberg-integration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Romberg integration</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#alternative-implementation-of-adaptive-integration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative implementation of adaptive integration</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#gaussian-quadrature" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Gaussian quadrature</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#the-case-n-3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The case N=3</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#error-term-on-gaussian-integration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error term on Gaussian integration</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#common-weight-functions-for-classical-gaussian-quadratures" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Common weight functions for classical Gaussian quadratures</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#integrating-functions-over-an-infinite-range" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Integrating functions over an infinite range</a></li>
     <!-- navigation toc: --> <li><a href="._book006.html#exercise-6-1-numerical-integration" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 6.1: Numerical Integration</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#ch:ode" style="font-size: 80%;"><b>Ordinary differential equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#0d-models" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;0D models</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#ordinary-differential-equations" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Ordinary differential equations</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#a-simple-model-for-fluid-flow" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A simple model for fluid flow</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#euler-s-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Euler's method</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#error-analysis-euler-s-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error analysis - Euler's method</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#adaptive-step-size-euler-s-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adaptive step size - Euler's method</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#runge-kutta-methods" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Runge-Kutta methods</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#adaptive-step-size-runge-kutta-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adaptive step size - Runge-Kutta method</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#conservation-of-mass" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Conservation of mass</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#solving-a-set-of-ode-equations" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Solving a set of ODE equations</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#stiff-sets-of-ode-and-implicit-methods" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Stiff sets of ODE  and implicit methods</a></li>
     <!-- navigation toc: --> <li><a href="._book007.html#exercise-7-1-truncation-error-in-euler-s-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 7.1: Truncation error in Euler's method</a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#ch:mc" style="font-size: 80%;"><b>Monte Carlo Methods</b></a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#monte-carlo-methods" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Monte Carlo methods</a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#monte-carlo-integration-hit-and-miss" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Monte Carlo integration  ''hit and miss''</a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#random-number-generators" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Random number generators</a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#encryption" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encryption</a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#errors-on-monte-carlo-integration-and-the-binomial-distribution" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Errors on Monte Carlo integration and the binomial distribution</a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#the-mean-value-method" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The mean value method</a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#basic-properties-of-probability-distributions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic properties of probability distributions</a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#example-monte-carlo-integration-of-a-hyper-sphere" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Monte Carlo integration of a hyper sphere</a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#ex:mc:norm" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 8.1: The central limit theorem</a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#remarks" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._book008.html#ex:mc:BP" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 8.2: Birthday Paradox</a></li>
     <!-- navigation toc: --> <li><a href="._book009.html#references" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<a name="part0002"></a>
<!-- !split -->
<center>
<h1 id="ch:pyt" class="anchor">Introduction to Python</h1>
</center> <!-- chapter heading -->

<p>There are plenty of online resources if you want get an overview of Python syntax, such as <a href="._book009.html#vanderplas2016whirlwind">[1]</a>, for which the full book is available on <a href="https://github.com/jakevdp/WhirlwindTourOfPython" target="_self">github</a>.</p>

<p>In this chapter I will try to focus on the key part of Python that you will need in this book, and maybe more importantly, give some advice on how to write good, reusable, Python code. As you might have discovered tasks can be solved in many different ways in Python. This is clearly a strength because you would most likely be able to solve any task thrown at you. On the other hand it is a weakness, because code can get messy and hard to follow, especially if you solve the same task in different parts of your code using different libraries or syntax.</p>

<p>In this chapter, I will explain how I tend to solve some common tasks, in the process we will also cover some stuff that you should know. If you need more information on each topic below, there are plenty of online sources. </p>

<p>The code examples are meant as an inspiration, and maybe you do not agree and have solutions that you think are much better. If that is the case, I would love to know, so that I can update this chapter.</p>

<div class="alert alert-block alert-success alert-text-normal"><b>Speed and readability</b>
<p>Many people are concerned about speed or execution time. My advice is to focus on readable code, and get the job done. When the code is working, it is very easy to go back and change parts that are slow. Remember that you should test the code on big problems, sometimes the advantage of Numpy or Scipy is not seen before the system is large. You can use the magic commands <code>%timeit</code> to check performance of different functions. You can also use <a href="https://numba.pydata.org/" target="_self">Numba</a>, which translate python code into optimized machine code. </p>
</div>

<h1 id="personal-guidelines" class="anchor">Personal guidelines  </h1>
<p>It is important to have some guidelines when coding, and for Python there are clear style guides called <a href="https://www.python.org/dev/peps/pep-0008/" target="_self">PEP 8</a>. Take a look at the official guidelines, and  make some specific rules for yourself, and stick to them. The reason for this is that if you make a large program or library, people will recognize your style and it is easier to understand the code. If you are working in a team, it is even more important - try to agree on some basic rules, for example:</p>

<p>
<b>Code Guidelines:</b>
</p>
<ul>
<li> Variable names should be meaningful.</li>
<li> Naming of variables and functions. Should you write <code>def my_function(...):</code> or <code>def MyFunction(..)</code>, i.e are words separated by an underscore or a capital letter? Personally I use capital letters for class definition, and underscore for function definitions.</li>
<li> (Almost) always use doc strings, you would be amazed how easy it is to forget what a function does. Shorter (private) functions usually do not need comments or doc strings, if you use good variable names - it should be easy to understand what is happening by just looking at the code.</li>
<li> Inline comments should be used sparingly, only where strictly necessary.</li>
<li> Strive to make code general, in particular not type specific, e.g. in Python it is easy to make functions that will work if a list (array) or a single value is passed.</li>
<li> Use exception handling, in particular for larger projects.</li>
<li> DRY - Do not Repeat Yourself <a href="._book009.html#thomas2019pragmatic">[2]</a>. If you need to change the code in more than one place to extend it, you may forget to change everywhere and introduce bugs.</li>
<li> The DRY principle also applies to <em>knowledge sharing</em>, it is not only about copy and paste code, but knowledge should only be represented in one place.</li> 
<li> Import libraries using the syntax <code>import library as ..</code>, Numpy would typically be <code>import numpy as np</code>. The syntax <code>from numpy import *</code> could lead to conflicts between modules as functions could have the same name in two different modules.</li>
</ul>
<p>
<b>Work Guidelines:</b>
</p>
<ul>
<li> Do not copy and paste code without understanding it. It is OK to be inspired by others, but be aware that in some cases code examples are unnecessary complicated. Too much copy and paste will result in a code with a mix of different styles.</li> 
<li> Stick to a limited number of libraries. I try to do as much as possible with <a href="https://numpy.org/" target="_self">Numpy</a>, <a href="https://pandas.pydata.org/" target="_self">Pandas</a>, and  <a href="https://matplotlib.org/" target="_self">Matplotlib</a>.</li>
<li> Unexpected behavior of functions. Functions should be able to discover if something is wrong with arguments, and give warnings.</li>
</ul>
<h2 id="code-editor" class="anchor">Code editor </h2>
<p>You would like to use an editor that gives you some help. This is particularly useful when you do not remember a variable or function name, you can guess  the name and a drop down list will appear which will let you pick the name or function you want. If you enter  a function name, the editor will write some useful information about the function, some screenshots are shown in figure <a href="#fig:py:vscode">1</a>.</p>

<center> <!-- figure label: --> <div id="fig:py:vscode"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 1:  A screenshot of vscode (left) the editor helps to identify which variable name you want, (right) the editor shows relevant information about the function you would like to call.  <!-- caption label: fig:py:vscode --> </p>
</center>
<p><img src="fig-python/vscode.png" align="bottom" width=800></p>
</center>

<p>Currently my favorite editor is <a href="https://code.visualstudio.com/" target="_self">vscode</a>, it can be used for any language, and there are a lot of add ins that can be installed to make the coding experience more pleasant. Spyder is also a very good alternative, but this editor is mainly for Python. It takes some time to learn how an editor works, so it is good if the editor can be used for multiple purposes.  However, always be open to new ideas and products, it will only make you more efficient. As an example, in some cases you will have a particular difficult error in the code, and then it could help to open and run that code in a different editor, you might get a slightly different error messages, which could help you locate the error.</p>
<h1 id="types-in-python" class="anchor">Types in Python </h1>
<p>In Python you do not need to define types as in a compiled language. In many ways one can say that Python only has <em>one</em> type.  To not define types is generally an advantage as it lets you write code with fewer lines, and it is easier to write functions that will work with any kind of type. As an example, in the programming language C, if you want to write a function that lets you add two numbers, you have to write one version if the arguments are integers and one version if the arguments are floats.</p>

<p>The way that Python store and organize data is called a data model, and it is well described in the <a href="https://docs.python.org/3/reference/datamodel.html" target="_self">official documentation</a>. The important point is that all data in Python is an object or a relation between objects. The <code>is</code> operator can be used to check if two objects have the same identity, that means they are the same object. The <code>id</code> operator gives an unique integer value for the object, and if two objects have the same id number they are the same object, e.g.</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">y<span style="color: #666666">=10</span>
x<span style="color: #666666">=</span>y
x <span style="color: #AA22FF; font-weight: bold">is</span> y <span style="color: #3D7B7B; font-style: italic"># gives true</span>
<span style="color: #008000">print</span>(<span style="color: #008000">id</span>(x))
<span style="color: #008000">print</span>(<span style="color: #008000">id</span>(y)) <span style="color: #3D7B7B; font-style: italic"># prints the same integer as id(x)</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>For those familiar with C or C++, one would first have to define <code>x</code> and <code>y</code> as the type <code>int</code> and then they would already have a different place in memory and they can <em>never</em> be the same (even if they contain the same number). We will return to this point in more detail discussing lists and arrays in Python, as it can lead to unexpected behavior.</p>

<p>Another thing you might have experienced during Python coding is that you get error messages that refer to pieces of code that you have no knowledge of. This can happen when you pass the wrong type (e.g. a string instead of a number). Since Python only has one type, the wrong type will not be discovered before it is actually used. This error could be deep into some other library that you have no knowledge of. </p>
<h2 id="basic-types" class="anchor">Basic types </h2>
<p>I will assume that you are familiar with the common types like floats (for real numbers), strings (text, lines, word, a character), integer (whole numbers), Boolean (True, False). What is sometimes useful is to be able to test what kind of type a variable is, this can be done with <code>type()</code></p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_float <span style="color: #666666">=</span> <span style="color: #666666">2.0</span> 
my_int   <span style="color: #666666">=</span> <span style="color: #666666">3</span>
my_bool  <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
<span style="color: #008000">print</span>(<span style="color: #008000">type</span>(my_float))
<span style="color: #008000">print</span>(<span style="color: #008000">type</span>(my_int))
<span style="color: #008000">print</span>(<span style="color: #008000">type</span>(my_bool))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The output of the code above will be <code>float, int, bool</code>. If you want to test the type  of a variable you can do</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(my_int,<span style="color: #008000">int</span>):
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;My variable is integer&#39;</span>)
<span style="color: #008000; font-weight: bold">else</span>:
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;My variable is not integer&#39;</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Python also has build in support for complex numbers. An example are <code>1+2j</code>, <code>j</code> is the imaginary part of the complex number. Note there is no multiplication sign between 2 and <code>j</code>.</p>
<h2 id="lists" class="anchor">Lists </h2>

<p> Lists are extremely useful, and they have very nice syntax that in my opinion is more elegant than Numpy arrays. Whenever you want to do more than one thing with only a slight change between the elements, you should think of lists. Lists are defined using the square bracket <code>[]</code> symbol</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_list <span style="color: #666666">=</span> []      <span style="color: #3D7B7B; font-style: italic"># an empty list</span>
my_list <span style="color: #666666">=</span> []<span style="color: #666666">*10</span>   <span style="color: #3D7B7B; font-style: italic"># still an empty list ...</span>
my_list <span style="color: #666666">=</span> [<span style="color: #666666">0</span>]<span style="color: #666666">*10</span>  <span style="color: #3D7B7B; font-style: italic"># a list with 10 zeros</span>
my_list <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;one&#39;</span>, <span style="color: #BA2121">&#39;two&#39;</span>,<span style="color: #BA2121">&#39;three&#39;</span>] <span style="color: #3D7B7B; font-style: italic"># a list of strings</span>
my_list <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;one&#39;</span>]<span style="color: #666666">*10</span> <span style="color: #3D7B7B; font-style: italic"># a list with 10 equal string elements </span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<div class="alert alert-block alert-success alert-text-normal"><b>Notice</b>
<p>To get the first element in a list, we do e.g. <code>my_list[0]</code>. In a list with 10 elements the last element would be <code>my_list[9]</code>, the length of a list can be found by using the <code>len()</code> function, i.e. <code>len(my_list)=10</code>. Thus, the last element can also be found by doing <code>my_list[len(my_list)-1]</code>. However, in Python you can always get the last element by doing <code>my_list[-1]</code>, the second last element would be <code>my_list[-2]</code> and so on.</p>
</div>

<p>Sometimes you do not want to initialize the list with everything equal, and it can be tiresome to write everything out yourself. If that is the case you can use <em>list comprehension</em></p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_list <span style="color: #666666">=</span> [i <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">10</span>)] <span style="color: #3D7B7B; font-style: italic"># a list from 0,1,..,9</span>
my_list <span style="color: #666666">=</span> [i<span style="color: #666666">**3</span> <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">10</span>)] <span style="color: #3D7B7B; font-style: italic"># a list with elements 0,1,8, ..,729</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>We will cover the for loop below, but basically what is done is that the statement <code>i in range(10)</code>, gives <code>i</code> the value 0, 1, \( \ldots \), 9 and the first <code>i</code> inside the list tells python to use that value as the element in the list. Using this syntax, there are plenty of opportunities to initialize. Maybe you want to pick from a list words that contain a particular subset of characters</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_list  <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;hammer&#39;</span>, <span style="color: #BA2121">&#39;nail&#39;</span>,<span style="color: #BA2121">&#39;saw&#39;</span>,<span style="color: #BA2121">&#39;lipstick&#39;</span>,<span style="color: #BA2121">&#39;shirt&#39;</span>]
new_list <span style="color: #666666">=</span> [i <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> my_list <span style="color: #008000; font-weight: bold">if</span> <span style="color: #BA2121">&#39;a&#39;</span> <span style="color: #AA22FF; font-weight: bold">in</span> i]
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Now <code>new_list=['hammer', 'nail', 'saw']</code>.</p>
<h3 id="list-arithmetic" class="anchor">List arithmetic </h3>
<p>I showed you some examples above, where we used multiplication to create a list with equal copies of a single element, you can also join two lists by using addition</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_list  <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;hammer&#39;</span>,<span style="color: #BA2121">&#39;saw&#39;</span>]
my_list2 <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;screw&#39;</span>,<span style="color: #BA2121">&#39;nail&#39;</span>,<span style="color: #BA2121">&#39;glue&#39;</span>]
new_list <span style="color: #666666">=</span> my_list <span style="color: #666666">+</span> my_list2
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Now <code>new_list=['hammer', 'saw', 'screw', 'nail', 'glue']</code>, we can also multiply the list with an integer and get a larger list with several copies of the original list.</p>
<h3 id="list-slicing" class="anchor">List slicing </h3>
<p>Clearly we can access elements in a list by using the index to the element, i.e. first element is <code>my_list[0]</code>, and the last element is <code>my_list[-1]</code>. Python also has very nice syntax to pick out a subset of a list. The syntax is <code>my_list[start:stop:step]</code>, the step makes it possible to skip elements</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_list<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;hammer&#39;</span>, <span style="color: #BA2121">&#39;saw&#39;</span>, <span style="color: #BA2121">&#39;screw&#39;</span>, <span style="color: #BA2121">&#39;nail&#39;</span>, <span style="color: #BA2121">&#39;glue&#39;</span>]
my_list[:]      <span style="color: #3D7B7B; font-style: italic"># [&#39;hammer&#39;, &#39;saw&#39;, &#39;screw&#39;, &#39;nail&#39;, &#39;glue&#39;]</span>
my_list[<span style="color: #666666">1</span>:]     <span style="color: #3D7B7B; font-style: italic"># [&#39;saw&#39;, &#39;screw&#39;, &#39;nail&#39;, &#39;glue&#39;]</span>
my_list[:<span style="color: #666666">-1</span>]    <span style="color: #3D7B7B; font-style: italic"># [&#39;hammer&#39;, &#39;saw&#39;, &#39;screw&#39;, &#39;nail&#39;]</span>
my_list[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>]   <span style="color: #3D7B7B; font-style: italic"># [&#39;saw&#39;, &#39;screw&#39;, &#39;nail&#39;]</span>
my_list[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>:<span style="color: #666666">2</span>] <span style="color: #3D7B7B; font-style: italic"># [&#39;saw&#39;,&#39;nail&#39;]</span>
my_list[::<span style="color: #666666">1</span>]    <span style="color: #3D7B7B; font-style: italic"># [&#39;hammer&#39;, &#39;saw&#39;, &#39;screw&#39;, &#39;nail&#39;, &#39;glue&#39;]</span>
my_list[::<span style="color: #666666">2</span>]    <span style="color: #3D7B7B; font-style: italic"># [&#39;hammer&#39;, &#39;screw&#39;, &#39;glue&#39;]</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Sometimes you have lists of lists, if you want to get e.g. the first element of each list you cannot access those elements using list slicing, you have to use a for loop or list comprehension</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_list  <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;hammer&#39;</span>,<span style="color: #BA2121">&#39;saw&#39;</span>]
my_list2 <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;screw&#39;</span>,<span style="color: #BA2121">&#39;nail&#39;</span>,<span style="color: #BA2121">&#39;glue&#39;</span>]
new_list<span style="color: #666666">=</span>[my_list,my_list2]
<span style="color: #3D7B7B; font-style: italic"># extract the first element of each list</span>
new_list2 <span style="color: #666666">=</span> [ <span style="color: #008000">list</span>[<span style="color: #666666">0</span>] <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">list</span> <span style="color: #AA22FF; font-weight: bold">in</span> new_list]
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<code>new_list2=['hammer','screw']</code>

<div class="alert alert-block alert-success alert-text-normal"><b>When to use lists</b>
<p>Use lists if you have mixed types, and as storage containers. Be careful when you do numerical computation not to mix lists and Numpy arrays. Adding two lists e.g. <code>[1,2]+[1,1]</code>, will give you <code>[1,2,1,1]</code>, whereas adding two Numpy arrays will give you <code>[2,3]</code>.</p>
</div>

<h2 id="numpy-arrays" class="anchor">Numpy arrays  </h2>
<p>Numpy arrays are awesome, and they should be your preferred choice when doing numerical operations. We import Numpy as <code>import numpy as np</code>, some examples of initialization</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_array<span style="color: #666666">=</span>np<span style="color: #666666">.</span>array([<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,<span style="color: #666666">2</span>,<span style="color: #666666">3</span>]) <span style="color: #3D7B7B; font-style: italic"># initialized from list</span>
my_array<span style="color: #666666">=</span>np<span style="color: #666666">.</span>zeros(<span style="color: #666666">10</span>) <span style="color: #3D7B7B; font-style: italic"># array with 10 elements equal to zero</span>
my_array<span style="color: #666666">=</span>np<span style="color: #666666">.</span>ones(<span style="color: #666666">10</span>)  <span style="color: #3D7B7B; font-style: italic"># array with 10 elements equal to one</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>A typical use of Numpy arrays is when you want to create equally spaced numbers to evaluate a function, this can be done in (at least) two ways</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_array<span style="color: #666666">=</span>np<span style="color: #666666">.</span>arange(<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,<span style="color: #666666">0.2</span>) <span style="color: #3D7B7B; font-style: italic"># [0, 0.2, 0.4, 0.6, 0.8]</span>
my_array<span style="color: #666666">=</span>np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,<span style="color: #666666">5</span>) <span style="color: #3D7B7B; font-style: italic"># [0., 0.25, 0.5, 0.75, 1.]</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Note that in the second case, the edges of the domain (0,1) are included while in the first case the upper edge is not. </p>

<div class="alert alert-block alert-success alert-text-normal"><b>Do not mix Numpy arrays and lists in functions</b>
<p>If a function is written to use  Numpy arrays as <em>arguments</em>, make sure that it <em>returns</em> Numpy arrays. If you have to use a list inside the function to e.g. store the results of a calculation, convert the list to a Numpy array before returning it by <code>np.array(my_list)</code>.  </p>
</div>

<h3 id="array-slicing" class="anchor">Array slicing </h3>
<p>You can access elements in Numpy arrays in the same way as lists, the syntax is <code>my_array[start,stop,step]</code></p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_array<span style="color: #666666">=</span>np<span style="color: #666666">.</span>arange(<span style="color: #666666">0</span>,<span style="color: #666666">6</span>,<span style="color: #666666">1</span>)
my_array[:]      <span style="color: #3D7B7B; font-style: italic"># [0,1,2,3,4,5]</span>
my_array[<span style="color: #666666">1</span>:]     <span style="color: #3D7B7B; font-style: italic"># [1,2,3,4,5]</span>
my_array[:<span style="color: #666666">-1</span>]    <span style="color: #3D7B7B; font-style: italic"># [0,1,2,3,4]</span>
my_array[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>]   <span style="color: #3D7B7B; font-style: italic"># [1,2,3,4]</span>
my_array[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>:<span style="color: #666666">2</span>] <span style="color: #3D7B7B; font-style: italic"># [1,3]</span>
my_array[::<span style="color: #666666">2</span>]    <span style="color: #3D7B7B; font-style: italic"># [0,2,4]</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>However, as opposed to lists all the basic mathematical operations addition, subtraction, multiplication are meaningful (<em>if the arrays have equal length, or shape</em>)</p>

<!-- code=text (!bc ccq) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <blockquote>
<div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_array  = np.array([0,1,2])
my_array2 = np.array([3,4,5])
my_array+my_array2 # [3,5,7]
my_array*my_array2 # [0,4,10]
my_array/my_array2 # [0,.25,.4]
</pre>
</div>
</blockquote>      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Note that these operations do what you would expect them to do. If you have arrays of arrays, you can easily access elements in the arrays</p>

<!-- code=text (!bc ccq) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <blockquote>
<div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_array  = np.array([[0,1,2],[3,4,5]]) # shape 2x3 matrix
my_array[0,:] # [0,1,2] First row
my_array[1,:] # [3,4,5] Second row
my_array[:,0] # [0,3] First column
my_array[:,1] # [1,4] Second column
</pre>
</div>
</blockquote>      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Not the extra <code>[]</code> in the definition of <code>my_array</code>.  Numpy arrays have a shape property, which makes it very easy to create different matrices. The array <code>[0,1,2,3,4,5]</code> has shape (6,), but we can change the shape to create e.g. a \( 2\times3 \) matrix</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_array  <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,<span style="color: #666666">2</span>,<span style="color: #666666">3</span>,<span style="color: #666666">4</span>,<span style="color: #666666">5</span>])
my_array<span style="color: #666666">.</span>shape <span style="color: #666666">=</span> (<span style="color: #666666">2</span>,<span style="color: #666666">3</span>) <span style="color: #3D7B7B; font-style: italic"># [[0,1,2],[3,4,5]] 2 rows and 3 columns</span>
my_array<span style="color: #666666">.</span>shape <span style="color: #666666">=</span> (<span style="color: #666666">3</span>,<span style="color: #666666">2</span>) <span style="color: #3D7B7B; font-style: italic"># [[0,1],[2,3],[4,5]] 3 rows and 2 columns</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h2 id="dictionaries" class="anchor">Dictionaries </h2>
<p>If you have not used dictionaries before they might feel unnecessary, but if you get used to them and their syntax, they can make your code much more flexible and easier to expand. You should use dictionaries, when you have data sets that you want to access fast. A very good mental image to have is an excel sheet where data are organized in columns. Each column has a header name, or a <em>key</em>. Assume we have the following table</p>

<div class="row">
  <div class="col-xs-1">
    <table class="table table-striped table-hover table-condensed">
<thead>
<tr><td align="center"><b> A </b></td> <td align="center"><b> B </b></td> <td align="center"><b> C </b></td> </tr>
</thead>
<tbody>
<tr><td align="center">   1.0    </td> <td align="center">   2.0    </td> <td align="center">   3.0    </td> </tr>
<tr><td align="center">   4.0    </td> <td align="center">   5.0    </td> <td align="center">          </td> </tr>
<tr><td align="center">   6.0    </td> <td align="center">   7.0    </td> <td align="center">          </td> </tr>
</tbody>
    </table>
  </div> <!-- col-xs-1 -->
</div> <!-- cell row -->

<p>This could be represented as a dictionary as</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_dict<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;A&#39;</span>:[<span style="color: #666666">1.0</span>,<span style="color: #666666">4.0</span>,<span style="color: #666666">6.0</span>],<span style="color: #BA2121">&#39;B&#39;</span>:[<span style="color: #666666">2.0</span>,<span style="color: #666666">5.0</span>,<span style="color: #666666">7.0</span>],<span style="color: #BA2121">&#39;C&#39;</span>:[<span style="color: #666666">3.0</span>]}
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The syntax is <code>{key1:values, key2:values2, ...}</code>. We access the values in the dictionary by the key i.e. <code>print(my_dict['A'])</code> would print <code>[1.0,4.0,6.0]</code>. If you want to print out all the elements in a dictionary, you can use a for loop (see next section for more details about for loops)</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">for</span> key <span style="color: #AA22FF; font-weight: bold">in</span> my_dict:
    <span style="color: #008000">print</span>(key, my_dict[key])
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h1 id="looping" class="anchor">Looping </h1>
<p>There are basically two ways of iterating through lists or to do a series of computations, using a for-loop or a while-loop. In most cases a for loop can also be written as a while loops and vice versa. You would typically use a for-loop when you are iterating over a fixed number of elements, very typical example is when we are iterating in a numerical computation from time zero to the end time. A while-loop is typically used when we do not know before the run time when to stop, this could be that we are waiting for user input or to reach a certain numerical accuracy in our calculation before proceeding.</p>
<h2 id="for-loops" class="anchor">For loops </h2>
<p>A typical example of a for loop is to loop over a list and do something, and maybe during the execution store the results in a list</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">numbers<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;one&#39;</span>,<span style="color: #BA2121">&#39;two&#39;</span>,<span style="color: #BA2121">&#39;three&#39;</span>,<span style="color: #BA2121">&#39;one&#39;</span>,<span style="color: #BA2121">&#39;two&#39;</span>]
result<span style="color: #666666">=</span>[] <span style="color: #3D7B7B; font-style: italic"># has to be declared as empty</span>
<span style="color: #008000; font-weight: bold">for</span> number <span style="color: #AA22FF; font-weight: bold">in</span> numbers:
    <span style="color: #008000; font-weight: bold">if</span> number <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;one&#39;</span>:
       result<span style="color: #666666">.</span>append(<span style="color: #666666">1</span>) 
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The result of this code is <code>result=[1, 1]</code>. The <code>number</code> variable changes during the iteration, and takes the value of each element in the list. Note that I use <code>numbers</code> for the list and <code>number</code> as the iterator, this makes it quite easy to read and understand the code. In many cases you want to have the index, not only the element in the list</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">numbers  <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;one&#39;</span>,<span style="color: #BA2121">&#39;two&#39;</span>,<span style="color: #BA2121">&#39;three&#39;</span>,<span style="color: #BA2121">&#39;one&#39;</span>,<span style="color: #BA2121">&#39;two&#39;</span>]
numerics <span style="color: #666666">=</span> [  <span style="color: #666666">1</span>  ,  <span style="color: #666666">2</span>  ,   <span style="color: #666666">3</span>   , <span style="color: #666666">1</span>   , <span style="color: #666666">2</span>   ]
result<span style="color: #666666">=</span>[] <span style="color: #3D7B7B; font-style: italic"># has to be declared as empty</span>
<span style="color: #008000; font-weight: bold">for</span> idx,number <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">enumerate</span>(numbers):
    <span style="color: #008000; font-weight: bold">if</span> number <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;one&#39;</span>:
       result<span style="color: #666666">.</span>append(numerics[idx]) 
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The result of this code is <code>result=[1, 1]</code>. In this case the function <code>enumerate(numbers)</code> returns two values: the index, which is stored in <code>idx</code>, and the value of the list element, which is stored in <code>number</code>.</p>

<p>A more elegant way to achieve the same results without using the <code>enumerate()</code> function is to use <code>zip</code></p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">numbers  <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;one&#39;</span>,<span style="color: #BA2121">&#39;two&#39;</span>,<span style="color: #BA2121">&#39;three&#39;</span>,<span style="color: #BA2121">&#39;one&#39;</span>,<span style="color: #BA2121">&#39;two&#39;</span>]
numerics <span style="color: #666666">=</span> [  <span style="color: #666666">1</span>  ,  <span style="color: #666666">2</span>  ,   <span style="color: #666666">3</span>   , <span style="color: #666666">1</span>   , <span style="color: #666666">2</span>   ]
result<span style="color: #666666">=</span>[] <span style="color: #3D7B7B; font-style: italic"># has to be declared as empty</span>
<span style="color: #008000; font-weight: bold">for</span> numeric,number <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">zip</span>(numerics,numbers):
    <span style="color: #008000; font-weight: bold">if</span> number <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;one&#39;</span>:
       result<span style="color: #666666">.</span>append(numeric) 
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The <code>zip</code> function can be used with several lists of same length.</p>

<p>In many cases you might be in a situation that you want to plot more than one function in a plot. It is then very tempting to copy and paste the previous code, but it is more elegant to use a for loop and lists</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
x_val   <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,<span style="color: #666666">100</span>) <span style="color: #3D7B7B; font-style: italic"># 100 equal spaced points from 0 to 1</span>
y_vals  <span style="color: #666666">=</span> [x_val,x_val<span style="color: #666666">*</span>x_val]
labels  <span style="color: #666666">=</span> [<span style="color: #BA2121">r&#39;x&#39;</span>, <span style="color: #BA2121">r&#39;$x^2$&#39;</span>]
cols    <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;r&#39;</span>,<span style="color: #BA2121">&#39;g&#39;</span>]
points  <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;-*&#39;</span>,<span style="color: #BA2121">&#39;-^&#39;</span>]
<span style="color: #008000; font-weight: bold">for</span> y_val,point,col,label <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">zip</span>(y_vals,points,cols,labels):
    plt<span style="color: #666666">.</span>plot(x_val,y_val,point,c<span style="color: #666666">=</span>col,label<span style="color: #666666">=</span>label)
plt<span style="color: #666666">.</span>grid()
plt<span style="color: #666666">.</span>legend()
plt<span style="color: #666666">.</span>show()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Output of code is shown in figure <a href="#fig:python:loop">2</a>.</p>

<center> <!-- figure label: --> <div id="fig:python:loop"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 2:  Output of code.  <!-- caption label: fig:python:loop --> </p>
</center>
<p><img src="fig-python/plt_loop.png" align="bottom" width=800></p>
</center>

<h2 id="while-loops" class="anchor">While loops </h2>
<p>A while loop is used whenever you do not know before run time when to stop iterating. The syntax of the while loop is to do something while a condition is true</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
finished <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
<span style="color: #008000">sum</span> <span style="color: #666666">=0</span>
<span style="color: #008000; font-weight: bold">while</span> <span style="color: #AA22FF; font-weight: bold">not</span> finished:
      <span style="color: #008000">sum</span> <span style="color: #666666">+=</span> np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>random() <span style="color: #3D7B7B; font-style: italic">#returns a random number between 0,1</span>
      <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">sum</span> <span style="color: #666666">&gt;=</span> <span style="color: #666666">10.</span>:
      	 finished <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>In some cases we are iterating from \( t_0 \), \( t_1 \), etc. to a final time \( t_f \), if we use a fixed time step, \( \Delta t \), we can calculate the number of steps i.e \( N= \text{int} ((t_f-t_0)/\Delta t) \), and use a for loop. On the other hand, in a more fancy algorithms we can change the time step as the simulation proceeds and then we need to choose a while loop, e.g. <code>while t0 &lt;= tf:</code>.
<h2 id="functions-in-python" class="anchor">Functions in Python </h2>
When to use functions? There is no particular rule, <em>but whenever you
start to copy and paste code from one place to another, you should
consider to use a function</em>. Functions makes the code easier to read.
It is not easy to identify which part of a program is a good candidate
for a function, it requires skill and experience. Most likely you will
end up changing the function definitions as your program develops.
</p>

<div class="alert alert-block alert-success alert-text-normal"><b>Use short functions</b>
<p>Short functions makes the code easier to read. Each function has a particular task, and it does only one thing. If functions do too many tasks there is a chance that you will have several functions doing some of the same operations. Whenever you want to extend the program, you may have to make changes several places in the code. The chance then is that you will forget to do the change in some of the functions and introduce a bug.</p>
</div>

<h2 id="defining-a-mathematical-function" class="anchor">Defining a mathematical function </h2>
<p>Throughout this course you will write many functions that do mathematical operations. In many cases, you would also pass a function to another function to make your code more modular. Lets say we want to calculate the derivative of \( \sin x \), using the most basic definition of a derivative \( f^\prime(x) = f(x+\Delta x)-f(x)/\Delta x \), we could do it as</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">derivative_of_sine</span>(x,delta_x):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39; returns the derivative of sin x &#39;&#39;&#39;</span>
    <span style="color: #008000; font-weight: bold">return</span> (np<span style="color: #666666">.</span>sin(x<span style="color: #666666">+</span>delta_x)<span style="color: #666666">-</span>np<span style="color: #666666">.</span>sin(x))<span style="color: #666666">/</span>delta_x

<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;The derivative of sinx at x=0 is :&#39;</span>, derivative_of_sine(<span style="color: #666666">0</span>,<span style="color: #666666">1e-3</span>))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>We will discuss in a later chapter why \( \Delta x=10^{-3} \) is a reasonable choice. 
If we would like to calculate the derivative at multiple points, that is straightforward since we have used the Numpy version of \( \sin x \).
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>array([<span style="color: #666666">0</span>,<span style="color: #666666">.5</span>,<span style="color: #666666">1</span>])
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Derivative of sinx at x=0,0.5,1 is :&#39;</span>, derivative_of_sine(x,<span style="color: #666666">1e-3</span>))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The challenge with our implementation is that if we want to calculate the derivative of another function we have to implement the derivative rule again for that function. It is better to have a separate function that calculates the derivative</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>sin(x)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">df</span>(x,f,delta_x<span style="color: #666666">=1e-3</span>):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39; returns the derivative of f &#39;&#39;&#39;</span>
    <span style="color: #008000; font-weight: bold">return</span> (f(x<span style="color: #666666">+</span>delta_x)<span style="color: #666666">-</span>f(x))<span style="color: #666666">/</span>delta_x
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Derivative of sinx at x=0 is :&#39;</span>, df(<span style="color: #666666">0</span>,f))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Note also that we have put <code>delta_x=1e-3</code> as a <em>default argument</em>. Default arguments have to come at the end of the argument lists, <code>df(x,delta_x=1e-3,f)</code> is not allowed. All of this looks well, but what you would experience is that your functions would not be as simple as \( \sin x \). In many cases your functions need additional arguments to be evaluated e.g.:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">s</span>(t,s0,v0,a):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">    t  : time</span>
<span style="color: #BA2121; font-style: italic">    s0 : initial starting point</span>
<span style="color: #BA2121; font-style: italic">    v0 : initial velocity</span>
<span style="color: #BA2121; font-style: italic">    a  : acceleration</span>
<span style="color: #BA2121; font-style: italic">    returns the distance traveled</span>
<span style="color: #BA2121; font-style: italic">    &#39;&#39;&#39;</span>
    <span style="color: #008000; font-weight: bold">return</span> s0<span style="color: #666666">+</span>v0<span style="color: #666666">*</span>t<span style="color: #666666">+</span>a<span style="color: #666666">*</span>t<span style="color: #666666">*</span>t<span style="color: #666666">*0.5</span> <span style="color: #3D7B7B; font-style: italic">#multiplication (0.5)is general faster</span>
    	   		     <span style="color: #3D7B7B; font-style: italic">#than division (2)</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>How can we calculate the derivative of this function? If we try to do <code>df(1,s)</code> we will get the following message</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #CB3F38; font-weight: bold">TypeError</span>: s() missing <span style="color: #666666">3</span> required positional
	   arguments: <span style="color: #BA2121">&#39;s0&#39;</span>, <span style="color: #BA2121">&#39;v0&#39;</span>, <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #BA2121">&#39;a&#39;</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>This happens because the <code>df</code> function expect that the function we send into the argument list has a call signature <code>f(x)</code>. What many people do to avoid this error is to use global variable, that is to define <code>s0, v0</code>, and <code>a</code> at the top of the code. This is not always the best solution. Python has a special variable <code>*args</code> which can be used to pass multiple arguments to your function, thus if we rewrite <code>df</code> like this</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">df</span>(x,f,<span style="color: #666666">*</span>args,delta_x<span style="color: #666666">=1e-3</span>):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39; returns the derivative of f &#39;&#39;&#39;</span>
    <span style="color: #008000; font-weight: bold">return</span> (f(x<span style="color: #666666">+</span>delta_x,<span style="color: #666666">*</span>args)<span style="color: #666666">-</span>f(x,<span style="color: #666666">*</span>args))<span style="color: #666666">/</span>delta_x
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>we can do (assuming <code>s0=0</code>, <code>v0=1</code>, and <code>a=9.8</code>)</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;The derivative of sinx at x=0 is :&#39;</span>, df(<span style="color: #666666">0</span>,f))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;The derivative of s(t) at t=1 is :&#39;</span>, df(<span style="color: #666666">0</span>,s,<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,<span style="color: #666666">9.8</span>))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h2 id="scope-of-variables" class="anchor">Scope of variables  </h2>
<p>In small programs you would not care about scope, but once you have several functions, you will easily get into trouble if you do not consider the scope of a variable. By scope of a variable we mean where the variable is available, first some simple examples</p>

<p>
<b>A variable created inside a function is only available within the function:</b>
``
</p>


<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    a<span style="color: #666666">=10</span>
    b<span style="color: #666666">=20</span>
    <span style="color: #008000; font-weight: bold">return</span> a<span style="color: #666666">*</span>x<span style="color: #666666">+</span>b
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Doing <code>print(a)</code> outside the function will throw an error: <code>name 'a' is not defined</code>. What happens if we define variable <code>a</code> outside the function?</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">a<span style="color: #666666">=2</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    a<span style="color: #666666">=10</span>
    b<span style="color: #666666">=20</span>
    <span style="color: #008000; font-weight: bold">return</span> a<span style="color: #666666">*</span>x<span style="color: #666666">+</span>b
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>If we first call the function <code>f(0)</code>, and then do <code>print(a)</code> Python would give the answer <code>2</code>, <em>not</em> <code>10</code>. A <em>local</em> variable <code>a</code> is created inside <code>f(x)</code>, that does not interfere with the variable <code>a</code> defined outside the function.</p>

<p>
<b>The <code>global</code> keyword can be used to pass and access variables in functions:</b>
</p>

<p>&quot;</p>


<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">global</span> a
a<span style="color: #666666">=2</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">global</span> a
    a<span style="color: #666666">=10</span>
    b<span style="color: #666666">=20</span>
    <span style="color: #008000; font-weight: bold">return</span> a<span style="color: #666666">*</span>x<span style="color: #666666">+</span>b
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>In this case <code>print(a)</code> <em>before</em> calling <code>f(x)</code> will give the answer <code>2</code> and <em>after</em> calling <code>f(x)</code> will give <code>10</code>.</p>

<div class="alert alert-block alert-success alert-text-normal"><b>Use of global variables</b>
<p>Sometimes global variables can be very useful, and help you to make the code simpler. But make sure to use a <em>naming convention</em>  for them, e.g. end all the global variables with an underscore. In the example above we would write <code>global a_</code>. A person reading the code would then know that all variables ending with an underscore are global, and can potentially be modified by several functions.  </p>
</div>

<h2 id="passing-arrays-and-lists-to-functions" class="anchor">Passing arrays and lists to functions </h2>
<p>In the previous section, we looked at some simple examples regarding the scope of variables, and what happened with that variable inside and outside a function. The examples used integer or floats. However in most applications you will pass an array or a list to a function, and then you need to be aware that the behavior is not always would you might expect.</p>
<div class="alert alert-block alert-success alert-text-normal"><b>Unexpected behavior</b>
<p>Sometimes functions do not do what you expect, this might be because the function does not treat  the arguments as you might think. The best advice is to make a very simple version of your function and test it for yourself. Is the behavior what you expect? Try to understand why or why not.</p>
</div>

<p>Let us look at some examples, and try to understand what is going on and why.</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x<span style="color: #666666">=3</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    x <span style="color: #666666">=</span> x<span style="color: #666666">*2</span>
    <span style="color: #008000; font-weight: bold">return</span> x
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;x =&#39;</span>,x)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;f(x) returns &#39;</span>, f(x))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;x is now &#39;</span>, x)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>In the example above we can use <code>x=3</code>, <code>x=[3]</code>, <code>x=np.array([3])</code>, and after execution <code>x</code> is unchanged (i.e. same value as before <code>f(x)</code>) was called. Based on what we have discussed before, this is maybe what you would expect, but if we now do</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x<span style="color: #666666">=</span>[<span style="color: #666666">3</span>]
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">append_to_list</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">.</span>append(<span style="color: #666666">1</span>)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;x = &#39;</span>,x)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;append_to_list(x) returns &#39;</span>, append_to_list(x))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;x is now &#39;</span>, x)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>(Clearly this function will only work for lists, due to the append command.) After execution, we get the result</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x <span style="color: #666666">=</span> [<span style="color: #666666">3</span>]
append_to_list(x) <span style="color: #3D7B7B; font-style: italic">#returns  [3 1], x is now  [3, 1]</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Even if this might be exactly what you wanted your function to do, why does <code>x</code> change here when it is a list and not in the previous case when it is a float? Before we explain this behavior let us rewrite the function to work with Numpy arrays</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>array([<span style="color: #666666">3</span>])
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">append_to_np</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>append(x,<span style="color: #666666">1</span>)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;x = &#39;</span>,x)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;append_to_np(x) returns &#39;</span>, append_to_np(x))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;x is now &#39;</span>, x)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The output of this code is</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x <span style="color: #666666">=</span>  np<span style="color: #666666">.</span>array([<span style="color: #666666">3</span>])
append_to_np(x) <span style="color: #3D7B7B; font-style: italic">#returns  [3 1], x is now  [3]</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>This time <code>x</code> was not changed, what is happening here? It is important to understand what is going on because it deals with how Python handles variables in the memory. If <code>x</code> contains million of values, it can slow down your program, if we do</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">N<span style="color: #666666">=1000000</span>
x<span style="color: #666666">=</span>[<span style="color: #666666">3</span>]<span style="color: #666666">*</span>N
<span style="color: #666666">%</span>timeit append_to_list(x)
x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>array([<span style="color: #666666">3</span>]<span style="color: #666666">*</span>N)
<span style="color: #666666">%</span>timeit append_to_np(x)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>On my computer I found that <code>append_to_list</code> used 76 nano seconds, and <code>append_to_np</code>
used 512 micro seconds, the Numpy function was about 6000 times slower! To add to the confusion consider the following functions
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>array([<span style="color: #666666">3</span>])
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">add_to_np</span>(x):
    x<span style="color: #666666">=</span>x<span style="color: #666666">+3</span>
    <span style="color: #008000; font-weight: bold">return</span> x

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">add_to_np2</span>(x):
    x<span style="color: #666666">+=3</span>
    <span style="color: #008000; font-weight: bold">return</span> x
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;x = &#39;</span>,x)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;add_to_np(x) returns &#39;</span>, add_to_np(x))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;x is now &#39;</span>, x)

<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;x = &#39;</span>,x)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;add_to_np2(x) returns &#39;</span>, add_to_np2(x))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;x is now &#39;</span>, x)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The output is</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x <span style="color: #666666">=</span>  np<span style="color: #666666">.</span>array([<span style="color: #666666">3</span>])
add_to_np(x) <span style="color: #3D7B7B; font-style: italic">#returns [6], x is now [3] </span>
x <span style="color: #666666">=</span>  np<span style="color: #666666">.</span>array([<span style="color: #666666">3</span>])
add_to_np2(x) <span style="color: #3D7B7B; font-style: italic">#returns  [6], x is now  [6]</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>In both cases the function returns what you expect, but it has an unexpected (or at least a different) behavior regarding the variable <code>x</code>. What about speed?</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">N<span style="color: #666666">=10000000</span>
x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>array([<span style="color: #666666">3</span>]<span style="color: #666666">*</span>N)
<span style="color: #666666">%</span>timeit add_to_np(x)
x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>array([<span style="color: #666666">3</span>]<span style="color: #666666">*</span>N)
<span style="color: #666666">%</span>timeit add_to_np2(x)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p><code>add_to_np</code> is about twice as slow as <code>add_to_np2</code>. In the next section we will try to explain the difference in behavior.</p>

<div class="alert alert-block alert-success alert-text-normal"><b>Avoiding unwanted behavior of functions</b>
<p>The examples in this section are meant to show you that if you pass an array to a function, the array can be altered outside the scope of the function. If this is not what you want, it could lead to bugs that are hard to detect. Thus, if you experience unwanted behavior pick out the part of function involving list or array operations and test one by one in the editor.</p>
</div>

<h2 id="call-by-value-or-call-by-reference" class="anchor">Call by value or call by reference  </h2>
<p>For anyone that has programmed in C or C++ call by reference or value is something one need to think about constantly. When we pass a variable to a function there are two choices, should we pass a copy of the variable or should we pass information about where the variable is stored in memory?</p>
<div class="alert alert-block alert-success alert-text-normal"><b>Value and reference</b>
<p>In C and C++ pass by value means that we are making a copy in the memory of the variable we are sending to the function, and pass by reference means that we are sending the actual parameter or more specific the address to the memory location of the parameter. In Python all variables are passed by object reference.</p>
</div>

<p>In C and C++ you always tell in the function definition if the variables are passed by value or reference. Thus if you would like a change in a variable outside the function definition, you pass the variable by reference, otherwise by value. In Python we always pass by (object) reference.</p>
<h3 id="floats-and-integers" class="anchor">Floats and integers </h3>
<p>To gain a deeper understanding, we can use the <code>id</code> function, the <code>id</code> function gives the unique id to a variable. In C this would be the actual memory address, lets look at a couple of examples</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">a<span style="color: #666666">=10.0</span>
<span style="color: #008000">print</span>(<span style="color: #008000">id</span>(a)) <span style="color: #3D7B7B; font-style: italic">#gives on my computer 140587667748656</span>
a <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
<span style="color: #008000">print</span>(<span style="color: #008000">id</span>(a)) <span style="color: #3D7B7B; font-style: italic">#gives on my computer 140587667748400</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Thus, after adding 1 to <code>a</code>, <code>a</code> is assigned <em>a new place in memory</em>. This is very different from C or C++, in C or C++ the variable, once it is created, <em>always has the same memory address</em>. In Python this is not the case, it works in the opposite way. The statement <code>a=10.0</code>, is executed so that <em>first</em> 10.0 is created in memory, secondly <code>x</code> is assigned the reference to 10.0. The assignment operator <code>=</code> indicates that <code>a</code> should point to whatever is on the right hand side. Another example is     </p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">a<span style="color: #666666">=10.0</span>
b<span style="color: #666666">=10.0</span>
<span style="color: #008000">print</span>(a <span style="color: #AA22FF; font-weight: bold">is</span> b) <span style="color: #3D7B7B; font-style: italic"># prints False</span>
b<span style="color: #666666">=</span>a
<span style="color: #008000">print</span>(a <span style="color: #AA22FF; font-weight: bold">is</span> b ) <span style="color: #3D7B7B; font-style: italic"># prints True</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>In this case 10.0 is created in two different places in the memory and a different reference is assigned to <code>a</code> and <code>b</code>. However if we put <code>b=a</code>, <code>b</code> points to the same object as <code>a</code> is pointing on. More examples</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">a<span style="color: #666666">=10</span>
b<span style="color: #666666">=</span>a
<span style="color: #008000">print</span>(a <span style="color: #AA22FF; font-weight: bold">is</span> b) <span style="color: #3D7B7B; font-style: italic"># True</span>
a<span style="color: #666666">+=2</span>
<span style="color: #008000">print</span>(a <span style="color: #AA22FF; font-weight: bold">is</span> b) <span style="color: #3D7B7B; font-style: italic"># False</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>When we add 2 to <code>a</code>, we actually add 2 to the value of 10, the number 12 is assigned a new place in memory and <code>a</code> will be assigned that object, whereas <code>b</code> would still points the old object 10.</p>
<h3 id="lists-and-arrays" class="anchor">Lists and arrays </h3>
<p>Yous should think of lists and arrays as containers (or a box). If we do</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x<span style="color: #666666">=</span>[<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,<span style="color: #666666">2</span>,<span style="color: #666666">3</span>,<span style="color: #666666">4</span>]
<span style="color: #008000">print</span>(<span style="color: #008000">id</span>(x))
x[<span style="color: #666666">0</span>]<span style="color: #666666">=10</span>
<span style="color: #008000">print</span>(<span style="color: #008000">id</span>(x)) <span style="color: #3D7B7B; font-style: italic"># same id value as before and x=[10,1,2,3,4]</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>First, we create a list, which is basically a box with the numbers 0, 1, 2, 3, 4. The variable <code>x</code> points to <em>the box</em>, and <code>x[0]</code> points to 0, and <code>x[1]</code> to 1 etc. Thus if we do <code>x[0]=10</code>, that would be the same as picking 0 out of the box and replacing it with 10, but <em>the box stays the same</em>. Thus when we do <code>print(x)</code>, we print the content of the box. If we do</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x<span style="color: #666666">=</span>[<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,<span style="color: #666666">2</span>,<span style="color: #666666">3</span>,<span style="color: #666666">4</span>]
y<span style="color: #666666">=</span>x
<span style="color: #008000">print</span>(x <span style="color: #AA22FF; font-weight: bold">is</span> y) <span style="color: #3D7B7B; font-style: italic"># True</span>
x<span style="color: #666666">.</span>append(<span style="color: #666666">10</span>)  <span style="color: #3D7B7B; font-style: italic"># x is now [0,1,2,3,4,10]</span>
<span style="color: #008000">print</span>(y)      <span style="color: #3D7B7B; font-style: italic"># y=[0,1,2,3,4,10]</span>
<span style="color: #008000">print</span>(x <span style="color: #AA22FF; font-weight: bold">is</span> y) <span style="color: #3D7B7B; font-style: italic"># True</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>What happens here is that we create a box with the numbers 0, 1, 2, 3, 4, <code>x</code> is referenced that box. Next, we do <code>y=x</code> so that <code>y</code> is referenced the <em>same box</em> as <code>x</code>. Then, we add the number 10 to that box, and <code>x</code> and <code>y</code> still points to the same box.</p>

<p>Numpy arrays behave differently, and that is basically because if we want to add a number to a Numpy array we have to do <code>x=np.array(x,10)</code>. Because of the assignment operator <code>=</code> , we take the content of the original box add 10 and put it into a <em>new</em> box</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>array([<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,<span style="color: #666666">2</span>,<span style="color: #666666">3</span>,<span style="color: #666666">4</span>])
y<span style="color: #666666">=</span>x
<span style="color: #008000">print</span>(x <span style="color: #AA22FF; font-weight: bold">is</span> y)     <span style="color: #3D7B7B; font-style: italic"># True</span>
x<span style="color: #666666">=</span>np<span style="color: #666666">.</span>append(x,<span style="color: #666666">10</span>) <span style="color: #3D7B7B; font-style: italic"># x is now [0,1,2,3,4,10]</span>
<span style="color: #008000">print</span>(y)          <span style="color: #3D7B7B; font-style: italic"># y=[0,1,2,3,4]</span>
<span style="color: #008000">print</span>(x <span style="color: #AA22FF; font-weight: bold">is</span> y)     <span style="color: #3D7B7B; font-style: italic"># False</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The reason for this behavior is that the elements in Numpy arrays (contrary to lists) have to be continuous in the memory, and the only way to achieve this is to create a new box that is large enough to also contain the new number. This also explains that if you use the <code>np.append(x,some_value)</code> inside a function where <code>x</code> is large it could slow down your code, because the program has to delete <code>x</code> and create a new very large box each time it would want to add a new element. A better way to do it is to create <code>x</code> <em>large enough</em> in the beginning, and then just assign values <code>x[i]=a</code>. </p>
<h2 id="mutable-and-immutable-objects" class="anchor">Mutable and immutable objects </h2>
<p>What we have explained in the previous section is related to what is known as mutable and immutable objects. These terms are used to describe objects that have an internal state that can be changed (mutable), and objects that have an internal state that cannot be changed after they have been created. Example of mutable objects are lists, dictionaries, and arrays. Examples of immutable objects are floats, ints, tuples, and strings. Thus if we create the number 10 its value cannot be changed (and why would we do that?). Note that this is <em>not the same as saying that</em>  <code>x=10</code> and that the internal state of <code>x</code> cannot change, this is <em>not</em> true. We are allowed to make <code>x</code> reference another object. If we do <code>x=10</code>, then <code>x is 10</code> will give true and they will have the same value if we use the <code>id</code> operator on <code>x</code> and <code>10</code>. If we later say that <code>a=11</code> then <code>a is 10</code> will give false and <code>id(a)</code> and <code>id(10)</code> give different values, but * <code>id(10)</code> will have the same value as before*.</p>

<p>Lists are mutable objects, and once a list is created, we can change the content without changing the reference to that object. That is why the operations <code>x=[]</code> and <code>x.append(1)</code>, does not change the id of x, and also explain that if we put <code>y=x</code>, <code>y</code> would change if <code>x</code> is changed. Contrary to immutable objects if <code>x=[]</code>, and <code>y=[]</code> then <code>x is y</code> will give false. Thus, whenever you create a list it will be an unique object.    </p>

<div class="alert alert-block alert-success alert-text-normal"><b>A final tip</b>
<p>You are bound to get into strange, unwanted behavior when working with lists, arrays and dictionaries (mutable) objects in Python. Whenever, you are unsure, just make a simple version of your lists and perform some of the operations on them to investigate if the behavior is what you want.</p>
</div>

<p>Finally, we show some ``unexpected&quot; behavior, just to demonstrate that it is easy to do mistakes and one should always test code on simple examples. </p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x_old<span style="color: #666666">=</span>[]
x  <span style="color: #666666">=</span> [<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>]
x_old[:] <span style="color: #666666">=</span> x[:] <span style="color: #3D7B7B; font-style: italic"># x_old = [1, 2, 3]</span>
x[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> <span style="color: #666666">10</span>
<span style="color: #008000">print</span>(x_old) <span style="color: #3D7B7B; font-style: italic"># &quot;expected&quot; x_old = [10, 2, 3], actual [1, 2, 3] </span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Comment: We put the <em>content</em> of the <code>x</code> container into <code>x_old</code>, but <code>x</code> and <code>x_old</code> reference different containers.  </p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">add_to_list</span>(x,add_to<span style="color: #666666">=</span>[])
    add_to<span style="color: #666666">.</span>append(x)
    <span style="color: #008000; font-weight: bold">return</span> add_to

<span style="color: #008000">print</span>(add_to_list(<span style="color: #666666">1</span>)) <span style="color: #3D7B7B; font-style: italic"># &quot;expected&quot; [1] actual [1]</span>
<span style="color: #008000">print</span>(add_to_list(<span style="color: #666666">2</span>)) <span style="color: #3D7B7B; font-style: italic"># &quot;expected&quot; [2] actual [1, 2]</span>
<span style="color: #008000">print</span>(add_to_list(<span style="color: #666666">3</span>)) <span style="color: #3D7B7B; font-style: italic"># &quot;expected&quot; [3] actual [1, 2, 3]</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Comment: <code>add_to=[]</code> is a default argument and it is created once when the program starts and not each time the function is called.</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">x <span style="color: #666666">=</span> [<span style="color: #666666">10</span>]
y <span style="color: #666666">=</span> x
y <span style="color: #666666">=</span> y <span style="color: #666666">+</span> [<span style="color: #666666">1</span>]
<span style="color: #008000">print</span>(x, y) <span style="color: #3D7B7B; font-style: italic"># prints [10] [10, 1]</span>

x <span style="color: #666666">=</span> [<span style="color: #666666">10</span>]
y <span style="color: #666666">=</span> x
y <span style="color: #666666">+=</span> [<span style="color: #666666">1</span>] 
<span style="color: #008000">print</span>(x, y) <span style="color: #3D7B7B; font-style: italic"># prints [10, 1] [10, 1]</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Comment: In the first case <code>y + [1]</code> creates a new object and the assignment operator <code>=</code> assign <code>y</code> to that object, thus <code>x</code> stays the same. In the second case the <code>+=</code> adds <code>[1]</code> to the <code>y</code> container without changing the container, and thus <code>x</code> also changes.</p>

<center>
<h1 id="ch:pan" class="anchor">Introduction to Pandas</h1>
</center> <!-- chapter heading -->
<h1 id="what-is-pandas" class="anchor">What is Pandas? </h1>
<p>Pandas is a Python package that among many things is used to handle data, and perform operations on groups of data. It is built on top of Numpy, which makes it easy to perform vectorized operations. Pandas is written by Wes McKinney, and one of it objectives is according to the official website <a href="https://pandas.pydata.org/" target="_self"> '' providing fast, flexible, and expressive data structures designed to make working with ''relational'' or ''labeled'' data both easy and intuitive. It aims to be the fundamental high-level building block for doing practical, real-world data analysis in Python''</a>. Pandas also has excellent functions for reading and writing excel and csv files.  An excel file is read directly into memory in what is called a <code>DataFrame</code>. A DataFrame is a two dimensional object where data are typically stored in column or row format. Pandas has a lot of functions that can be used to calculate statistical properties of the data frame as a whole. In this chapter, we will focus on basic data manipulation, stuff you might do in excel, but can be done much faster in Python and Pandas.</p>
<h1 id="creating-a-data-frame" class="anchor">Creating a data frame </h1>
<p>In the following we will assume that you have imported pandas, like this:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h2 id="from-an-empty-dataframe" class="anchor">From an empty DataFrame </h2>
<p>This is perhaps the most basic way of creating a DataFrame, first we create an empty DataFrame:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df <span style="color: #666666">=</span> pd<span style="color: #666666">.</span>DataFrame()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<div class="alert alert-block alert-success alert-text-normal"><b>Variable name</b>
<p>Note that we often use <code>df</code> as a variable name for a DataFrame, this is a choice, but it is a good choice as someone else reading the code could infer from a name that <code>df</code> is a DataFrame. If you need more than one DataFrame variable you could use <code>df1</code>, <code>df2</code>, etc. or even better, use a descriptive name, <code>df_sales_data</code>.</p>
</div>

<p>Next, we can add columns to the DataFrame:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>DataFrame()
df[<span style="color: #BA2121">&#39;ints&#39;</span>]<span style="color: #666666">=</span>[<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,<span style="color: #666666">2</span>,<span style="color: #666666">3</span>]
df[<span style="color: #BA2121">&#39;floats&#39;</span>]<span style="color: #666666">=</span>[<span style="color: #666666">4.</span>,<span style="color: #666666">5.</span>,<span style="color: #666666">6.</span>,<span style="color: #666666">7.</span>]
df[<span style="color: #BA2121">&#39;tools&#39;</span>]<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;hammer&#39;</span>,<span style="color: #BA2121">&#39;saw&#39;</span>,<span style="color: #BA2121">&#39;rock&#39;</span>,<span style="color: #BA2121">&#39;nail&#39;</span>]
<span style="color: #008000">print</span>(df) <span style="color: #3D7B7B; font-style: italic"># to view data frame</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Note that all columns need to have the same size.</p>

<div class="alert alert-block alert-success alert-text-normal"><b><code>pd.Series()</code></b>
<p>Even if we initialize the DataFrame column with a list, the command <code>type(df['a'])</code> will tell you that the column in the DataFrame are of type <code>pd.Series()</code>. Thus the fundamental objects in Pandas are of type <code>Series</code>. Series are more flexible, and it is possible to calculate <code>df['a']/df['b']</code>, whereas <code>[0,1,2,3]/[4,5,6,7]</code> is not possible.  </p>
</div>

<h2 id="create-dataframe-from-dictionary" class="anchor">Create DataFrame from dictionary </h2>
<p>A DataFrame can be easily generated from a dictionary. A dictionary is a special data structure, where an unique key is associated with a data type (key:value pair). In this case, the key would be the title of the column, and the value would be the data in the columns.</p>


<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_dict<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;ints&#39;</span>:[<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,<span style="color: #666666">2</span>,<span style="color: #666666">3</span>], <span style="color: #BA2121">&#39;floats&#39;</span>:[<span style="color: #666666">4.</span>,<span style="color: #666666">5.</span>,<span style="color: #666666">6.</span>,<span style="color: #666666">7.</span>],
<span style="color: #BA2121">&#39;tools&#39;</span>:[<span style="color: #BA2121">&#39;hammer&#39;</span>,<span style="color: #BA2121">&#39;saw&#39;</span>,<span style="color: #BA2121">&#39;rock&#39;</span>,<span style="color: #BA2121">&#39;nail&#39;</span>]
}
df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>DataFrame(my_dict)
<span style="color: #008000">print</span>(df) <span style="color: #3D7B7B; font-style: italic"># to view</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h2 id="from-a-file" class="anchor">From a file </h2>
<p>Assume you have some data organized in excel or in a csv file. The csv file could just be a file with column data, they could be separated by a comma or tab.</p>

<center> <!-- figure label: --> <div id="fig:file"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 3:  Official Covid-19 data, and example of files (left) tab separated (right) excel file.  <!-- caption label: fig:file --> </p>
</center>
<p><img src="fig-pandas/covid_comb.png" align="bottom" width=800></p>
</center>


<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_excel(<span style="color: #BA2121">&#39;../data/corona_data.xlsx&#39;</span>) <span style="color: #3D7B7B; font-style: italic"># excel file</span>
df2<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_csv(<span style="color: #BA2121">&#39;../data/corona_data.dat&#39;</span>,sep<span style="color: #666666">=</span><span style="color: #BA2121">&#39;</span><span style="color: #AA5D1F; font-weight: bold">\t</span><span style="color: #BA2121">&#39;</span>) <span style="color: #3D7B7B; font-style: italic"># csv tab separated file</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>If the excel file has several sheets, you can give the sheet name directly, e.g. <code>df=pd.read_excel('file.xlsx',sheet_name='Sheet1')</code>, for more information see the <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html" target="_self">documentation</a>. </p>

<div class="alert alert-block alert-success alert-text-normal"><b>Accessing files</b>
<p>Accessing files from python can be painful. If excel files are open in excel, Windows will not allow a different program to access it - always remember to close the file before opening it. Sometimes we are not in the right directory, to check which directory you are in, you can always do the following</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #ffffff">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">os</span>
<span style="color: #008000">print</span>(os<span style="color: #666666">.</span>getcwd()) <span style="color: #3D7B7B; font-style: italic"># prints current working directory</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
</div>


<p>We can easily save the data frame to excel format and open it in Excel</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">.</span>to_excel(<span style="color: #BA2121">&#39;covid19.xlsx&#39;</span>, index<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>) <span style="color: #3D7B7B; font-style: italic"># what happens if index=True?</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<div class="alert alert-block alert-success alert-text-normal"><b>Index column</b>
<p>Whenever you create a DataFrame, Pandas by default create an index column, it contains an integer for each row starting at zero. It can be accessed by <code>df.index</code>, and it is also possible to define another column as index column. </p>
</div>

<h2 id="accessing-data-in-dataframes" class="anchor">Accessing data in  DataFrames </h2>
<h3 id="selecting-columns" class="anchor">Selecting columns  </h3>

<p>If we want to pick out a specific column we can access it in the following way</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_excel(<span style="color: #BA2121">&#39;../data/corona_data.xlsx&#39;</span>) 
<span style="color: #3D7B7B; font-style: italic"># following two are equivalent</span>
time<span style="color: #666666">=</span>df[<span style="color: #BA2121">&#39;TIME&#39;</span>] <span style="color: #3D7B7B; font-style: italic"># by the name, alternatively</span>
time<span style="color: #666666">=</span>df[df<span style="color: #666666">.</span>columns[<span style="color: #666666">1</span>]]
<span style="color: #3D7B7B; font-style: italic"># following two are equivalent</span>
time<span style="color: #666666">=</span>df<span style="color: #666666">.</span>loc[:,[<span style="color: #BA2121">&#39;TIME&#39;</span>]] <span style="color: #3D7B7B; font-style: italic"># by loc[] if we use name</span>
time<span style="color: #666666">=</span>df<span style="color: #666666">.</span>iloc[:,<span style="color: #666666">1</span>] <span style="color: #3D7B7B; font-style: italic"># by iloc, pick column number 1</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The <code>loc[]</code> and <code>iloc[]</code> functions also allow list slicing, one can then pick e.g. every second element in the column by <code>time=df.iloc[::2,1]</code> etc. The difference is that <code>loc[]</code> uses the name, and <code>iloc[]</code> the index (usually an integer). </p>

<p>Why do we have several ways of doing the same operation? It turns out that although we are able to extract what we want with these operations, they are of different type:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000">print</span>(<span style="color: #008000">type</span>(df[<span style="color: #BA2121">&#39;TIME&#39;</span>]))
<span style="color: #008000">print</span>(<span style="color: #008000">type</span>(df<span style="color: #666666">.</span>loc[:,[<span style="color: #BA2121">&#39;TIME&#39;</span>]]))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h3 id="selecting-rows" class="anchor">Selecting rows  </h3>
<p>When selecting rows in a DataFrame, we can use the <code>loc[]</code> and <code>iloc[]</code> functions</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic"># pick rows number 0 and 1</span>
time<span style="color: #666666">=</span>df<span style="color: #666666">.</span>loc[<span style="color: #666666">0</span>:<span style="color: #666666">1</span>,:] <span style="color: #3D7B7B; font-style: italic"># by loc[] </span>
time<span style="color: #666666">=</span>df<span style="color: #666666">.</span>iloc[<span style="color: #666666">0</span>:<span style="color: #666666">2</span>,:] <span style="color: #3D7B7B; font-style: italic"># by iloc</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<div class="alert alert-block alert-success alert-text-normal"><b><code>pandas.DataFrame.loc</code> vs <code>pandas.DataFrame.iloc</code></b>
<p>When selecting rows <code>loc</code> and <code>iloc</code> behave differently, <code>loc</code> includes the endpoints (in the example above both row 0 and 1), whereas <code>iloc</code> includes the starting point and up to the endpoint. </p>
</div>

<h3 id="challenges-when-accessing-columns-or-rows" class="anchor">Challenges when accessing columns or rows </h3>

<div class="alert alert-block alert-success alert-text-normal"><b>Special characters</b>
<p>Sometimes when reading files from excel, headers may contains invisible characters like newline <code>\n</code> or tab <code>\t</code> or maybe Norwegian special letters that have not been read in properly. If you have problems accessing a column by name do <code>print(df.columns)</code> and check if the name matches what you would expect.  </p>
</div>


<p>If the header names have unwanted white space, one can do:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">.</span>columns <span style="color: #666666">=</span> df<span style="color: #666666">.</span>columns<span style="color: #666666">.</span>str<span style="color: #666666">.</span>replace(<span style="color: #BA2121">&#39; &#39;</span>, <span style="color: #BA2121">&#39;&#39;</span>) <span style="color: #3D7B7B; font-style: italic"># all white spaces</span>
df<span style="color: #666666">.</span>columns <span style="color: #666666">=</span> df<span style="color: #666666">.</span>columns<span style="color: #666666">.</span>str<span style="color: #666666">.</span>lstrip() <span style="color: #3D7B7B; font-style: italic"># the beginning of string</span>
df<span style="color: #666666">.</span>columns <span style="color: #666666">=</span> df<span style="color: #666666">.</span>columns<span style="color: #666666">.</span>str<span style="color: #666666">.</span>rstrip() <span style="color: #3D7B7B; font-style: italic"># end of string</span>
df<span style="color: #666666">.</span>columns <span style="color: #666666">=</span> df<span style="color: #666666">.</span>columns<span style="color: #666666">.</span>str<span style="color: #666666">.</span>strip()  <span style="color: #3D7B7B; font-style: italic"># both ends</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Similarly for unwanted tabs:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">.</span>columns <span style="color: #666666">=</span> df<span style="color: #666666">.</span>columns<span style="color: #666666">.</span>str<span style="color: #666666">.</span>replace(<span style="color: #BA2121">&#39;</span><span style="color: #AA5D1F; font-weight: bold">\t</span><span style="color: #BA2121">&#39;</span>, <span style="color: #BA2121">&#39;&#39;</span>) <span style="color: #3D7B7B; font-style: italic"># remove tab</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>If you want to make sure that the columns do not contain any white spaces, you can use <a href="https://pandas.pydata.org/pandas-docs/version/1.2.4/reference/api/pandas.Series.str.strip.html" target="_self"><tt>pandas.Series.str.strip()</tt></a></p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df[<span style="color: #BA2121">&#39;LOCATION&#39;</span>]<span style="color: #666666">=</span>df[<span style="color: #BA2121">&#39;LOCATION&#39;</span>]<span style="color: #666666">.</span>str<span style="color: #666666">.</span>strip()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h3 id="time-columns-not-parsed-properly" class="anchor">Time columns not parsed properly </h3>
<p>If you have dates in the file (as in our case for the <code>TIME</code> column), you should check if they are in the <code>datetime</code> format and not read as <code>str</code>.</p>

<div class="alert alert-block alert-success alert-text-normal"><b><code>datetime</code></b>
<p>The <code>datetime</code> library is very useful for working with dates. Data types of the type <code>datetime</code> (or equivalently <code>timestamp</code> used by Pandas) contain both date and time in the format <code>YYYY-MM-DD hh:mm:ss</code>. We can initialize a variable, <code>a</code>, by <code>a=datetime.datetime(2022,8,30,10,14,1)</code>, to access the hour we do <code>a.hour</code>, the year by <code>a.year</code> etc. It is also easy to increase e.g. the day by one by doing <code>a+datetime.timedelta(days=1)</code>. </p>
</div>



<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">datetime</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">dt</span>
time<span style="color: #666666">=</span>df[<span style="color: #BA2121">&#39;TIME&#39;</span>]
<span style="color: #3D7B7B; font-style: italic"># what happens if you set</span>
<span style="color: #3D7B7B; font-style: italic"># time=df2[&#39;TIME&#39;] #i.e df2 is from pd.read_csv ?</span>
<span style="color: #008000">print</span>(time[<span style="color: #666666">0</span>])
<span style="color: #008000">print</span>(time[<span style="color: #666666">0</span>]<span style="color: #666666">+</span>dt<span style="color: #666666">.</span>timedelta(days<span style="color: #666666">=1</span>))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The code above might work fine or in some cases a date is parsed as a string by Pandas, then we need to convert that column to the correct format. If not, we get into problems if you want to plot data vs the time column.</p>

<p>Below are two ways of converting the <code>TIME</code> column:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df2[<span style="color: #BA2121">&#39;TIME&#39;</span>]<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>to_datetime(df2[<span style="color: #BA2121">&#39;TIME&#39;</span>])
<span style="color: #3D7B7B; font-style: italic"># just for testing that everything went ok</span>
time<span style="color: #666666">=</span>df2[<span style="color: #BA2121">&#39;TIME&#39;</span>]
<span style="color: #008000">print</span>(time[<span style="color: #666666">0</span>])
<span style="color: #008000">print</span>(time[<span style="color: #666666">0</span>]<span style="color: #666666">+</span>dt<span style="color: #666666">.</span>timedelta(days<span style="color: #666666">=1</span>))
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Another possibility is to do the conversion when reading the data:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df2<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_csv(<span style="color: #BA2121">&#39;../data/corona_data.dat&#39;</span>,sep<span style="color: #666666">=</span><span style="color: #BA2121">&#39;</span><span style="color: #AA5D1F; font-weight: bold">\t</span><span style="color: #BA2121">&#39;</span>,parse_dates<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;TIME&#39;</span>]) 
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>If you have a need to specify all data types, to avoid potential problems down the line this can also be done. First create a dictionary, with column names and data types:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">types_dict<span style="color: #666666">=</span>{<span style="color: #BA2121">&quot;LOCATION&quot;</span>:<span style="color: #008000">str</span>,<span style="color: #BA2121">&quot;TIME&quot;</span>:<span style="color: #008000">str</span>,<span style="color: #BA2121">&quot;ELAPSED_TIME_SINCE_OUTBREAK&quot;</span>:<span style="color: #008000">int</span>,
	<span style="color: #BA2121">&quot;CONFIRMED&quot;</span>:<span style="color: #008000">int</span>,<span style="color: #BA2121">&quot;DEATHS&quot;</span>:<span style="color: #008000">int</span>,<span style="color: #BA2121">&quot;RECOVERED&quot;</span>:<span style="color: #008000">int</span>}
df2<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_csv(<span style="color: #BA2121">&#39;../data/corona_data.dat&#39;</span>,sep<span style="color: #666666">=</span><span style="color: #BA2121">&#39;</span><span style="color: #AA5D1F; font-weight: bold">\t</span><span style="color: #BA2121">&#39;</span>,dtype<span style="color: #666666">=</span>types_dict,
	parse_dates<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;TIME&#39;</span>]) <span style="color: #3D7B7B; font-style: italic"># set data types explicit</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Note that the time data type is <code>str</code>, but we explicitly tell Pandas to convert those to <code>datetime</code>.</p>
<h2 id="filtering-and-visualizing-data" class="anchor">Filtering and visualizing data </h2>
<h3 id="boolean-masking" class="anchor">Boolean masking </h3>
<p>Typically you would select rows based on a criterion, the syntax in Pandas is that you enter a series containing <code>True</code> and <code>False</code> for the rows you want to pick out, e.g. to pick out all entries with Afghanistan we can do:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df[df[<span style="color: #BA2121">&#39;LOCATION&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;Afghanistan&#39;</span>]
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The innermost statement <code>df['LOCATION'] == 'Afghanistan'</code> gives a logical vector with the value <code>True</code> for the five last elements and <code>False</code> for the rest. Then we pass this to the DataFrame, and in one go the unwanted elements are removed. It is also possible to use several criteria, e.g. only extracting data after a specific time</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df[(df[<span style="color: #BA2121">&#39;LOCATION&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;Afghanistan&#39;</span>) <span style="color: #666666">&amp;</span>
		   (df[<span style="color: #BA2121">&#39;ELAPSED_TIME_SINCE_OUTBREAK&#39;</span>] <span style="color: #666666">&gt;</span> <span style="color: #666666">2</span>)]
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Note that the parenthesis are necessary, otherwise the logical operation would fail.</p>
<h3 id="plotting-a-dataframe" class="anchor">Plotting a DataFrame </h3>
<p>Pandas has built in plotting, by calling <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.plot.html" target="_self"><tt>pandas.DataFrame.plot</tt></a>.</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df2<span style="color: #666666">=</span>df[(df[<span style="color: #BA2121">&#39;LOCATION&#39;</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;Afghanistan&#39;</span>)]
df2<span style="color: #666666">.</span>plot()
<span style="color: #3D7B7B; font-style: italic">#try </span>
<span style="color: #3D7B7B; font-style: italic">#df2=df2.set_index(&#39;TIME&#39;)</span>
<span style="color: #3D7B7B; font-style: italic">#df2.plot() # what is the difference?</span>
<span style="color: #3D7B7B; font-style: italic">#df2.plot(y=[&#39;CONFIRMED&#39;,&#39;DEATHS&#39;])</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h2 id="performing-mathematical-operations-on-dataframes" class="anchor">Performing mathematical operations on DataFrames </h2>
<p>When performing mathematical operations on DataFrames there are at least two strategies</p>
<ul>
<li> Extract columns from the DataFrame and perform mathematical operations on the columns using Numpy, leaving the original DataFrame intact</li>
<li> To operate directly on the data in the DataFrame using the Pandas library</li>
</ul>
<div class="alert alert-block alert-success alert-text-normal"><b>Speed and performance</b>
<p>Using Pandas or Numpy should in principle be equally fast. Do not worry about performance before it is necessary. Use the methods you are confident with, and try to be consistent. By consistent, we mean that if you have found one way of doing a certain operation stick to that one and try not to implement many different ways of doing the same thing. </p>
</div>


<p>We can always access the individual columns in a DataFrame by the syntax <code>df['column_name']</code>.
<h3 id="example-mathematical-operations-on-dataframes" class="anchor">Example: mathematical operations on DataFrames </h3>
</p>
<ol>
<li> Create a DataFrame with one column (<code>a</code>) containing ten thousand random uniformly distributed numbers between 0 and 1 (checkout <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.uniform.html" target="_self"><tt>np.random.uniform</tt></a>)</li>
<li> Add two new columns: one which all elements of <code>a</code> is squared and one where the sine function is applied to column <code>a</code></li>
<li> Calculate the inverse of all the numbers in the DataFrame</li>
<li> Make a plot of the results (i.e. <code>a</code> vs <code>a*a</code>, and <code>a</code> vs <code>sin(a)</code>)</li>
</ol>
<h3 id="solution" class="anchor">Solution </h3>
<ol>
<li> First we make the DataFrame:</li>
</ol>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>
N<span style="color: #666666">=10000</span>
a<span style="color: #666666">=</span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(<span style="color: #666666">0</span>,<span style="color: #666666">1</span>,size<span style="color: #666666">=</span>N)
df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>DataFrame() <span style="color: #3D7B7B; font-style: italic"># empty DataFrame</span>
df[<span style="color: #BA2121">&#39;a&#39;</span>]<span style="color: #666666">=</span>a
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>If you like you could also try to use a dictionary. Next, we add the new columns:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df[<span style="color: #BA2121">&#39;b&#39;</span>]<span style="color: #666666">=</span>df[<span style="color: #BA2121">&#39;a&#39;</span>]<span style="color: #666666">*</span>df[<span style="color: #BA2121">&#39;a&#39;</span>] <span style="color: #3D7B7B; font-style: italic"># alternatively np.square(df[&#39;a&#39;])</span>
df[<span style="color: #BA2121">&#39;c&#39;</span>]<span style="color: #666666">=</span>np<span style="color: #666666">.</span>sin(df[<span style="color: #BA2121">&#39;a&#39;</span>])
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<ol>
<li> The inverse of all the numbers in the DataFrame can be calculated by simply doing:</li>
</ol>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #666666">1/</span>df
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Note: you can also do <code>df+df</code> and many other operations on the whole DataFrame.</p>

<ol>
<li> To make plots there are several possibilities. Personally, I tend most of the time to use the  <a href="https://matplotlib.org/" target="_self"><tt>matplotlib</tt></a> library, simply because I know it quite well, but Pandas has a great deal of very simple methods you can use to generate nice plots with very few commands.</li>
</ol>
<p>
<b>Matplotlib:</b>
``
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
plt<span style="color: #666666">.</span>plot(df[<span style="color: #BA2121">&#39;a&#39;</span>],df[<span style="color: #BA2121">&#39;b&#39;</span>], <span style="color: #BA2121">&#39;*&#39;</span>, label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;$a^2$&#39;</span>)
plt<span style="color: #666666">.</span>plot(df[<span style="color: #BA2121">&#39;a&#39;</span>],df[<span style="color: #BA2121">&#39;c&#39;</span>], <span style="color: #BA2121">&#39;^&#39;</span>, label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;$\sin(a)$&#39;</span>)
plt<span style="color: #666666">.</span>legend() 
plt<span style="color: #666666">.</span>grid() <span style="color: #3D7B7B; font-style: italic"># make small grid lines</span>
plt<span style="color: #666666">.</span>show()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Pandas plotting:</b>
``
First, let us try the built in plot command in Pandas:
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">.</span>plot()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>If you compare this plot with the previous plot, you will see that Pandas plots all columns versus the index columns, which is not what we want. But, we can set <code>a</code> to be the index column:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">=</span>df<span style="color: #666666">.</span>set_index(<span style="color: #BA2121">&#39;a&#39;</span>)
df<span style="color: #666666">.</span>plot()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>We can also make separate plots:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">.</span>plot(subplots<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>or scatter plots</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">=</span>df<span style="color: #666666">.</span>reset_index()
df<span style="color: #666666">.</span>plot<span style="color: #666666">.</span>scatter(x<span style="color: #666666">=</span><span style="color: #BA2121">&#39;a&#39;</span>,y<span style="color: #666666">=</span><span style="color: #BA2121">&#39;b&#39;</span>)
df<span style="color: #666666">.</span>plot<span style="color: #666666">.</span>scatter(x<span style="color: #666666">=</span><span style="color: #BA2121">&#39;a&#39;</span>,y<span style="color: #666666">=</span><span style="color: #BA2121">&#39;c&#39;</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Note that we have to reset the index, otherwise there is no column named <code>a</code>. </p>
<h2 id="grouping-filtering-and-aggregating-data" class="anchor">Grouping, filtering and aggregating data </h2>
<p>Whenever you have a data set, you would like to do some exploratory analysis. That typically means that you would like to group, filter or aggregate data. Perhaps, we would like to plot the covid data not per country, but the data as a function of dates. Then you first must sort the data according to date, and then sum all the occurrences on that particular date. For all of these purposes we can use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html " target="_self"><tt>pd.DataFrame.groupby()</tt></a> function. To sort our DataFrame on dates and sum the occurrences we can do:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_excel(<span style="color: #BA2121">&#39;../data/corona_data.xlsx&#39;</span>)
df<span style="color: #666666">.</span>groupby(<span style="color: #BA2121">&#39;TIME&#39;</span>)<span style="color: #666666">.</span>sum()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Another case could be that we wanted to find the total number of confirmed, deaths and recovered cases in the full database. As always in Python this can be done in different ways, by e.g. splitting the database into individual countries and do  <code>df[['CONFIRMED','DEATHS','RECOVERED']].sum()</code> or accessing each column individually and sum each of them e.g. <code>np.sum(df['CONFIRMED'])</code>.  However, with the <code>groupby()</code> function
(see figure <a href="#fig:pandas:group">4</a> for final result)
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">.</span>groupby(<span style="color: #BA2121">&#39;LOCATION&#39;</span>)<span style="color: #666666">.</span>sum()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Here Pandas sum all columns with the same location, and drop columns that cannot be summed. By doing <code>df.groupby('LOCATION').mean()</code> or <code>df.groupby('LOCATION').std()</code> we can find the mean or standard deviation (per day).</p>

<center> <!-- figure label: --> <div id="fig:pandas:group"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 4:  The results of <code>df.groupby('LOCATION').sum()</code>.  <!-- caption label: fig:pandas:group --> </p>
</center>
<p><img src="fig-pandas/group.png" align="bottom" width=800></p>
</center>

<h2 id="simple-statistics-in-pandas" class="anchor">Simple statistics in Pandas </h2>
<p>Finally, it is worth mentioning the built in methods <code>pd.DataFrame.mean</code>, <code>pd.DataFrame.median</code>, <code>pd.DataFrame.std</code> which calculate the mean, median and standard deviation on the columns in the DataFrame where it make sense (i.e. avoid strings and dates). To get all these values in one go (and a few more) on can also use <code>pd.DataFrame.describe()</code></p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">.</span>describe()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The output is shown in figure <a href="#fig:pandas:desc">5</a></p>

<center> <!-- figure label: --> <div id="fig:pandas:desc"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 5:  Output from the describe command.  <!-- caption label: fig:pandas:desc --> </p>
</center>
<p><img src="fig-pandas/describe.png" align="bottom" width=800></p>
</center>

<h2 id="joining-two-dataframes" class="anchor">Joining two DataFrames </h2>
<h3 id="appending-dataframes" class="anchor">Appending DataFrames  </h3>
<p>The DataFrame with the Covid-19 data in the previous section could have been created from two separate DataFrames, using <a href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html" target="_self"><tt>concat()</tt></a>. First, create two DataFrames: </p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">datetime</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">dt</span>
a<span style="color: #666666">=</span>dt<span style="color: #666666">.</span>datetime(<span style="color: #666666">2020</span>,<span style="color: #666666">2</span>,<span style="color: #666666">24</span>,<span style="color: #666666">23</span>,<span style="color: #666666">59</span>)
b<span style="color: #666666">=</span>dt<span style="color: #666666">.</span>datetime(<span style="color: #666666">2020</span>,<span style="color: #666666">2</span>,<span style="color: #666666">7</span>,<span style="color: #666666">23</span>,<span style="color: #666666">59</span>)
my_dict1<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;LOCATION&#39;</span>:<span style="color: #666666">7*</span>[<span style="color: #BA2121">&#39;Afghanistan&#39;</span>], 
<span style="color: #BA2121">&#39;TIME&#39;</span>:[a<span style="color: #666666">+</span>dt<span style="color: #666666">.</span>timedelta(days<span style="color: #666666">=</span>i) <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">7</span>)],
<span style="color: #BA2121">&#39;ELAPSED_TIME_SINCE_OUTBREAK&#39;</span>:[<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>, <span style="color: #666666">4</span>, <span style="color: #666666">5</span>, <span style="color: #666666">6</span>],
<span style="color: #BA2121">&#39;CONFIRMED&#39;</span>:<span style="color: #666666">7*</span>[<span style="color: #666666">1</span>],
<span style="color: #BA2121">&#39;DEATHS&#39;</span>:<span style="color: #666666">7*</span>[<span style="color: #666666">0</span>],
<span style="color: #BA2121">&#39;RECOVERED&#39;</span>: <span style="color: #666666">7*</span>[<span style="color: #666666">0</span>]}
my_dict2<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;LOCATION&#39;</span>:<span style="color: #666666">6*</span>[<span style="color: #BA2121">&#39;Diamond Princess&#39;</span>], 
<span style="color: #BA2121">&#39;TIME&#39;</span>:[b<span style="color: #666666">+</span>dt<span style="color: #666666">.</span>timedelta(days<span style="color: #666666">=</span>i) <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">6</span>)],
<span style="color: #BA2121">&#39;ELAPSED_TIME_SINCE_OUTBREAK&#39;</span>:[<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>, <span style="color: #666666">4</span>, <span style="color: #666666">5</span>],
<span style="color: #BA2121">&#39;CONFIRMED&#39;</span>:[<span style="color: #666666">61</span>, <span style="color: #666666">61</span>, <span style="color: #666666">64</span>, <span style="color: #666666">135</span>, <span style="color: #666666">135</span>, <span style="color: #666666">175</span>],
<span style="color: #BA2121">&#39;DEATHS&#39;</span>:<span style="color: #666666">6*</span>[<span style="color: #666666">0</span>],
<span style="color: #BA2121">&#39;RECOVERED&#39;</span>: <span style="color: #666666">6*</span>[<span style="color: #666666">0</span>]}
df1<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>DataFrame(my_dict1)
df2<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>DataFrame(my_dict2)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Next, add them row wise (see figure <a href="#fig:pandas:concat">6</a>):</p>


<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>concat([df1,df2])
<span style="color: #008000">print</span>(df) <span style="color: #3D7B7B; font-style: italic"># to view</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<center> <!-- figure label: --> <div id="fig:pandas:concat"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 6:  The result of <code>concat()</code>.  <!-- caption label: fig:pandas:concat --> </p>
</center>
<p><img src="fig-pandas/concat.png" align="bottom" width=800></p>
</center>

<p>If you compare this DataFrame with the previous one, you will see that the index column is different. This is because when joining two DataFrames Pandas does not reset the index by default, doing <code>df=pd.concat([df1,df2],ignore_index=True)</code> resets the index. It is also possible to join DataFrames column wise:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">pd<span style="color: #666666">.</span>concat([df1,df2],axis<span style="color: #666666">=1</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h3 id="merging-dataframes" class="anchor">Merging DataFrames </h3>

<p>In the previous example we had two non overlapping DataFrames (separate countries and times). It could also be the case that some of the data was overlapping e.g. continuing with the Covid-19 data, one could assume that there was one data set from one region and one from another region in the same country:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">my_dict1<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;LOCATION&#39;</span>:<span style="color: #666666">7*</span>[<span style="color: #BA2121">&#39;Diamond Princess&#39;</span>], 
<span style="color: #BA2121">&#39;TIME&#39;</span>:[b<span style="color: #666666">+</span>dt<span style="color: #666666">.</span>timedelta(days<span style="color: #666666">=</span>i) <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">7</span>)],
<span style="color: #BA2121">&#39;ELAPSED_TIME_SINCE_OUTBREAK&#39;</span>:[<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>, <span style="color: #666666">4</span>, <span style="color: #666666">5</span>, <span style="color: #666666">6</span>],
<span style="color: #BA2121">&#39;CONFIRMED&#39;</span>:<span style="color: #666666">7*</span>[<span style="color: #666666">1</span>],
<span style="color: #BA2121">&#39;DEATHS&#39;</span>:<span style="color: #666666">7*</span>[<span style="color: #666666">0</span>],
<span style="color: #BA2121">&#39;RECOVERED&#39;</span>: <span style="color: #666666">7*</span>[<span style="color: #666666">0</span>]}
my_dict2<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;LOCATION&#39;</span>:<span style="color: #666666">2*</span>[<span style="color: #BA2121">&#39;Diamond Princess&#39;</span>], 
<span style="color: #BA2121">&#39;TIME&#39;</span>:[b<span style="color: #666666">+</span>dt<span style="color: #666666">.</span>timedelta(days<span style="color: #666666">=</span>i) <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">2</span>)],
<span style="color: #BA2121">&#39;ELAPSED_TIME_SINCE_OUTBREAK&#39;</span>:[<span style="color: #666666">0</span>, <span style="color: #666666">1</span>],
<span style="color: #BA2121">&#39;CONFIRMED&#39;</span>:[<span style="color: #666666">60</span>, <span style="color: #666666">60</span>],
<span style="color: #BA2121">&#39;DEATHS&#39;</span>:<span style="color: #666666">2*</span>[<span style="color: #666666">0</span>],
<span style="color: #BA2121">&#39;RECOVERED&#39;</span>: <span style="color: #666666">2*</span>[<span style="color: #666666">0</span>]}
df1<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>DataFrame(my_dict1)
df2<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>DataFrame(my_dict2)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>If we do <code>pd.concat([df1,df2])</code> we will simply add all values after each other. What we want to do is to sum the number of confirmed, recovered and deaths for the same date. This can be done in several ways, but one way is to use <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html" target="_self"><tt>pd.DataFrame.merge()</tt></a>.You can specify the columns to merge on, and choose <code>outer</code> which is union (all data from both frames) or <code>inner</code> which means the intersect (only data which you merge on that exists in both frames), see figure <a href="#fig:pandas:join">7</a> for a visual image.</p>

<center> <!-- figure label: --> <div id="fig:pandas:join"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 7:  The result of using <code>how=outer, inner, left</code>, or <code>right</code> in <code>pd.DataFrame.merge()</code>.  <!-- caption label: fig:pandas:join --> </p>
</center>
<p><img src="fig-pandas/fig_join.png" align="bottom" width=800></p>
</center>

<p>To be even more specific, after performing the commands</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df1<span style="color: #666666">.</span>merge(df2,on<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;LOCATION&#39;</span>,<span style="color: #BA2121">&#39;TIME&#39;</span>],how<span style="color: #666666">=</span><span style="color: #BA2121">&#39;outer&#39;</span>)
df1<span style="color: #666666">.</span>merge(df2,on<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;LOCATION&#39;</span>,<span style="color: #BA2121">&#39;TIME&#39;</span>],how<span style="color: #666666">=</span><span style="color: #BA2121">&#39;inner&#39;</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>we get the results in figure <a href="#fig:pd:merge">8</a> </p>

<center> <!-- figure label: --> <div id="fig:pd:merge"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 8:  Merging to dataframes using <code>outer</code> (top) and <code>inner</code> (bottom).  <!-- caption label: fig:pd:merge --> </p>
</center>
<p><img src="fig-pandas/merge.png" align="bottom" width=800></p>
</center>

<p>Clearly in this case we need to choose <code>outer</code>. In the merge process pandas adds an extra subscript <code>_x</code> and <code>_y</code> on columns that contain the same header name. We also need to sum those, which can be done as follows
(see figure <a href="#fig:pandas:merge3">9</a> for the final result):
</p>


<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">=</span>df1<span style="color: #666666">.</span>merge(df2,on<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;LOCATION&#39;</span>,<span style="color: #BA2121">&#39;TIME&#39;</span>],how<span style="color: #666666">=</span><span style="color: #BA2121">&#39;outer&#39;</span>)
cols<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;CONFIRMED&#39;</span>,<span style="color: #BA2121">&#39;DEATHS&#39;</span>, <span style="color: #BA2121">&#39;RECOVERED&#39;</span>]
<span style="color: #008000; font-weight: bold">for</span> col <span style="color: #AA22FF; font-weight: bold">in</span> cols:
    df[col]<span style="color: #666666">=</span>df[[col<span style="color: #666666">+</span><span style="color: #BA2121">&#39;_x&#39;</span>,col<span style="color: #666666">+</span><span style="color: #BA2121">&#39;_y&#39;</span>]]<span style="color: #666666">.</span>sum(axis<span style="color: #666666">=1</span>) <span style="color: #3D7B7B; font-style: italic"># sum row elements</span>
    df<span style="color: #666666">=</span>df<span style="color: #666666">.</span>drop(columns<span style="color: #666666">=</span>[col<span style="color: #666666">+</span><span style="color: #BA2121">&#39;_x&#39;</span>,col<span style="color: #666666">+</span><span style="color: #BA2121">&#39;_y&#39;</span>]) <span style="color: #3D7B7B; font-style: italic"># remove obsolete columns</span>
<span style="color: #3D7B7B; font-style: italic"># final clean up</span>
df[<span style="color: #BA2121">&#39;ELAPSED_TIME_SINCE_OUTBREAK&#39;</span>]<span style="color: #666666">=</span>df[<span style="color: #BA2121">&#39;ELAPSED_TIME_SINCE_OUTBREAK_x&#39;</span>]		
df<span style="color: #666666">=</span>df<span style="color: #666666">.</span>drop(columns<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;ELAPSED_TIME_SINCE_OUTBREAK_y&#39;</span>,<span style="color: #BA2121">&#39;ELAPSED_TIME_SINCE_OUTBREAK_x&#39;</span>])
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<center> <!-- figure label: --> <div id="fig:pandas:merge3"></div> <!-- FIGURE -->
<hr class="figure">
<center>
<p class="caption">Figure 9:  Result of outer merging and summing.  <!-- caption label: fig:pandas:merge3 --> </p>
</center>
<p><img src="fig-pandas/merge3.png" align="bottom" width=800></p>
</center>

<h2 id="working-with-folders-and-files" class="anchor">Working with folders and files </h2>
<p>When working with big data sets you might want to split data into smaller sets, and also write them to different folders (or files) to view each individually in excel. Working with files and folders in a way that will work on any kind of platform has always been a challenge, but it is greatly simplified by the <a href="https://docs.python.org/3/library/pathlib.html" target="_self">Pathlib library</a>.</p>
<h3 id="basic-use-of-pathlib" class="anchor">Basic use of Pathlib </h3>

<p>
<b>List all sub directories and files:</b>
``
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">pathlib</span> <span style="color: #008000; font-weight: bold">import</span> Path
p<span style="color: #666666">=</span>Path(<span style="color: #BA2121">&#39;.&#39;</span>) <span style="color: #3D7B7B; font-style: italic"># the directory where your python file is located</span>
<span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> p<span style="color: #666666">.</span>iterdir():
    <span style="color: #008000; font-weight: bold">if</span> x<span style="color: #666666">.</span>is_dir():
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Found dir: &#39;</span>, x)
    <span style="color: #008000; font-weight: bold">elif</span> x<span style="color: #666666">.</span>is_file():
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Found file: &#39;</span>, x)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>List all files of a type:</b>
``
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">p<span style="color: #666666">=</span>Path(<span style="color: #BA2121">&#39;.&#39;</span>)
<span style="color: #008000; font-weight: bold">for</span> p <span style="color: #AA22FF; font-weight: bold">in</span> p<span style="color: #666666">.</span>rglob(<span style="color: #BA2121">&quot;*.png&quot;</span>):<span style="color: #3D7B7B; font-style: italic"># rglob means recursively, searches sub directories</span>
    <span style="color: #008000">print</span>(p<span style="color: #666666">.</span>name)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>If you want to print the full path do <code>print(p.absolute())</code>.</p>

<p>
<b>Create a directory:</b>
``
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">Path(<span style="color: #BA2121">&#39;tmp_dir&#39;</span>)<span style="color: #666666">.</span>mkdir()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>If you run the code twice it will produce an error, because the directory exists, then we can simply do <code>Path('tmp_dir').mkdir(exist_ok=True)</code>.</p>

<p>
<b>Print current directory:</b>
``
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">Path<span style="color: #666666">.</span>cwd()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Joining paths:</b>
``
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">p<span style="color: #666666">=</span>Path(<span style="color: #BA2121">&#39;.&#39;</span>)
new_path <span style="color: #666666">=</span> p <span style="color: #666666">/</span> <span style="color: #BA2121">&#39;tmp_dir&#39;</span> <span style="color: #666666">/</span> <span style="color: #BA2121">&#39;my_file.txt&#39;</span>
<span style="color: #008000">print</span>(new_path<span style="color: #666666">.</span>absolute())
new_path<span style="color: #666666">.</span>touch()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h3 id="basic-use-of-os" class="anchor">Basic use of <code>os</code> </h3>
<p>We have already encountered the use of <code>os</code> when printing the working directory, i.e. <code>print(os.getcwd())</code>. If you want to create a directory named <code>tmp</code>, one can do</p>

<p>
<b>Creating a directory:</b>
``
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">os</span>
os<span style="color: #666666">.</span>mkdir(<span style="color: #BA2121">&#39;tmp&#39;</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>Moving into a directory:</b>
</p>

<p>To move into that directory do`:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">os<span style="color: #666666">.</span>chdir(<span style="color: #BA2121">&#39;tmp&#39;</span>)
os<span style="color: #666666">.</span>chdir(<span style="color: #BA2121">&#39;..&#39;</span>) <span style="color: #3D7B7B; font-style: italic"># move back up</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h3 id="splitting-data-into-different-folders-and-files" class="anchor">Splitting data into different folders and files </h3>

<p>
<b>Using the Pathlib library:</b>
``
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_excel(<span style="color: #BA2121">&#39;../data/corona_data.xlsx&#39;</span>)
countries <span style="color: #666666">=</span> df[<span style="color: #BA2121">&#39;LOCATION&#39;</span>]<span style="color: #666666">.</span>unique() <span style="color: #3D7B7B; font-style: italic">#skip duplicates</span>
data_folder<span style="color: #666666">=</span>Path(<span style="color: #BA2121">&#39;../covid-data&#39;</span>)
data_folder<span style="color: #666666">.</span>mkdir()
<span style="color: #008000; font-weight: bold">for</span> country <span style="color: #AA22FF; font-weight: bold">in</span> countries:
    new_path<span style="color: #666666">=</span>data_folder <span style="color: #666666">/</span> country
    new_path<span style="color: #666666">.</span>mkdir()
    excel_file<span style="color: #666666">=</span>country<span style="color: #666666">+</span><span style="color: #BA2121">&#39;.xlsx&#39;</span>
    df2<span style="color: #666666">=</span>df[df[<span style="color: #BA2121">&#39;LOCATION&#39;</span>]<span style="color: #666666">==</span>country]
    df2<span style="color: #666666">.</span>to_excel(new_path<span style="color: #666666">/</span>excel_file,index<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>If you run the code twice, it will fail, but that can be resolved by e.g. <code>data_folder.mkdir(exist_ok=True)</code>.  </p>

<p>
<b>Using the <code>os</code> library:</b>
``
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #3D7B7B; font-style: italic"># first get all the countries:</span>
df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_excel(<span style="color: #BA2121">&#39;../data/corona_data.xlsx&#39;</span>)
countries <span style="color: #666666">=</span> df[<span style="color: #BA2121">&#39;LOCATION&#39;</span>]<span style="color: #666666">.</span>unique() <span style="color: #3D7B7B; font-style: italic">#skip duplicates</span>
os<span style="color: #666666">.</span>mkdir(<span style="color: #BA2121">&#39;../covid-data&#39;</span>)
os<span style="color: #666666">.</span>chdir(<span style="color: #BA2121">&#39;../covid-data&#39;</span>)
<span style="color: #008000; font-weight: bold">for</span> country <span style="color: #AA22FF; font-weight: bold">in</span> countries:
    os<span style="color: #666666">.</span>mkdir(country)
    os<span style="color: #666666">.</span>chdir(country)
    df2<span style="color: #666666">=</span>df[df[<span style="color: #BA2121">&#39;LOCATION&#39;</span>]<span style="color: #666666">==</span>country]
    df2<span style="color: #666666">.</span>to_excel(country<span style="color: #666666">+</span><span style="color: #BA2121">&#39;.xlsx&#39;</span>,index<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>)
    os<span style="color: #666666">.</span>chdir(<span style="color: #BA2121">&#39;..&#39;</span>) <span style="color: #3D7B7B; font-style: italic"># move up</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>More robust way of creating a directory:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">my_mkdir</span>(name):
    <span style="color: #008000; font-weight: bold">if</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>isdir(name):
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Directory &#39;</span>, name,<span style="color: #BA2121">&#39; already exists&#39;</span>)
    <span style="color: #008000; font-weight: bold">else</span>:
        os<span style="color: #666666">.</span>mkdir(name)
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;creating directory &#39;</span>,name)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>If you want to collect all data again, you can do as follows:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">df_new<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>DataFrame()
data_folder<span style="color: #666666">=</span>Path(<span style="color: #BA2121">&#39;../covid-data&#39;</span>)
<span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">dir</span> <span style="color: #AA22FF; font-weight: bold">in</span> data_folder<span style="color: #666666">.</span>iterdir():
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">dir</span><span style="color: #666666">.</span>is_dir():      
        file<span style="color: #666666">=</span><span style="color: #008000">dir</span><span style="color: #666666">.</span>name<span style="color: #666666">+</span><span style="color: #BA2121">&#39;.xlsx&#39;</span>
        df<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>read_excel(<span style="color: #008000">dir</span><span style="color: #666666">/</span>file)
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Reading file &#39;</span>, file)
        df_new<span style="color: #666666">=</span>pd<span style="color: #666666">.</span>concat([df_new,df],ignore_index<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
<h2 id="writing-more-robust-code" class="anchor">Writing more robust code </h2>
<p>Most likely in the last sections you have encountered long error messages from Python. Errors could be</p>
<ul>
<li> syntax errors, grammatically incorrect code e.g. calling functions that do not exist, using variables that are not defined or writing lines with missing instructions, indentation errors.</li> 
<li> exceptions e.g. open a file that does not exist, accessing a Pandas header with the wrong name, performing wrong mathematical operations (1/0).</li>
<li> logical errors (bugs), code that runs but produces wrong results. These errors are of course some of the most difficult errors to find and can only be discovered by comparing the output of the code to known answers. In many cases errors are introduced when extending the code, and unit tests can be extremely helpful.</li>
</ul>
<p>In the rest of this section, we will discuss how to avoid or to handle exceptions. The goal is to write code that catch all the exceptions before they happen, tries to do something with them or prints out a reasonable error message of what went wrong.</p>

<p>Let us look at the code that we have written so far, starting from the top of the notebook.</p>

<p>
<b>Accessing columns in Pandas:</b>
So far we have just accessed the columns directly, but it is very quick to write a wrong name, thus instead of doing
</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">time<span style="color: #666666">=</span>df[<span style="color: #BA2121">&#39;TIME&#39;</span>]
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>we should try to check if the column exist before accessing it from the DataFrame. There are many ways of achieving this:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_column_from_dataframe</span>(name,df):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">    name: name of column</span>
<span style="color: #BA2121; font-style: italic">    df: Pandas DataFrame</span>
<span style="color: #BA2121; font-style: italic">    returns: column if found, and empty otherwise </span>
<span style="color: #BA2121; font-style: italic">    &#39;&#39;&#39;</span>
    <span style="color: #008000; font-weight: bold">if</span> name <span style="color: #AA22FF; font-weight: bold">in</span> df<span style="color: #666666">.</span>columns:
        <span style="color: #008000; font-weight: bold">return</span> df[name]
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Column not found&#39;</span>)
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Possible column names are : &#39;</span>, df<span style="color: #666666">.</span>columns)
        <span style="color: #008000; font-weight: bold">return</span> pd<span style="color: #666666">.</span>Series(dtype<span style="color: #666666">=</span><span style="color: #008000">object</span>)
<span style="color: #3D7B7B; font-style: italic"># run the following code with df containing covid data</span>
get_column_from_dataframe(<span style="color: #BA2121">&#39;TIME2&#39;</span>,df)
get_column_from_dataframe(<span style="color: #BA2121">&#39;TIME&#39;</span>,df)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Note the use of doc string in the beginning, the doc string will be printed in advanced editors once you write the name of the function. It also helps you to remember what the function does. It is a good practice to return something of the same type, because then the rest of the code can execute. If it is critical that you find the name of the column, you can always test from the outside:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">s<span style="color: #666666">=</span>get_column_from_dataframe(<span style="color: #BA2121">&#39;TIME2&#39;</span>,df)
<span style="color: #008000; font-weight: bold">if</span> s<span style="color: #666666">.</span>empty:
    <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Exiting ...&#39;</span>)
    exit() <span style="color: #3D7B7B; font-style: italic"># note this shuts down the kernel</span>
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>In the function <code>get_column_from_dataframe</code> many more things could go wrong, the user could pass a variable that is not a DataFrame, to catch all exceptions one can do:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_column_from_dataframe_v2</span>(name,df):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">    name: name of column</span>
<span style="color: #BA2121; font-style: italic">    df: Pandas DataFrame</span>
<span style="color: #BA2121; font-style: italic">    returns: column if found, and empty otherwise </span>
<span style="color: #BA2121; font-style: italic">    &#39;&#39;&#39;</span>
    <span style="color: #008000; font-weight: bold">try</span>:
        <span style="color: #008000; font-weight: bold">return</span> df[name]
    <span style="color: #008000; font-weight: bold">except</span>:
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Something went wrong ...&#39;</span>)
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Maybe wrong column name?&#39;</span>)
        <span style="color: #008000; font-weight: bold">return</span> pd<span style="color: #666666">.</span>Series(dtype<span style="color: #666666">=</span><span style="color: #008000">object</span>)
<span style="color: #3D7B7B; font-style: italic"># run the following code with df containing covid data</span>
get_column_from_dataframe_v2(<span style="color: #BA2121">&#39;TIME2&#39;</span>,df)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The <code>try</code> and <code>except</code> handling is very elegant in Python, and a very easy way of making the code more robust. Python first tries <code>df[name]</code> if that is not successful (e.g. wrong column name, wrong DataFrame, maybe Pandas is not even imported) it jumps to the exception.</p>

<p>Another thing to consider is case insensitive search, we should be able to access a country or a header using e.g. <code>Afghanistan</code> or <code>afghanistan</code>. A possible solution could be to make sure that when you read in the column, both the DataFrame column and the passed column name are uppercase:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_column_from_dataframe_v3</span>(name,df):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">    name: name of column (case insensitive)</span>
<span style="color: #BA2121; font-style: italic">    df: Pandas DataFrame</span>
<span style="color: #BA2121; font-style: italic">    returns: column if found, and empty otherwise </span>
<span style="color: #BA2121; font-style: italic">    &#39;&#39;&#39;</span>
    COL<span style="color: #666666">=</span>df<span style="color: #666666">.</span>columns<span style="color: #666666">.</span>str<span style="color: #666666">.</span>upper()
    NAME<span style="color: #666666">=</span>name<span style="color: #666666">.</span>upper()
    <span style="color: #008000; font-weight: bold">try</span>:
        idx<span style="color: #666666">=</span>COL<span style="color: #666666">.</span>get_loc(NAME)
        <span style="color: #008000; font-weight: bold">return</span> df<span style="color: #666666">.</span>iloc[:,idx]
    <span style="color: #008000; font-weight: bold">except</span>:
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Column not found&#39;</span>)
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Possible column names are : &#39;</span>, df<span style="color: #666666">.</span>columns)
        <span style="color: #008000; font-weight: bold">return</span> pd<span style="color: #666666">.</span>Series(dtype<span style="color: #666666">=</span><span style="color: #008000">object</span>)
        
get_column_from_dataframe_v3(<span style="color: #BA2121">&#39;time&#39;</span>,df)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>Now, we might want to make our code more robust by collecting data from specific rows, e.g. a specific country <code>df[df['LOCATION'] == 'Afghanistan']</code>. This operation assumes 1) that the column <code>LOCATION</code> exists and 2) that the country is spelled correctly. However, we have already written code to get a column and check that it exists, but it is written inside a function with a different purpose. Thus, it is better to split the code above in two parts:</p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_col_index</span>(name,df):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">    name: name of column (case insensitive)</span>
<span style="color: #BA2121; font-style: italic">    df: Pandas DataFrame</span>
<span style="color: #BA2121; font-style: italic">    returns: pos if exists, and -1 otherwise </span>
<span style="color: #BA2121; font-style: italic">    &#39;&#39;&#39;</span>
    COL<span style="color: #666666">=</span>df<span style="color: #666666">.</span>columns<span style="color: #666666">.</span>str<span style="color: #666666">.</span>upper()
    NAME<span style="color: #666666">=</span>name<span style="color: #666666">.</span>upper()
    <span style="color: #008000; font-weight: bold">try</span>:
        <span style="color: #008000; font-weight: bold">return</span> COL<span style="color: #666666">.</span>get_loc(NAME)
    <span style="color: #008000; font-weight: bold">except</span>:
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Column not found&#39;</span>)
        <span style="color: #008000">print</span>(<span style="color: #BA2121">&#39;Possible column names are : &#39;</span>, df<span style="color: #666666">.</span>columns)
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">-1</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_column_from_dataframe_v4</span>(name,df):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">    name: name of column (case insensitive)</span>
<span style="color: #BA2121; font-style: italic">    df: Pandas DataFrame</span>
<span style="color: #BA2121; font-style: italic">    returns: column if found, and empty otherwise </span>
<span style="color: #BA2121; font-style: italic">    &#39;&#39;&#39;</span>
    idx<span style="color: #666666">=</span>get_col_index(name,df)
    <span style="color: #008000; font-weight: bold">if</span> idx<span style="color: #666666">&gt;-1</span>:
        <span style="color: #008000; font-weight: bold">return</span> df<span style="color: #666666">.</span>iloc[:,idx]
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">return</span> pd<span style="color: #666666">.</span>Series(dtype<span style="color: #666666">=</span><span style="color: #008000">object</span>)
        
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_rows_from_dataframe</span>(name,df,col<span style="color: #666666">=</span><span style="color: #BA2121">&#39;LOCATION&#39;</span>):
<span style="color: #bbbbbb">    </span><span style="color: #BA2121; font-style: italic">&#39;&#39;&#39;</span>
<span style="color: #BA2121; font-style: italic">    name: name of rows (case insensitive)</span>
<span style="color: #BA2121; font-style: italic">    df: Pandas DataFrame</span>
<span style="color: #BA2121; font-style: italic">    col: name of column to use as logical test</span>
<span style="color: #BA2121; font-style: italic">    returns: DataFrame, and empty otherwise </span>
<span style="color: #BA2121; font-style: italic">    &#39;&#39;&#39;</span>
    idx<span style="color: #666666">=</span>get_col_index(col,df)
    <span style="color: #008000; font-weight: bold">if</span> idx<span style="color: #666666">&gt;-1</span>:
        NAME<span style="color: #666666">=</span>name<span style="color: #666666">.</span>upper()
        <span style="color: #008000; font-weight: bold">return</span> df[df<span style="color: #666666">.</span>iloc[:,idx]<span style="color: #666666">.</span>str<span style="color: #666666">.</span>upper() <span style="color: #666666">==</span> NAME]
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">return</span> pd<span style="color: #666666">.</span>DataFrame()
get_rows_from_dataframe(<span style="color: #BA2121">&#39;afGhaniStan&#39;</span>,df)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>
<b>To summarize:</b>
</p>

<ol>
<li> We want to catch errors before they occur, this is most efficiently done by wrapping simple operations in functions.</li>
<li> Functions should be as small as possible, that would increase their reusability.</li>
<li> Almost all exceptions can be caught by using the <code>try</code> and <code>except</code> functionality in Python</li>
<li> Write doc strings in functions to increase user friendliness.</li>
<li> Write meaningful error messages, if possible also print out some additional information to help the user.</li>
</ol>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">

  <li class="previous">
    <a href="._book001.html">&larr; Prev</a>
  </li>

  <li class="next">
    <a href="._book003.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
</body>
</html>
    

